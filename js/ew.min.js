/*!
 * JavaScript for PHPMaker v2022.11.0
 * Copyright (c) e.World Technology Limited. All rights reserved.
 */
!function(e,t,a){"use strict";function n(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var i=n(e),r=n(t),l=n(a);var s={__proto__:null,userLevelId:function(e){return e&&!ew.checkInteger(e.value)?{userLevelId:ew.language.phrase("UserLevelIDInteger")}:parseInt(e.value,10)<1&&{userLevelId:ew.language.phrase("UserLevelIDIncorrect")}},userLevelName:function(e){return function(t){let a=document.getElementById("x_"+e);if(a&&t){let e=t.value.trim(),n=parseInt(a.value.trim(),10);if(0===n&&!ew.sameText(e,"Default"))return{userLevelName:ew.language.phrase("UserLevelDefaultName")};if(-1===n&&!ew.sameText(e,"Administrator"))return{userLevelName:ew.language.phrase("UserLevelAdministratorName")};if(-2===n&&!ew.sameText(e,"Anonymous"))return{userLevelName:ew.language.phrase("UserLevelAnonymousName")};if(n>0&&["anonymous","administrator","default"].includes(e.toLowerCase()))return{userLevelName:ew.language.phrase("UserLevelNameIncorrect")}}return!1}},required:function(e){return function(t){var a;let n=r.default(t),i=n.closest("#r_"+(null==(a=n.data("field"))?void 0:a.substr(2)));return i[0]||(i=n.closest("[id^=el]")),"none"!=i.css("display")&&(!(!t||ew.hasValue(t))&&{required:ew.language.phrase("EnterRequiredField").replace("%s",e)})}},fileRequired:function(e){return function(t){let a=document.getElementById("fn_"+t.id);return!(!a||ew.hasValue(a))&&{fileRequired:ew.language.phrase("EnterRequiredField").replace("%s",e)}}},mismatchPassword:function(e){let t;e.id.startsWith("c_")?t=e.id.replace(/^c_/,"x_"):"cpwd"==e.id&&(t="npwd");let a=document.getElementById(t);return e.value!==a.value&&{mismatchPassword:ew.language.phrase("MismatchPassword")}},between:function(e){let t,a;return e.id.startsWith("y_")&&(t=document.getElementById(e.id.replace(/^y_/,"x_")),a=document.getElementById(e.id.replace(/^y_/,"z_"))),!(!ew.hasValue(t)||"BETWEEN"!=r.default(a).val()||ew.hasValue(e))&&{between:ew.language.phrase("EnterValue2")}},passwordStrength:function(e){let t=r.default(e);return!(ew.isMaskedPassword(e)||!t.hasClass("ew-password-strength")||t.data("validated"))&&{passwordStrength:ew.language.phrase("PasswordTooSimple")}},username:function(e){return function(t){return!(e||!t.value.match(new RegExp("["+ew.escapeRegExChars(ew.INVALID_USERNAME_CHARACTERS)+"]")))&&{username:ew.language.phrase("InvalidUsernameChars")}}},password:function(e){return function(t){return!(e||ew.ENCRYPTED_PASSWORD||!t.value.match(new RegExp("["+ew.escapeRegExChars(ew.INVALID_PASSWORD_CHARACTERS)+"]")))&&{password:ew.language.phrase("InvalidPasswordChars")}}},email:function(e){let t=ew.getValue(e);return!ew.checkEmail(t)&&{email:ew.language.phrase("IncorrectEmail")}},emails:function(e,t){return function(a){let n=ew.getValue(a);return!ew.checkEmails(n,e)&&{email:t}}},datetime:function(e){return function(t){let a=ew.getValue(t);return!ew.checkDate(a,e)&&{datetime:ew.language.phrase("IncorrectDate").replace(/%s/g,e)}}},time:function(e){return function(t){let a=ew.getValue(t);return!ew.checkTime(a,e)&&{time:ew.language.phrase("IncorrectTime").replace(/%s/g,e)}}},float:function(e){let t=ew.getValue(e);return!ew.checkNumber(t)&&{time:ew.language.phrase("IncorrectFloat")}},range:function(e,t){return function(a){let n=ew.getValue(a);return!ew.checkRange(n,e,t)&&{range:ew.language.phrase("IncorrectRange").replace("%1",e).replace("%2",t)}}},integer:function(e){let t=ew.getValue(e);return!ew.checkInteger(t)&&{integer:ew.language.phrase("IncorrectInteger")}},phone:function(e){let t=ew.getValue(e);return!ew.checkPhone(t)&&{phone:ew.language.phrase("IncorrectPhone")}},zip:function(e){let t=ew.getValue(e);return!ew.checkZip(t)&&{zip:ew.language.phrase("IncorrectZip")}},creditCard:function(e){let t=ew.getValue(e);return!ew.checkCreditCard(t)&&{creditCard:ew.language.phrase("IncorrectCreditCard")}},ssn:function(e){let t=ew.getValue(e);return!ew.checkSsn(t)&&{ssn:ew.language.phrase("IncorrectSSN")}},guid:function(e){let t=ew.getValue(e);return!ew.checkGuid(t)&&{guid:ew.language.phrase("IncorrectGUID")}},regex:function(e){return function(t){let a=ew.getValue(t);return!ew.checkByRegEx(a,e)&&{regex:ew.language.phrase("IncorrectField")}}},url:function(e){let t=ew.getValue(e);return!ew.checkUrl(t)&&{url:ew.language.phrase("IncorrectUrl")}},custom:function(e,...t){return function(a){if("function"==typeof e){let n=ew.getValue(a);if(e(n,...t))return{custom:ew.language.phrase("IncorrectField")}}return!1}},captcha:function(e){return!(!e||ew.hasValue(e))&&{captcha:ew.language.phrase("EnterValidateCode")}},recaptcha:function(e){var t;return!(!e||ew.hasValue(e)||""!==(null==(t=grecaptcha)?void 0:t.getResponse(e.dataset.id)))&&{recaptcha:ew.language.phrase("ClickReCaptcha")}}};function o(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function d(e,t,a){return t&&o(e.prototype,t),a&&o(e,a),e}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function c(e,t){return c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},c(e,t)}function f(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,c(e,t)}function p(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}r.default.batchSettings={type:"POST",contentType:"application/json",processData:!1,dataType:"json",toJSON:JSON.stringify,parse:e=>e},r.default.batchSetup=function(e){return r.default.extend(r.default.batchSettings,e)};var h=r.default.batch=function(e,t){return this instanceof h?("object"==typeof e&&(t=e,e=void 0),this.options=r.default.extend({},r.default.batchSettings,t),this.parent=r.default.ajaxSetup()._batch,this.requests=[],e&&this.add(e),this):new h(e,t)};r.default.extend(h.prototype,{add:function(e){var t;return r.default.ajaxSetup({_batch:this.parent||this}),null!=(t=e.name)&&t.startsWith("bound ")?e():e.call(r.default.ajaxSetup()._batch),this.parent||r.default.ajaxSetup({_batch:null}),this},clear:function(){this.requests=[]},send:function(e){e=e||{};var t=this;if(this.parent&&e.success){var a=this.parent.options.success;this.parent.options.success=function(t,n,i){e.success(t,n,i),a&&a(t,n,i)}}else if(this.requests.length){var n=r.default.map(this.requests,(function(e){return e.settings.data})),i=e.success,l=this.options.success;return e.success=function(e,a,n){t._deliver.call(t,e,a),l&&l(e,a,n),i&&i(e,a,n)},(e=r.default.extend({},this.options,e)).data||(e.data=r.default.batchSettings.toJSON(n)),r.default.ajax(e)}},_addRequest:function(e,t){this.requests.push({xhr:e,settings:t})},_deliver:function(e,t){var a,n,l=this,s=r.default.batchSettings.parse(e);null!=s&&null!=(a=s.error)&&a.description?i.default.alert(null==s||null==(n=s.error)?void 0:n.description):r.default.each(s,(function(e,a){var n;if(l.requests[e]){var i,r=l.requests[e];if(r.xhr.statusText=t,"success"===t)null==(i=r.settings.success)||i.call(r.xhr,a,t);null==(n=r.settings.complete)||n.call(r.xhr,t)}}))}});var g=r.default.ajax;function m(e,t){var a=this,n=r.default(a);this._initiated=!1,this.id=e,this.element=document.getElementById(e),this.$element=r.default(this.element),this.pageId=t,this.htmlForm=null,this.initSearchPanel=!1,this.modified=!1,this.emptyRow=null,this.multiPage=null,this.autoSuggests={},this.lists={},this.batch=new h,this.formKeyCountName="",this.submitReturnsPromise=!1,this.disableForm=function(){var e=this.getForm();r.default(e).find(":submit:not(.dropdown-toggle)").prop("disabled",!0).addClass("disabled"),this.trigger("disabled")},this.enableForm=function(){var e=this.getForm(),t=r.default(e);t.find(".ew-disabled-element").removeClass("ew-disabled-element").prop("disabled",!1),t.find(".ew-enabled-element").removeClass("ew-enabled-element").prop("disabled",!0),t.find(":submit:not(.dropdown-toggle)").prop("disabled",!1).removeClass("disabled"),this.trigger("enabled")},this.appendHidden=function(e){var t=this.getForm(),a=r.default(t),n=r.default(e).closest(".ew-form"),i=n.attr("id")+"$"+e.name;if(!a.find("input:hidden[name='"+i+"']")[0]){var l=n.find('[name="'+e.name+'"]').serializeArray();l.length?l.forEach((function(e,t){r.default('<input type="hidden" name="'+i+'">').val(e.value).appendTo(a)})):r.default('<input type="hidden" name="'+i+'">').val("").appendTo(a)}},this.canSubmit=async function(e){var t=this.getForm(),n=r.default(t);if(this.disableForm(),this.updateTextArea(),!this.validate||this.validate()&&!n.find(".is-invalid")[0]){n.find("input[name^=sv_], input[name^=p_], .ew-template input, .ew-custom-option").prop("disabled",!0).addClass("ew-disabled-element"),n.find("[data-readonly=1][disabled]").prop("disabled",!1).addClass("ew-enabled-element");var i=n.find("input[name=detailpage]").map((function(e,t){return n.find("#"+t.value)[0]}));i.length>1&&i.each((function(e,t){r.default(t).find(":input").each((function(e,n){if(/^(fn_)?(x|o)\d*_/.test(n.name)){var r=i.not(t).find(":input[name='"+n.name+"']");r.length&&(a.appendHidden(n),r.each((function(){a.appendHidden(this)})))}}))}));let l={form:t,result:!0},s=r.default.Event("beforesubmit",{originalEvent:e});n.trigger(s,[l]);let o=await l.result;if(!s.isDefaultPrevented()&&(!0===o||r.default.isObject(o)&&o.value))return!0}else this.enableForm();return!1},this.submit=async function(e){var t,a;let n=this.getForm(),i=null==e||null==(t=e.originalEvent)||null==(a=t.submitter)?void 0:a.formAction;if(i&&n.setAttribute("action",i),await this.canSubmit(e)){if(this.submitReturnsPromise){let e=n.getAttribute("action").split("#")[0].split("?")[0],t=n.method.toUpperCase(),a=r.default(n).serialize();return ew.fetch(e,{method:t,body:a}).finally((()=>this.enableForm()))}n.submit()}else this.enableForm()},this.getList=function(e){return e=e.replace(/^(sv_)?[xy](\d*|\$rowindex\$)_|\[\]$/g,""),this.lists[e]},this.compileTemplates=function(){let e=Object.values(this.lists);for(let t of e)t.template&&r.default.isString(t.template)&&(t.template=r.default.templates(t.template))},this.getForm=function(){var e,t;this.htmlForm||("FORM"==(null==(e=this.element)?void 0:e.tagName)?this.htmlForm=this.element:"DIV"==(null==(t=this.element)?void 0:t.tagName)&&(this.htmlForm=this.element.closest("form")));return this.htmlForm},this.getElement=function(e){return e?ew.getElement(e,this.$element):this.$element[0]},this.getElements=function(e){var t="[name='"+e+"']";t="input"+t+",selection-list"+t+",select"+t+",textarea"+t+",button"+t;var a=this.$element.find(t);return 0==a.length?null:1==a.length&&a.is("[type=checkbox]")||1==a.length&&a.is(":not([type=checkbox]):not([type=radio])")||2==a.length&&a.eq(0).is("selection-list")&&a.eq(1).is("input[type=hidden]")?a[0]:a.get()},this.updateLists=function(e,t){var n;if(null!==e&&("grid"!=this.pageId||r.default.isNumber(e)||r.default.isUndefined(e))){var i=this.getForm();if("confirm"!=(null==i||null==(n=i.querySelector("input#confirm"))?void 0:n.value)){var l=(t,a)=>{var n="",i=e,l=t.split(" ");l.length>1&&(n=l[0],i="",t=l[1]);let s=r.default.isNumber(i)?"x"+i+"_":"x_";return t=t.startsWith("x_")?t.replace(/^x_/,s):s+t,a&&!t.endsWith("[]")&&(t+="[]"),n?n+" "+t:t},s=Object.entries(this.lists).map((([e,t])=>"[name='"+l(e,t.multiple)+"']")).join();if(s&&i.querySelector(s)){this.compileTemplates();var o=[];for(let[e,t]of Object.entries(this.lists)){let a=t.parentFields.slice().map((e=>l(e))),n=t.ajax&&!t.lookupOptions.length;if(e=l(e,t.multiple),n){let t=a.map((e=>ew.getOptionValues(e,i)));o.push([e,t,n,!1])}else ew.updateOptions.call(this,e,a,!1,!1)}o.forEach((e=>this.batch.add(ew.updateOptions.bind(this,...e))))}if(this.batch.requests.length){if(void 0===e||t){let e=[],t=ew.ajaxBatchSize>0?ew.ajaxBatchSize:1;for(;this.batch.requests.length>t;){let a=new h;a.requests=this.batch.requests.splice(0,t),e.push(a.send({url:ew.getApiUrl(ew.API_LOOKUP_ACTION)}))}this.batch.requests.length>0&&e.push(this.batch.send({url:ew.getApiUrl(ew.API_LOOKUP_ACTION)})),r.default.when(...e).then((()=>r.default(document).trigger("updatedone",[{source:a,target:i}]))).fail((e=>console.log(e))).always((()=>this.batch.clear()))}}else r.default(document).trigger("updatedone",[{source:a,target:i}])}}},this.createAutoSuggest=function(e){var t=Object.assign({limit:ew.AUTO_SUGGEST_MAX_ENTRIES,form:this},ew.autoSuggestSettings,e);a.autoSuggests[e.id]=new ew.AutoSuggest(t)},this.initEditors=function(){var e=this.getForm();r.default(e.elements).filter("textarea.editor").each((function(e,t){var a=r.default(t).data("editor");!a||a.active||a.name.includes("$rowindex$")||a.create()}))},this.updateTextArea=function(e){var t=this.getForm();r.default(t.elements).filter("textarea.editor").each((function(t,a){var n=r.default(a).data("editor");return!(n&&(!e||n.name==e))||(n.save(),!e&&void 0)}))},this.destroyEditor=function(e){var t=this.getForm();r.default(t.elements).filter("textarea.editor").each((function(t,a){var n=r.default(a).data("editor");return!(n&&(!e||n.name==e))||(n.destroy(),!e&&void 0)}))},this.onError=function(e,t){return ew.onError(this,e,t)},this.initUpload=function(){var e=this.getForm();r.default(e.elements).filter("input:file:not([name*='$rowindex$'])").each((function(e){r.default.later(ew.AJAX_DELAY*e,null,ew.upload,this)}))},this.setupFilters=function(e,t){var n=this.id,i=this.filterList?this.filterList.data:null,l=r.default(".ew-save-filter[data-form="+n+"]").toggleClass("disabled",!i),s=r.default(".ew-delete-filter[data-form="+n+"]").toggleClass("disabled",!t.length).toggleClass("dropdown-toggle",!!t.length),o=s.parent("li").toggleClass("dropdown-submenu dropdown-hover",!!t.length).toggleClass("disabled",!t.length),d=l.parent("li").toggleClass("disabled",!i),u=function(e,t){if("Client"==ew.SEARCH_FILTER_OPTION)localStorage.setItem(ew.PROJECT_NAME+"_"+e+"_filters",JSON.stringify(t));else if("Server"==ew.SEARCH_FILTER_OPTION){var n=r.default("body").css("cursor","wait");r.default.ajax(ew.currentPage(),{type:"POST",dataType:"json",data:{ajax:"savefilters",filters:JSON.stringify(t)}}).done((function(e){e[0]&&e[0].success&&(a.filterList.filters=t)})).always((function(){n.css("cursor","default")}))}};if(d.off("click.ew").on("click.ew",(function(e){if(d.hasClass("disabled"))return!1;ew.prompt({input:"text",html:ew.language.phrase("EnterFilterName")},(e=>{(e=ew.sanitize(e))&&(t.push([e,i]),u(n,t))}),!0)})).prevAll().remove(),s.next("ul.dropdown-menu").remove(),t.length){var c=r.default("<ul class='dropdown-menu'></ul>");for(var f in t)Array.isArray(t[f])&&(r.default('<li><a class="dropdown-item" data-index="'+f+'" data-ew-action="none">'+t[f][0]+"</a></li>").on("click",(function(e){var a=r.default(this).find("a[data-index]").data("index");ew.prompt(ew.language.phrase("DeleteFilterConfirm").replace("%s",t[a][0]),(e=>{e&&(t.splice(a,1),u(n,t))}))})).appendTo(c),r.default('<li><a class="dropdown-item ew-filter-list" data-index="'+f+'" data-ew-action="none">'+t[f][0]+"</a></li>").insertBefore(d).on("click",(function(e){var a=r.default(this).find("a[data-index]").data("index");r.default("<form>").attr({method:"post",action:ew.currentPage()}).append(r.default("<input type='hidden'>").attr({name:"cmd",value:"resetfilter"}),r.default("<input type='hidden'>").attr({name:ew.TOKEN_NAME_KEY,value:ew.TOKEN_NAME}),r.default("<input type='hidden'>").attr({name:ew.ANTIFORGERY_TOKEN_KEY,value:ew.ANTIFORGERY_TOKEN}),r.default("<input type='hidden'>").attr({name:"filter",value:JSON.stringify(t[a][1])})).appendTo("body").trigger("submit")})));r.default("<li class='dropdown-divider'></li>").insertBefore(d),o.append(c)}},this.on=function(){n.on(...arguments)},this.one=function(){n.one(...arguments)},this.off=function(){n.off(...arguments)},this.trigger=function(){n.trigger(...arguments)},this.init=function(){if(!this._initiated){var e=this.getForm();if(e){var t=r.default(e);"Client"==ew.SEARCH_FILTER_OPTION||"Server"==ew.SEARCH_FILTER_OPTION&&ew.IS_LOGGEDIN&&!ew.IS_SYS_ADMIN&&""!=ew.CURRENT_USER_NAME?r.default(".ew-filter-option .ew-btn-dropdown").on("show.bs.dropdown",(function(e){var t,n,i=[];if("Client"==ew.SEARCH_FILTER_OPTION){var l=localStorage.getItem(ew.PROJECT_NAME+"_"+a.id+"_filters");l&&(i=ew.parseJson(l)||[])}else"Server"==ew.SEARCH_FILTER_OPTION&&(i=null!=(t=null==(n=a.filterList)?void 0:n.filters)?t:[]);var s=r.default.grep(i,(function(e){if(Array.isArray(e)&&2==e.length)return e}));a.setupFilters(e,s)})).removeClass("d-none").show():r.default(".ew-filter-option").addClass("d-none").hide(),this.compileTemplates(),/s(ea)?rch$/.test(this.id)&&(this.initSearchPanel&&!ew.hasFormData(e)&&r.default("#"+this.id+"_search_panel").removeClass("show"),r.default(".ew-table .ew-search-operator").text().trim()||r.default(".ew-table .ew-search-operator").parent("td").hide(),t.find("select[id^=z_]").each((function(){"BETWEEN"!=r.default(this).trigger("change").val()&&t.find("#w_"+this.id.substring(2)).trigger("change")}))),this.multiPage&&this.multiPage.render(),loadjs.ready(["editor"],(()=>setTimeout(this.initEditors.bind(this),0))),this.updateLists(),this.initUpload(),this.$element.is("form")&&(this.$element.find(".ew-detail-pages .ew-nav a[data-bs-toggle=tab]").on("shown.bs.tab",(function(e){var t=r.default(e.target.getAttribute("href")),a=t.find(".table-responsive.ew-grid-middle-panel"),n=t.closest(".container-fluid");a.width()>=n.width()?a.width(n.width()+"px"):a.width("auto")})),t.on("submit",(function(t){let n={form:e,result:a.submit(t)},i=r.default.Event("aftersubmit",{originalEvent:t});return a.trigger(i,[n]),!1})),t.find("[data-field], .ew-priv").on("change",(function(){ew.CONFIRM_CANCEL&&(a.modified=!0)})),t.find("#btn-cancel[data-href]").on("click",(function(){a.updateTextArea();var n=this.dataset.href;a.modified&&ew.hasFormData(e)?ew.prompt(ew.language.phrase("ConfirmCancel"),(e=>{e&&(t.find("#btn-action").prop("disabled",!0),window.location=n)})):(t.find("#btn-action").prop("disabled",!0),window.location=n)}))),this._initiated=!0,this.$element.data("form",this),this.trigger("initiated")}}},ew.forms.add(this)}r.default.ajax=function(e,t){"object"==typeof e&&(t=e,e=void 0);var a=(t=t||{}).beforeSend;return t.beforeSend=function(e,t){if(a){var n=a(e,t);if(!1===n)return n}if(t._batch)return t._batch._addRequest(e,t),!1},g.call(this,e,t)};let w=function(){function e(e,t,a){if(p(this,"name",""),p(this,"validators",[]),p(this,"_validate",!0),this.name=e,Array.isArray(t))for(let e of t)this.addValidator(e);else"function"==typeof t&&this.addValidator(t);this.invalid=a}var t=e.prototype;return t.addValidator=function(e){"function"==typeof e&&this.validators.push(e)},t.addError=function(e){if(e){var t;let a=null!=(t=this._error)?t:{};this._error={...a,...e},this.invalid=!0}},t.clearErrors=function(){this._error=null,this.invalid=!1},t.clearValidators=function(){this.validators=[]},t.validate=function(){let e=!0;if(this.clearErrors(),this._element&&this.shouldValidate&&Array.isArray(this.validators)){for(let t of this.validators){let a=t(this._element);!1!==a&&(this.addError(a),e=!1)}this.updateFeedback()}return e},t.resetInvalid=function(){var e,t,a,n;this.clearErrors(),null!=(e=this._element)&&null!=(t=e.classList)&&t.contains("is-invalid")&&!this._error&&this.addError({server:null==(a=this._element.closest(ew.fieldContainerSelector))||null==(n=a.querySelector(".invalid-feedback"))?void 0:n.innerHTML})},t.updateFeedback=function(){let e=this.errorMessage;if(this._element&&e){var t;let a=null==(t=this._element.closest(ew.fieldContainerSelector))?void 0:t.querySelector(".invalid-feedback");a&&(a.innerHTML=e),ew.setInvalid(this._element)}},t.focus=function(e){this._element&&ew.setFocus(this._element,e)},t.canFocus=function(){var e,t;let a=this._element;return a&&!(a.hidden&&"SELECTION-LIST"==!a.tagName||a.readonly||a.disabled||"hidden"==a.type||"none"==(null==(e=a.style)?void 0:e.display)||null!=(t=a.classList)&&t.contains("d-none"))},d(e,[{key:"error",get:function(){return this._error}},{key:"errorMessage",get:function(){return this._error?Array.from(Object.values(this._error)).join("<br>"):""}},{key:"shouldValidate",get:function(){return!this._checkbox||this._checkbox.checked}},{key:"element",get:function(){return this._element},set:function(e){var t,a;this._element=e,this._checkbox=null!=(t=this._element)&&null!=(a=t.id)&&a.match(/^[xy]_/)?document.getElementById(this._element.id.replace(/^[xy]_/,"u_")):null}},{key:"value",get:function(){return this._element?ew.getValue(this._element):""}},{key:"focused",get:function(){return this._element&&this._element==document.activeElement}}]),e}(),v=function(e){function t(t,a){var n;return p(u(n=e.call(this,t,a)||this),"row",{}),p(u(n),"fields",{}),p(u(n),"validateRequired",!0),p(u(n),"autoFocus",!0),p(u(n),"autoFocusPreventScroll",!0),n.on("initiated",(function(){this.getForm().classList.contains("ew-wait")?this.one("enabled",(function(){this.setInvalid(),this.tryFocus()})):(this.setInvalid(),this.tryFocus())})),n}f(t,e);var a=t.prototype;return a.addField=function(e,t,a){e in this.fields||(this.fields[e]=new w(e,t,a))},a.getField=function(e){return this.fields[e]},a.addFields=function(e){if(Array.isArray(e))for(let t of e)Array.isArray(t)&&this.addField.apply(this,t)},a.addError=function(e,t){var a;t&&(this._error=null!=(a=this._error)?a:{},this._error[e]=t)},a.addCustomError=function(e,t){if(e in this.fields){let a=this.fields[e],n={custom:t};a.addError(n),a.updateFeedback(),this.addError(e,n)}return!1},a.getFieldElements=function(e,t){return this.getElements("x"+(null!=t?t:"")+"_"+e)||this.getElements("x"+(null!=t?t:"")+"_"+e+"[]")||this.getElements(e)},a.setFocus=function(e){let a=this.makeVisible(e)?t.focusDelay:0;if(e!=document.activeElement&&e.focus){let n=!e.closest(".modal-body")&&t.autoFocusPreventScroll&&this.autoFocusPreventScroll;setTimeout((()=>{e.focus({preventScroll:n})}),a),this._focused=!0}},a.focus=function(){if(this.canFocus())for(let[t,a]of Object.entries(this.fields)){var e;if((a.invalid||null!=(e=this._error)&&e[t])&&(this.getFocusable(a),a.canFocus())){this.setFocus(a.element);break}}},a.getFocusable=function(e){null!=e.element||(e.element=this.getFieldElements(e.name)),e.canFocus()||(e.element=this.getFieldElements(e.name,0)),e.canFocus()||(e.element=this.getFieldElements(e.name,1))},a.tryFocus=function(e){if(this.canFocus()&&(e||t.autoFocus&&this.autoFocus&&!this._focused))if(e||!this.invalid){if(["add","edit"].includes(this.pageId)){let e=this.getForm(),t=Array.from(e.querySelectorAll("input[name=detailpage]")).find((e=>{var t;return null==(t=ew.forms.get(e.value))?void 0:t.invalid}));if(t)return void t.focus()}for(let[t,a]of Object.entries(this.fields))if((!e||e===t)&&(a.element=null,this.getFocusable(a),a.canFocus()))return void this.setFocus(a.element);this.id.endsWith("srch")&&this.element.psearch&&this.element.psearch!=document.activeElement&&(this.element.psearch.focus({preventScroll:t.autoFocusPreventScroll&&this.autoFocusPreventScroll}),this._focused=!0)}else this.focus()},a.canFocus=function(){var e,t;let a=this.element;return a&&!(a.hidden||"hidden"==a.type||"none"==(null==(e=a.style)?void 0:e.display)||null!=(t=a.classList)&&t.contains("d-none"))},a.makeVisible=function(e){if(this.multiPage)return this.multiPage.gotoPageByElement(e),!0;if(this.$element.is("div")){let e=this.$element.closest(".tab-pane");if(e[0]&&!e.hasClass("active"))return e.closest(".ew-nav").find("a[data-bs-toggle=tab][href='#"+e.attr("id")+"']").trigger("click"),!0}return!1},a.validateFields=function(e){null!=e||(e=""),e<2&&(this.value=null),this.row={},this._error=null;let t=!0;for(let a of Object.values(this.fields))a.element=this.getFieldElements(a.name,e),this.row[a.name]=a.value,a.element&&!a.validate()&&(this.addError(a.name,a.error),t=!1);if(this.value){Array.isArray(this.value)||(this.value=[this.value]);let t=parseInt(e,10)||0;t=t>1?t-1:0,this.value[t]={...this.row}}else this.value={...this.row};return this.focus(),t},a.validate=function(){var e,t,a;if(!this.validateRequired)return!0;let n=this.getForm();if("confirm"==(null==(e=n.querySelector("#confirm"))?void 0:e.value))return!0;if("update"==this.pageId&&!ew.updateSelected(n))return ew.alert(ew.language.phrase("NoFieldSelected")),!1;let i=0,r=null==(t=n.querySelector("#action"))?void 0:t.value,l=this.formKeyCountName?null==(a=n.querySelector("#"+this.formKeyCountName))?void 0:a.value:null,s=n.querySelectorAll("input[name=detailpage]"),o="gridinsert"==r||"insert"==r&&Array.from(s).some((e=>e.value==this.id)),d="insert"==r&&!o,u=d?0:1,c=d?0:parseInt(l,10)||1;for(let e=u;e<=c;e++){let t=l?String(e):"";if(n.dataset.rowindex=t,["list","grid"].includes(this.pageId)){if(o&&this.emptyRow(t))continue;i++}if(!this.validateFields(t))return!1;if(this.customValidate&&!this.customValidate(n))return this.focus(),!1}return"list"==this.pageId&&o&&0==i?(ew.alert(ew.language.phrase("NoAddRecord")),!1):(["add","edit"].includes(this.pageId)&&s.forEach((e=>{let t=ew.forms.get(e.value);if(t&&!t.validate())return!1})),!0)},a.getValue=function(e){var t;e=null!=(t=e)?t:"";let a={};for(let t of Object.values(this.fields)){null!=t.element||(t.element=this.getFieldElements(t.name,e)),a[t.name]=t.value}return a},a.setInvalid=function(e){let t=this.getForm();if("undefined"==typeof e&&this.formKeyCountName){let e=t.querySelector("#"+this.formKeyCountName),a=parseInt(null==e?void 0:e.value,10)||1;for(let t=0===a?0:1;t<=a;t++){let a=e?String(t):"";this.setInvalid(a)}}else{var a;e=null!=(a=e)?a:"";for(let t of Object.values(this.fields))t.element=this.getFieldElements(t.name,e),e&&t.resetInvalid(),t.invalid&&(this.addError(t.name,t.error),this._focused||this.focus(),ew.setInvalid(t.element));["add","edit"].includes(this.pageId)&&t.querySelectorAll("input[name=detailpage]").forEach((e=>{var t;return null==(t=ew.forms.get(e.value))?void 0:t.setInvalid()}))}},d(t,[{key:"error",get:function(){return this._error}},{key:"invalid",get:function(){return this._error||Object.values(this.fields).some((e=>e.invalid))}}]),t}(m);p(v,"autoFocus",!0),p(v,"autoFocusPreventScroll",!0),p(v,"focusDelay",200);let b=function(){function e(e){p(this,"_isAutoSuggest",null),this.elementId=e.id,this.form=e.form,r.default.isString(this.form)&&(this.form=ew.forms.get(this.form)),this.element=this.form.getElement(this.elementId),this.formElement=this.form.getElement(),this.list=this.form.getList(this.elementId);let t=this.elementId.match(/^[xy](\d*|\$rowindex\$)_/),a=t?t[1]:"";this.parentFields=this.list.parentFields.slice().map((e=>1==e.split(" ").length?e.replace(/^x_/,"x"+a+"_"):e)),this.limit=e.limit,this.debounce=e.debounce,this.data=e.data,this.recordCount=0,this.action=e.action||"autosuggest"}var t=e.prototype;return t.formatResult=function(e){return this.form.compileTemplates(),this.list.template&&!this.isAutoSuggest?this.list.template.render(e,ew.jsRenderHelpers):ew.displayValue(e,this.element)||e[0]},t.generateRequest=function(){var e=Object.assign({},this.data,{name:this.element.name,page:this.list.page,field:this.list.field,language:ew.LANGUAGE_ID},ew.getUserParams("#p_"+this.elementId,this.formElement));return null!=e.ajax||(e.ajax=this.action),this.parentFields.length>0&&this.parentFields.forEach(((t,a)=>{let n=ew.getOptionValues(t,this.formElement);e["v"+(a+1)]=n.join(ew.MULTIPLE_OPTION_SEPARATOR)})),e},t.getUrl=function(e,t){let a=new URLSearchParams({q:e||"",n:this.limit,rnd:ew.random(),start:r.default.isNumber(t)?t:-1});return ew.getApiUrl(ew.API_LOOKUP_ACTION,a.toString())},t.prepare=function(e,t){return{url:this.getUrl(e,t),type:"POST",dataType:"json",data:this.generateRequest()}},t.transform=function(e){let t=[];return"OK"==(null==e?void 0:e.result)&&(this.recordCount=e.totalRecordCount,t=e.records),t},d(e,[{key:"isAutoSuggest",get:function(){return null===this._isAutoSuggest&&(this._isAutoSuggest=ew.isAutoSuggest(this.element)),this._isAutoSuggest}},{key:"options",get:function(){return this.list.lookupOptions}}]),e}(),y=function(e,t,a){this.value=String(e),this.text=String(t),this.selected=!!a},_=function(e){function t(t){var a;if((a=e.call(this,t)||this).input=a.form.getElement("sv_"+a.elementId),!a.input||a.elementId.includes("$rowindex$"))return u(a);let n=u(a),i=r.default(a.input),l=r.default(a.element);a.minWidth=t.minWidth,a.maxHeight=t.maxHeight,a.highlight=t.highlight,a.hint=t.hint,a.minLength=t.minLength,a.templates=Object.assign({},t.templates),a.classNames=Object.assign({},t.classNames),a.delay=t.delay,a.debounce=t.debounce,a.display=t.display||"text",a.forceSelection=t.forceSelect,a.lineHeight=t.lineHeight,a.paddingY=t.paddingY,a.$input=i,a.$element=l,l.data("autosuggest",u(a)),i.val()&&l.val()&&a.element.add(l.val(),i.val(),!0),i.on("typeahead:select",((e,t)=>{n.setValue(t[n.display])})).on("change",(()=>{let e=i.data("tt-typeahead");if(null!=e&&e.isOpen()&&!e.menu.empty()){let t=e.menu.getActiveSelectable();if(t){let e=t.index(),a=n.element.options[e].text;i.typeahead("val",a)}}n.setValue()})).on("blur",(()=>{let e=i.data("tt-typeahead");null!=e&&e.isOpen()&&e.menu.close()})).on("focus",(()=>{i.attr("placeholder",i.data("placeholder")).removeClass("is-invalid"),l.removeClass("is-invalid")}));let s,o=!a.options.length,d=!1,c=n.list.template||n.templates.suggestion;c&&r.default.isString(c)&&(c=r.default.templates(c)),c&&(n.templates.suggestion=c.render.bind(c)),o&&!n.templates.footer&&(n.templates.footer='<div class="tt-footer dropdown-item">'+ew.language.phrase("LoadingMore")+"</div>");let f=(e,t,n)=>{if(o)s&&s.cancel(),s=r.default.later(a.debounce,null,(()=>{a.recordCount=0,r.default.ajax(a.prepare(e)).done((e=>n(a.transform(e))))}));else{let n=a.getSyncResults(e);t(a.transform({result:"OK",totalRecordCount:n.length,records:n}))}};return r.default((function(){let e=[{highlight:n.highlight,minLength:n.minLength,hint:n.hint,classNames:n.classNames},{name:n.form.id+"-"+n.elementId,source:f,async:o,templates:n.templates,display:n.display,limit:o?n.limit:1/0}];l.trigger("typeahead",[e]),n.typeahead=i.typeahead.apply(i,e).off("blur.tt").data("tt-typeahead");let t=n.typeahead.menu.$node,a=t.find(".tt-dataset"),s=()=>t.find(".tt-suggestion").outerHeight(!1);if(n.minWidth&&t.css("min-width",n.minWidth),i.on("typeahead:rendered",((e,i)=>{let r=i.length,l=n.count;if(l>=n.limit){let e=s();e&&a.css("max-height",e*n.limit)}r>0&&a.scrollTop(s()*(l-r)),o&&t.find(".tt-footer").toggle(n.recordCount>l)})),o){let e;a.on("scroll",(()=>{var i;null==(i=e)||i.cancel(),e=r.default.later(n.delay,null,(()=>{let i=t.find(".tt-footer");if(!i.is(":hidden")&&!d){var r;if(a.offset().top+a.outerHeight(!1)+20>i.offset().top+i.outerHeight(!1))d=!0,n.getMore().always((()=>d=!1));else null==(r=e)||r.cancel()}}))}))}})),a}f(t,e);var a=t.prototype;return a.setValue=function(e){e||(e=this.$input.val());let t=this.element.options.findIndex((t=>t.text==e));if(t<0){if(this.forceSelection&&e)return this.$input.typeahead("val","").addClass("is-invalid"),this.$element.next(".invalid-feedback").html(ew.language.phrase("ValueNotExist")),void this.$element.addClass("is-invalid").val("").trigger("change")}else this.element.options[t].selected=!0,/s(ea)?rch$/.test(this.formElement.id)&&!this.forceSelection||(e=this.element.options[t].value);e!==this.$element.attr("value")&&this.$element.attr("value",e).trigger("change")},a.transform=function(t){let a=e.prototype.transform.call(this,t).map((t=>Object.assign({},t,{text:e.prototype.formatResult.call(this,t)})));return this.element.options=a.map((e=>new y(e.lf||e[0],e.text))),a},a.getSyncResults=function(e){if(this.options.length){let t=this.options.filter((t=>{if(ew.LOOKUP_ALL_DISPLAY_FIELDS){let a=[t.df,t.df2,t.df3,t.df4].map((e=>String(e).toLowerCase())).join(" ");return e.toLowerCase().split(" ").filter((e=>""!==e)).every((e=>a.includes(e)))}return String(t.df).toLowerCase().startsWith(e)}));return this.recordCount=t.length,t}return[]},a.getMore=function(){let e=this.typeahead.menu,t=this.count,a=this.prepare(e.query,t);return r.default.ajax(a).done((t=>e.datasets[0]._append(e.query,this.transform(t))))},d(t,[{key:"count",get:function(){return this.typeahead.menu.$node.find(".tt-suggestion.tt-selectable").length||0}}]),t}(b),S=function(){function e(){p(this,"_forms",{})}var t=e.prototype;return t.get=function(e){var t;if(!e)return null;let a=r.default.isString(e)?e:null==(t=ew.getForm(e))?void 0:t.id;return this._forms[a]},t.add=function(e){this._forms[e.id]&&this._forms[e.id]!==e&&delete this._forms[e.id],this._forms[e.id]=e},t.ids=function(){return Object.keys(this._forms)},e}();var E={errorLoading:function(){return ew.language.phrase("ErrorLoading")},inputTooLong:function(e){var t=e.input.length-e.maximum;return ew.language.phrase("InputTooLong").replace("%s",t)},inputTooShort:function(e){var t=e.minimum-e.input.length;return ew.language.phrase("InputTooShort").replace("%s",t)},loadingMore:function(){return ew.language.phrase("LoadingMore")},maximumSelected:function(e){return ew.language.phrase("MaximumSelected").replace("%s",e.maximum)},noResults:function(){return ew.language.phrase("NoResults")},searching:function(){return ew.language.phrase("Searching")},removeAllItems:function(){return ew.language.phrase("RemoveAllItems")},removeItem:function(){return ew.language.phrase("RemoveItem")},search:function(){return ew.language.phrase("Search")}};let A=r.default.fn.select2.amd.require._defined["select2/utils"],T=function(){function e(){}var t=e.prototype;return t.render=function(e){var t=r.default('<div class="select2-results__options '+this.options.get("containerClass")+'" role="listbox"></div>');return this.options.get("multiple")&&t.attr("aria-multiselectable","true"),this.$results=t,t},t.displayMessage=function(e,t){var a=this.options.get("escapeMarkup");this.clear(),this.hideLoading();var n=r.default('<div role="alert" aria-live="assertive" class="select2-results__option"></div>');if(t.message.includes("<")&&t.message.includes(">"))n.append(t.message);else{var i=this.options.get("translations").get(t.message);n.append(a(i(t.args)))}n[0].className+=" select2-results__message",this.$results.append(n)},t.append=function(e,t){if(this.hideLoading(),null!=t.results&&0!==t.results.length){t.results=this.sort(t.results);for(var a=this.options.get("columns"),n=t.results.length,i=this.$results.find("."+this.options.get("rowClass")).last(),l=0;l<t.results.length;l++){var s=t.results[l],o=this.option(s);if(i.length&&i.children().length!=a||(i=r.default('<div class="'+this.options.get("rowClass")+'"></div>'),this.$results.append(i)),i.append(o),l==n-1)for(var d=a-i.children().length,u=0;u<d;u++)i.append('<div class="'+this.options.get("cellClass")+'"></div>')}}else 0===this.$results.children().length&&(this.$element.data("updating")&&t.pagination.more?(this.trigger("results:message",{message:'<div class="spinner-border spinner-border-sm text-primary ew-select-spinner" role="status"><span class="visually-hidden">'+ew.language.phrase("Loading")+"</span></div> "+ew.language.phrase("Loading")}),this.$element.one("updated",(()=>this.$element.select2("close").select2("open")))):this.trigger("results:message",{message:"noResults"}))},t.option=function(e,t){var a=document.createElement("div");a.classList.add("select2-results__option"),a.classList.add("select2-results__option--selectable"),this.options.get("cellClass").split(" ").forEach((e=>a.classList.add(e)));var n={role:"option","aria-selected":"false"},i=window.Element.prototype.matches||window.Element.prototype.msMatchesSelector||window.Element.prototype.webkitMatchesSelector;for(var r in(null!=t.element&&i.call(t.element,":disabled")||null==t.element&&t.disabled)&&(n["aria-disabled"]="true",a.classList.remove("select2-results__option--selectable"),a.classList.add("select2-results__option--disabled")),null==t.id&&a.classList.remove("select2-results__option--selectable"),null!=t._resultId&&(a.id=t._resultId),t.title&&(a.title=t.title),n){var l=n[r];a.setAttribute(r,l)}return this.template(t,a),A.StoreData(a,"data",t),a},e}(),x=r.default.fn.select2.amd.require._defined["select2/utils"],I=function(){function e(){}return e.prototype.bind=function(e,t,a){var n,i=this;e.call(this,t,a),null==(n=t.listeners["results:select"])||n.pop(),this.$results.off("mouseup"),t.on("results:select",(function(e){var t=i.getHighlightedResults();if(0!==t.length){var a=x.GetData(t[0],"data");t.hasClass("select2-results__option--selected")?i.trigger("unselect",{originalEvent:e,data:a}):i.trigger("select",{originalEvent:e,data:a})}})),this.$results.on("mousedown",".select2-results__option--selectable",(function(e){this._mousedown=!0})),this.$results.on("mouseup",".select2-results__option--selectable",(function(e){if(this._mousedown){var t=r.default(this),a=x.GetData(this,"data");t.hasClass("select2-results__option--selected")?i.trigger("unselect",{originalEvent:e,data:a}):i.trigger("select",{originalEvent:e,data:a})}}))},e}(),O=function(){function e(){}return e.prototype.bind=function(e,t,a){var n,i=this;e.call(this,t,a),null==(n=t.listeners.close)||n.pop(),t.on("close",(function(){i.$search.attr("tabindex",-1).removeAttr("aria-controls").removeAttr("aria-activedescendant")}))},e}(),C=$.fn.select2.amd.require._defined["select2/keys"];C.PRINT_SCREEN=44;let N=function(){function e(){}return e.prototype.handleSearch=function(e,t){var a=t.which;if(![C.TAB,C.SHIFT,C.CTRL,C.ALT,C.PRINT_SCREEN].includes(a)){if(!this._keyUpPrevented){var n=this.$search.val();this.trigger("query",{term:n})}this._keyUpPrevented=!1}},e}(),P=function(e){function t(t,a,n){return e.call(this,t,a,n)||this}f(t,e);var a=t.prototype;return a._attachPositioningHandler=function(e,t){var a=this,n=["scroll.select2."+t.id,"resize.select2."+t.id,"orientationchange.select2."+t.id],i=()=>{a._positionDropdown(),a._resizeDropdown()};r.default(window).on(n.join(" "),i),t.$element.closest(".modal").on("scroll.select2."+t.id,i)},a._detachPositioningHandler=function(e,t){var a=["scroll.select2."+t.id,"resize.select2."+t.id,"orientationchange.select2."+t.id];r.default(window).off(a.join(" ")),t.$element.closest(".modal").off("scroll.select2."+t.id)},a._showDropdown=function(e){this.$dropdownContainer.appendTo(this.$dropdownParent),null!=this._popper||(this._popper=Popper.createPopper(this.$container[0],this.$dropdownContainer[0],{placement:ew.IS_RTL?"bottom-end":"bottom-start",modifiers:[{name:"flip",enabled:!0},{name:"preventOverflow",enabled:!0}]})),this._positionDropdown(),this._resizeDropdown()},a._positionDropdown=function(){var e;null==(e=this._popper)||e.update()},a.destroy=function(t){var a;e.prototype.destroy.call(this,t),null==(a=this._popper)||a.destroy(),this._popper=null},t}(r.default.fn.select2.amd.require._defined["select2/dropdown/attachBody"]),R=function(){function e(e,t,a){p(this,"$modal",null),a.set("dropdownParent",r.default(document.body)),e.call(this,t,a)}var t=e.prototype;return t.bind=function(e,t,a){let n=this;e.call(this,t,a),t.on("open",(function(){n._showDropdown(),n._bindContainerResultHandlers(t)})),this.$dropdownContainer.on("mousedown",(function(e){e.stopPropagation()}))},t.position=function(e,t,a){t.attr("class",a.attr("class")),t.removeClass("select2"),this.$container=a},t.render=function(e){let t=r.default("<span></span>"),a=e.call(this);return t.append(a),this.$dropdownContainer=t,t},t._bindContainerResultHandlers=function(e,t){if(this._containerResultsHandlersBound)return;let a=this;t.$modal=this.$modal,t.on("results:all",(function(){var e;a._updateDropdown(),null==(e=a.$search[0])||e.focus()})),t.on("results:append",(function(){a._updateDropdown()})),t.on("results:message",(function(){a._updateDropdown()})),t.on("select",(function(e){var t;let n=null==(t=e.originalEvent)?void 0:t.currentTarget;null==n||n.classList.add("select2-results__option--selected"),a._updateDropdown()})),t.on("unselect",(function(e){var t;let n=null==(t=e.originalEvent)?void 0:t.currentTarget;null==n||n.classList.remove("select2-results__option--selected"),a._updateDropdown()})),this._containerResultsHandlersBound=!0},t._updateDropdown=function(){this.$modal.find(this.$dropdownContainer)[0]||this.$modal.find(".modal-body").children().detach().end().append(this.$dropdownContainer)},t._showDropdown=function(e){let t=this,a=this.$element.val();this.$dropdownContainer.appendTo(this.options.get("dropdownParent")),null!=this.$modal||(this.$modal=r.default("#ew-modal-lookup-dialog")),this._updateDropdown(),this.$modal.find(".modal-title").empty().append(ew.language.phrase("LookupTitle").replace("%s",this.$element.data("caption"))),this.$modal.find(".modal-footer button[data-value]").off().on("click",(function(){r.default(this).data("value")||t.$element.val(a).trigger("change")})),this.$modal.modal("show").on("hidden.bs.modal",(function(e){t.$container.removeClass("select2-container--open")})).draggable(this.options.get("draggableOptions"))},e}(),L=function(e){function t(t,a,n){return e.call(this,t,a,n)||this}f(t,e);var a=t.prototype;return a.bind=function(e,t,a){var n=this;e.call(this,t,a),t.on("open",(function(){n._showDropdown(),n._bindContainerResultHandlers(t)})),t.on("close",(function(){n._hideDropdown()})),this.$dropdownContainer.on("mousedown",(function(e){e.stopPropagation()}))},a._positionDropdown=function(){var e;null==(e=this._popper)||e.update()},a._resizeDropdown=function(){var e={width:this.$container.outerWidth(!1)+"px"};this.options.get("dropdownAutoWidth")&&(e.minWidth=e.width,e.position="relative",e.width="auto"),this.$dropdown.css(e)},a._showDropdown=function(e){var t;this.$dropdownContainer.appendTo(this.$dropdownParent);let a=this,n=this.$element.val(),i=r.default("#ew-filter-dropdown-footer").contents().clone();i.find(".ew-filter-btn[data-value]").off().on("click",(function(e){r.default(this).data("value")?ew.forms.get(a.$element[0].form).submit():a.$element.val(n).trigger("change"),a.$element.select2("close")})),i.find(".ew-filter-clear").off().on("click",(e=>a.$element.data("select2").selection._handleClear(e)));let l=this.$dropdownContainer.find(".ew-filter-dropdown");l.find(".ew-filter-btn")[0]||l.append(i);var s=document.querySelector(".ew-filter-dropdown-btn[data-table="+this.$element.data("table")+"][data-field="+this.$element.data("field")+"]"),o=null!=(t=s.closest(".ew-table-header-cell"))?t:s.closest(".ew-table-header-btn");null!=this._popper||(this._popper=Popper.createPopper(o,this.$dropdownContainer[0],{placement:ew.IS_RTL?"bottom-end":"bottom-start",modifiers:[{name:"flip",enabled:!0},{name:"preventOverflow",enabled:!0}]})),this._positionDropdown(),this._resizeDropdown()},a.position=function(e,t,a){t.attr("class",a.attr("class")),t[0].classList.remove("select2"),t[0].classList.add("select2-container--open"),this.$container=a},a.destroy=function(t){var a;e.prototype.destroy.call(this,t),null==(a=this._popper)||a.destroy(),this._popper=null},t}(r.default.fn.select2.amd.require._defined["select2/dropdown/attachBody"]),F=function(e){function t(t,a,n){return e.call(this,t,a,n)||this}f(t,e);var a=t.prototype;return a.bind=function(e,t,a){var n=this;e.call(this,t,a),t.on("open",(function(){n._showDropdown(),n._bindContainerResultHandlers(t)})),t.on("close",(function(){n._hideDropdown()})),this.$dropdownContainer.on("mousedown",(function(e){e.stopPropagation()}))},a._showDropdown=function(e){this.$dropdownContainer.appendTo(this.$dropdownParent),null!=this._popper||(this._popper=Popper.createPopper(this.$element.parent().find(".select2-container")[0],this.$dropdownContainer[0],{placement:ew.IS_RTL?"bottom-end":"bottom-start",modifiers:[{name:"flip",enabled:!0},{name:"preventOverflow",enabled:!0}]})),this._positionDropdown(),this._resizeDropdown()},a._positionDropdown=function(){var e;null==(e=this._popper)||e.update()},a.position=function(e,t,a){t.attr("class",a.attr("class")),t[0].classList.remove("select2"),t[0].classList.add("select2-container--open"),this.$container=a},a.destroy=function(t){var a;e.prototype.destroy.call(this,t),null==(a=this._popper)||a.destroy(),this._popper=null},t}(r.default.fn.select2.amd.require._defined["select2/dropdown/attachBody"]),k=r.default.fn.select2.amd.require._defined,D=k["select2/selection/allowClear"],M=k["select2/utils"],U=function(e){function t(){return e.apply(this,arguments)||this}return f(t,e),t.prototype._handleClear=function(e,t){if(!this.isDisabled()){var a=this.$selection.find(".select2-selection__clear");if(0!==a.length){t.stopPropagation();var n=M.GetData(a[0],"data"),i=this.$element.val();this.$element.val(this.placeholder.id);var r={data:n};if(this.trigger("clear",r),r.prevented)this.$element.val(i);else{for(var l=0;l<n.length;l++)if(r={data:n[l]},this.trigger("unselect",r),r.prevented)return void this.$element.val(i);this.$element.trigger("input").trigger("change")}}}},t}(D),j=function(){function e(){}return e.prototype.bind=function(e,t,a){e.call(this,t,a),this.$selection.on("click",".select2-selection__choice__remove",(function(e){e.stopPropagation()}))},e}(),B=function(){function e(){}return e.prototype.option=function(e,t){var a,n=t.text,i=null==(a=t.element)?void 0:a.innerHTML,r=e.call(this,t);return n.startsWith("<")&&n.endsWith(">")?r.html(n):i&&i!=n&&r.html(i),r},e}(),K=$.fn.select2.amd.require._defined,H=K["select2/results"],G=K["select2/selection/single"],V=K["select2/selection/multiple"],q=K["select2/selection/placeholder"],W=K["select2/selection/allowClear"],z=K["select2/selection/search"],Y=K["select2/selection/eventRelay"],J=K["select2/utils"],X=K["select2/translation"],Z=K["select2/data/select"],Q=K["select2/data/array"],ee=K["select2/data/ajax"],te=K["select2/data/tags"],ae=K["select2/data/tokenizer"],ne=K["select2/data/minimumInputLength"],ie=K["select2/data/maximumInputLength"],re=K["select2/data/maximumSelectionLength"],le=K["select2/dropdown"],se=K["select2/dropdown/search"],oe=K["select2/dropdown/hidePlaceholder"],de=K["select2/dropdown/infiniteScroll"],ue=K["select2/dropdown/minimumResultsForSearch"],ce=K["select2/dropdown/selectOnClose"],fe=K["select2/dropdown/closeOnSelect"],pe=K["select2/dropdown/dropdownCss"],he=K["select2/dropdown/tagsSearchHighlight"],ge=K["select2/defaults"];ge.apply=function(e){return null==(e=$.extend(!0,{},this.defaults,e)).dataAdapter&&(null!=e.ajax?e.dataAdapter=ee:null!=e.data?e.dataAdapter=Q:e.dataAdapter=Z,e.dataAdapter=J.Decorate(e.dataAdapter,B),e.minimumInputLength>0&&(e.dataAdapter=J.Decorate(e.dataAdapter,ne)),e.maximumInputLength>0&&(e.dataAdapter=J.Decorate(e.dataAdapter,ie)),e.maximumSelectionLength>0&&(e.dataAdapter=J.Decorate(e.dataAdapter,re)),e.tags&&(e.dataAdapter=J.Decorate(e.dataAdapter,te)),null==e.tokenSeparators&&null==e.tokenizer||(e.dataAdapter=J.Decorate(e.dataAdapter,ae))),null==e.resultsAdapter&&(e.resultsAdapter=H,e.columns>0&&e.customOption?(e.resultsAdapter=J.Decorate(e.resultsAdapter,T),e.iconClass&&e.multiple&&e.templateResult==ew.selectOptions.templateResult&&(e._templateResult=e.templateResult,e.templateResult=t=>t.loading?t.text:'<div class="form-check-input ew-dropdown-check-input"></div><label class="'+e.iconClass+' ew-dropdown-check-label">'+e._templateResult(t)+"</label>")):(e.modal||e.filter)&&(e.resultsAdapter=J.Decorate(e.resultsAdapter,I)),null!=e.ajax&&(e.resultsAdapter=J.Decorate(e.resultsAdapter,de)),null!=e.placeholder&&(e.resultsAdapter=J.Decorate(e.resultsAdapter,oe)),e.selectOnClose&&(e.resultsAdapter=J.Decorate(e.resultsAdapter,ce)),e.tags&&(e.resultsAdapter=J.Decorate(e.resultsAdapter,he))),null==e.dropdownAdapter&&(e.modal||e.filter?(e.dropdownAdapter=J.Decorate(le,se),e.dropdownAdapter=J.Decorate(e.dropdownAdapter,N),e.dropdownAdapter=J.Decorate(e.dropdownAdapter,O)):(e.dropdownAdapter=le,e.multiple||(e.dropdownAdapter=J.Decorate(e.dropdownAdapter,se),e.dropdownAdapter=J.Decorate(e.dropdownAdapter,N))),0!==e.minimumResultsForSearch&&(e.dropdownAdapter=J.Decorate(e.dropdownAdapter,ue)),e.closeOnSelect&&(e.dropdownAdapter=J.Decorate(e.dropdownAdapter,fe)),null!=e.dropdownCssClass&&(e.dropdownAdapter=J.Decorate(e.dropdownAdapter,pe)),e.dropdownAdapter=J.Decorate(e.dropdownAdapter,e.modal?R:e.filter?L:e.dropdown?F:P)),null==e.selectionAdapter&&(e.multiple?(e.selectionAdapter=V,e.selectionAdapter=J.Decorate(e.selectionAdapter,j)):e.selectionAdapter=G,null!=e.placeholder&&(e.selectionAdapter=J.Decorate(e.selectionAdapter,q)),e.allowClear&&(e.selectionAdapter=J.Decorate(e.selectionAdapter,e.filter?U:W)),e.multiple&&(e.selectionAdapter=J.Decorate(e.selectionAdapter,z)),e.selectionAdapter=J.Decorate(e.selectionAdapter,Y)),e.translations=new X(E),e.dir=ew.IS_RTL?"rtl":"ltr",e};let me=new URL(window.location),we=new S,ve=r.default(document),be=r.default("body"),ye=".row, [id^=el_], [class^=el_]";function _e(e){var t;let a=null!=(t=null==e?void 0:e.target)?t:document,n={container:"body",trigger:ew.IS_MOBILE?"manual":"hover",placement:"bottom",sanitizeFn:ew.sanitizeFn};r.default(a).find(".ew-icon").closest(".btn").each((function(){let e=r.default(this);if(e.hasClass("dropdown-toggle")){let t=e.closest(".btn-group");1==t.children(".btn").length&&(t.tooltip({title:this.title,...n}).on("mouseleave",(e=>{var t;return null==(t=bootstrap.Tooltip.getInstance(e.currentTarget))?void 0:t.hide()})),e.next(".dropdown-menu").on("mouseover",(e=>e.stopPropagation())))}else e.tooltip(n)}))}function Se(e){var t,a=null!=(t=null==e?void 0:e.target)?t:document;r.default.fn.pStrength&&"undefined"!=typeof ew.MIN_PASSWORD_STRENGTH&&r.default(a).find(".ew-password-strength").each((function(){var e=r.default(this);e.data("pStrength")||e.pStrength({changeBackground:!1,backgrounds:[],passwordValidFrom:ew.MIN_PASSWORD_STRENGTH,onPasswordStrengthChanged:function(e,t){var a=r.default("[id='"+this.attr("data-password-strength")+"']"),n=a.find(".progress-bar");if(this.val()&&!ew.isMaskedPassword(this)){var i=t+"%",l=ew.MIN_PASSWORD_STRENGTH,s=t>=l;t<.25*l?n.addClass("bg-danger").removeClass("bg-warning bg-info bg-success"):t<.5*l?n.addClass("bg-warning").removeClass("bg-danger bg-info bg-success"):t<.75*l?n.addClass("bg-primary").removeClass("bg-danger bg-warning bg-success"):n.addClass("bg-success").removeClass("bg-danger bg-warning bg-info"),n.css("width",i),t>.5*l&&(i=ew.language.phrase("PasswordStrength").replace("%p",i)),n.html(i),a.removeClass("d-none"),this.data("validated",s),s&&Xe(this[0])}else a.addClass("d-none"),this.data("validated",null);a.width(this.outerWidth())}})})),r.default.fn.pGenerator&&r.default(a).find(".ew-password-generator").each((function(){var e=r.default(this);e.data("pGenerator")||e.pGenerator({passwordLength:ew.GENERATE_PASSWORD_LENGTH,uppercase:ew.GENERATE_PASSWORD_UPPERCASE,lowercase:ew.GENERATE_PASSWORD_LOWERCASE,numbers:ew.GENERATE_PASSWORD_NUMBER,specialChars:ew.GENERATE_PASSWORD_SPECIALCHARS,onPasswordGenerated:function(e){r.default("#"+this.attr("data-password-confirm")).val(e),r.default("#"+this.attr("data-password-field")).val(e).trigger("change").trigger("focus").triggerHandler("click")}})}))}function Ee(e,t){var a=ew.PATH_BASE+ew.API_URL,n=new URLSearchParams(t).toString();if(r.default.isString(e))a+=e||"";else if(Array.isArray(e)){var i=e.map((function(e){return encodeURIComponent(e)})).join("/");a+=i||""}return a+(n?"?"+n:"")}function Ae(e){var t=e.split("?"),a=t[1];if(a){var n=new URLSearchParams(a);n.forEach(((e,t)=>{e=decodeURIComponent(e),["<>","<=",">=",">","<"].includes(e)?n.set(t,e):n.set(t,ew.sanitize(e))})),a=n.toString()}return t[0]+(a?"?"+a:"")}function Te(e){var t,a=null!=(t=null==e?void 0:e.target)?t:document;r.default(a).find("a.ew-export-link[href]:not(.ew-email):not(.ew-print):not(.ew-xml)").on("click",(function(e){var t=this.href;t&&"#"!=t&&Ie(t),e.preventDefault()}))}function xe(e){var t,a=null!=(t=null==e?void 0:e.target)?t:document,n=r.default(a),i=n.find("input[type=checkbox].ew-multi-select"),l=function(e){var t=i.filter("[name^='"+e+"_']"),a=t.length,n=t.filter(":checked").length;r.default("input[type=checkbox]#"+e).prop("checked",n==a).prop("indeterminate",n!=a&&0!=n)};i.on("click",(e=>l(e.target.name.split("_")[0]))),n.find("input[type=checkbox].ew-priv:not(.ew-multi-select)").each(((e,t)=>l(t.id)))}function Ie(e,t){let a=e.includes("export=html");return Swal.fire({...ew.sweetAlertSettings,showConfirmButton:!1,html:"<p>"+ew.language.phrase("Exporting")+"</p>",allowOutsideClick:!1,allowEscapeKey:!1,willOpen:()=>{Swal.showLoading(),r.default.ajax({url:e,type:t?"POST":"GET",cache:!1,data:t||null,xhrFields:{responseType:a?"text":"blob"}}).done(((t,n,i)=>{var r=URL.createObjectURL(a?new Blob([t],{type:"text/html"}):t),l=document.createElement("a"),s=i.getResponseHeader("Content-Disposition").match(/\bfilename=((['"])(.+)\2|([^;]+))/i);l.style.display="none",l.href=r,s&&(l.download=s[3]||s[4]),document.body.appendChild(l),l.click(),ve.trigger("export",[{type:"done",url:e,objectUrl:r}]),URL.revokeObjectURL(r),Swal.close()})).fail(((t,a,n)=>{var i;Swal.hideLoading(),Swal.update({showConfirmButton:!0}),null==(i=Swal.getActions())||i.classList.add("d-flex"),Swal.showValidationMessage("<div class='text-danger'>"+(n||ew.language.phrase("FailedToExport"))+"</div>"),ve.trigger("export",[{type:"fail",url:e}])})).always((()=>{ve.trigger("export",[{type:"always",url:e}])}))}})}function Oe(e){var t;ew.LAZY_LOAD&&((null!=(t=null==e?void 0:e.target)?t:document).querySelectorAll("img.ew-lazy").forEach(((e,t)=>{ew.LAZY_LOAD_DELAY>0?setTimeout((()=>e.src=e.dataset.src),t*ew.LAZY_LOAD_DELAY):e.src=e.dataset.src})),ve.trigger("lazyload"))}function Ce(e){var t;if(ew.USE_COLORBOX){var a=null!=(t=null==e?void 0:e.target)?t:document,n=Object.assign({},ew.lightboxSettings,{title:ew.language.phrase("LightboxTitle"),current:ew.language.phrase("LightboxCurrent"),previous:ew.language.phrase("LightboxPrevious"),next:ew.language.phrase("LightboxNext"),close:ew.language.phrase("LightboxClose"),xhrError:ew.language.phrase("LightboxXhrError"),imgError:ew.language.phrase("LightboxImgError")});r.default(a).find(".ew-lightbox").each((function(){var e=r.default(this);e.colorbox(Object.assign({rel:e.data("rel")},n))}))}}function Ne(e){var t;if(ew.EMBED_PDF){var a=null!=(t=null==e?void 0:e.target)?t:document,n=Object.assign({},ew.PDFObjectOptions);r.default(a).find(".ew-pdfobject").not(":has(.pdfobject)").each((function(){var e=r.default(this),t=e.data("url"),a=e.html();t&&PDFObject.embed(t,this,Object.assign(n,{fallbackLink:a}))}))}}function Pe(e){var t,a=null!=(t=null==e?void 0:e.target)?t:document,n=r.default(a);n.find("input[data-bs-toggle=tooltip],textarea[data-bs-toggle=tooltip],select[data-bs-toggle=tooltip]").each((function(){var e=r.default(this);e.tooltip(Object.assign({html:!0,placement:"bottom",sanitizeFn:ew.sanitizeFn},e.data()))})),n.find("a.ew-tooltip-link").each(Ct),n.find(".ew-tooltip").tooltip({placement:"bottom",sanitizeFn:ew.sanitizeFn}),n.find(".ew-popover").popover({sanitizeFn:ew.sanitizeFn})}function Re(e){if(r.default.isString(e))try{return JSON.parse(e)}catch(e){return}return e}function Le(e){var t;let a=null!=(t=null==e?void 0:e.target)?t:document,n=r.default(a),i=ew.forms.ids();for(let e of i)n.find("#"+e)&&we.get(e).init()}function Fe(e){return"function"==typeof e}function ke(e,t,a){let n=r.default.isObject(e)?e:{};e=r.default.isString(e)?e:"",a=r.default.isString(t)?t:a,n=r.default.extend(!0,{},ew.sweetAlertSettings,{html:e,confirmButtonText:ew.language.phrase("OKBtn"),customClass:{htmlContainer:"ew-swal2-html-container text-"+(a||"danger")}},n);let i={config:n,type:a,show:!0};if(ve.trigger("alert",[i]),i.show)return Swal.fire(i.config).then((e=>Fe(t)?t(e.isConfirmed):e))}function De(e,t){var a;let n=r.default.isObject(e)?e:{};return n=r.default.extend(!0,{},ew.sweetAlertSettings,{html:r.default.isString(e)?e:"",showCancelButton:!0,confirmButtonText:ew.language.phrase("OKBtn"),cancelButtonText:ew.language.phrase("CancelBtn")},n),n.input&&(null!=(a=n).inputValidator||(a.inputValidator=e=>{if(!e)return ew.language.phrase("EnterValue")})),Swal.fire(n).then((e=>Fe(t)?t(e.value):e))}function Me(e){e=Object.assign({},ew.toastOptions,e),ve.Toasts("create",e);var t=e.position;return r.default("#toastsContainer"+t[0].toUpperCase()+t.substring(1)).children().first()}function $e(e,t){if(!e)return;let a={message:e,type:t=t||"danger",show:!0};return ve.trigger("toast",[a]),a.show?(({message:e,type:t}=a),Me({class:"ew-toast bg-"+t,title:ew.language.phrase(t),body:e,autohide:"success"==t&&ew.autoHideSuccessMessage,delay:"success"==t?ew.autoHideSuccessMessageDelay:500})):void 0}function Ue(e){if(e instanceof v)return e.$element[0];var t=r.default(e),a=t.closest(".ew-form");return a[0]||(a=t.closest(".ew-grid, .ew-multi-column-grid").find(".ew-form").not(".ew-pager-form")),a[0]}function je(e,t,a,n){var i,l=this.$element?this.$element[0]:this.form?this.form:null;if(l&&((this.htmlForm?this:we.get(l.id))&&(this.form&&r.default.isUndefined(e)?e=we.get(this).getList(this.name||this.id).childFields.slice():r.default.isString(e)&&(e=lt(e,l)),e&&(!Array.isArray(e)||0!=e.length)))){var s=this,o=new h;if(Array.isArray(e)&&r.default.isString(e[0])){for(var d=[],u=0,c=e.length;u<c;u++){var f=e[u].split(" ");if(1==f.length&&s.form){var p=ht(s,!1).match(/^([xy]\d*_)/);p&&(e[u]=e[u].replace(/^([xy]\d*_)/,p[1]))}var g=lt(e[u],l),m=[];if(!Ye(g)&&!We(g))if(d.push(g),2==f.length&&Array.isArray(g)){var w=r.default(g);w.each((function(){if(!m.includes(this.name)){m.push(this.name);var e=w.filter("[name='"+this.name+"']"),i=e.attr("type"),r=["radio","checkbox"].includes(i)?e.get():e[0];o.add(Be.bind(s,r,t,a,n))}}))}else o.add(Be.bind(s,g,t,a,n))}e=d;var v=we.get(s).getList(s.name||s.id);Array.isArray(null==v?void 0:v.autoFillTargetFields)&&v.autoFillTargetFields[0]&&o.add(Ot.bind(null,s))}else{if(Ye(e)||We(e))return;o.add(Be.bind(s,e,t,a,n))}return null==(i=o.send({url:ew.getApiUrl(ew.API_LOOKUP_ACTION)}))?void 0:i.then((function(){ve.trigger("updatedone",[{source:s,target:e}])}))}}function Be(e,t,a,n){var i=ht(e,!1);if(i){var l=Ue(e);if(l&&l.id){var s=we.get(l.id);if(s){var o=this,d=Array.from(arguments),u=ct(e),c=i.match(/^([xy])(\d*)_/),f=c?c[1]:"",p=c?c[2]:"",h=[],g=s.getList(i),m=r.default(e).data("updating",!0);if(!m.data("hidden")){if(r.default.isUndefined(t)&&(t=g.parentFields.slice(),""!=p))for(var w=0,v=t.length;w<v;w++){var b=t[w].split(" ");1==b.length&&(t[w]=t[w].replace(/^x_/,"x"+p+"_"))}if(Array.isArray(t)&&t.length>0)if(Array.isArray(t[0]))h=t;else if(r.default.isString(t[0]))for(w=0,v=t.length;w<v;w++)h.push(ct(t[w],l));ze(e)||pt(e);var y=function(t){var a=ht(e);t.forEach((function(t){let n={data:t,parents:h,valid:!0,name:a,form:l};ve.trigger("addoption",[n]),n.valid&&vt(e,t,l)})),e.list&&e.render(),bt(e,u),!1!==n&&(!e.options&&e.length?m.first().triggerHandler("click"):m.first().trigger("change"))};r.default.isUndefined(a)&&(a=g.ajax);var _=function(){/(s(ea)?rch|summary|crosstab)$/.test(l.id)&&"x"==f&&!p&&(d[0]=i.replace(/^x_/,"y_"),je.apply(o,d))};if(!r.default.isBoolean(a)||Array.isArray(g.lookupOptions)&&g.lookupOptions.length>0){var S=g.lookupOptions;return y(S),_(),S}var E=ht(e),A=Object.assign({page:g.page,field:g.field,ajax:"updateoption",language:ew.LANGUAGE_ID,name:E},Ke("#p_"+i,l));ze(e)&&o.htmlForm?A.v0=u[0]||kt():(e.options&&"SELECTION-LIST"!=e.tagName&&!e.classList.contains("form-select")||qe(e))&&(A.v0=u[0]?e.multiple?u.join(ew.MULTIPLE_OPTION_SEPARATOR):u[0]:kt());w=0;for(var T=h.length;w<T;w++)A["v"+(w+1)]=h[w].join(ew.MULTIPLE_OPTION_SEPARATOR);return r.default.ajax(Ee(ew.API_LOOKUP_ACTION),{method:"POST",dataType:"json",data:A,async:a,processData:!1,success:t=>{var a=t.records||[];return y(a),_(),m.first().trigger("updated",[Object.assign({},t,{target:e})]),a},complete:()=>m.data("updating",!1)})}}}}}function Ke(e,t){e=e.replace(/\[\]$/,"");var a={},n=((t=r.default.isString(t)?/^#/.test(t)?t:"#"+t:t)?r.default(t).find(e):r.default(e)).val();n&&new URLSearchParams(n).forEach((function(e,t){a[t]=e}));return a}function He(e){return e&&["1","y","t","true"].includes(e.toLowerCase())}function Ge(e,t,a,n,i,l){var s=e.currentTarget.form;if(!s)return!1;var o=r.default(s),d=o.attr("target"),u=o.attr("action"),c=i&&s.querySelector("input[type=checkbox][name='key_m[]']");if(c&&!Ze(s))return ke(ew.language.phrase("NoRecordSelected")),!1;if(n)if(r.default("iframe.ew-export").remove(),"email"==a&&l&&(t+="&"+r.default(l).serialize().replace(/&export=email/,"")),c){r.default("<iframe>").attr("name","ew-export-frame").addClass("ew-export d-none").appendTo(be);try{o.append(r.default("<input type='hidden'>").attr({name:"custom",value:"1"})).attr({action:t,target:"ew-export-frame"}).find("input[name=exporttype]").val(a).end().trigger("submit")}finally{o.attr({target:d||"",action:u}).find("input[name=custom]").remove()}}else r.default("<iframe>").attr({name:"ew-export-frame",src:t}).addClass("ew-export d-none").appendTo(be);else o.find("input[name=exporttype]").val(a),["xml","print"].includes(a)?o.trigger("submit"):Ie(u,o.serialize());return!1}function Ve(e){var t=r.default(e);return t.is(":hidden")&&t.data("editor")}function qe(e){var t;return null==e||null==(t=e.dataset)?void 0:t.modalLookup}function We(e){var t;return null==e||null==(t=e.dataset)?void 0:t.filter}function ze(e){var t=r.default(e);return t.is(":hidden")&&t.data("autosuggest")}function Ye(e){var t=r.default(e);return t.is("input[type!=checkbox][type!=radio]")&&!ze(t)}function Je(e,t){if(e){var a=r.default(e);if(!dt(a)){if(Ve(e))return a.data("editor").focus();!e.options&&e.length?e=a[0]:ze(e)&&(e=e.input),e.focus(t)}}}function Xe(e){if(e){var t=r.default(e);if(!dt(t)){!e.options&&e.length&&(e=t[0]);var a=t.closest(ye);ze(e)?a.find(".ew-auto-suggest").removeClass("is-invalid").addClass("is-valid").one("click keydown",(function(){a.find(".is-valid").removeClass("is-valid")})):"checkbox"==e.type||"radio"==e.type?t.removeClass("is-invalid").addClass("is-valid").one("click keydown",(function(){a.find(".is-valid").removeClass("is-valid")})):(t.removeClass("is-invalid").addClass("is-valid").parent().one("click keydown",(function(){a.find(".is-valid").removeClass("is-valid")})),t.closest(".input-group").removeClass("is-invalid").addClass("is-valid"))}}}function Ze(e){return r.default(e).find("input[type=checkbox][name='key_m[]']:checked",e).length>0}function Qe(e){e&&e.form&&r.default(e.form.elements).filter("input[type=checkbox][name^="+e.name+"_], [type=checkbox][name="+e.name+"]").not(e).not(":disabled").prop("checked",e.checked)}function et(e){let t=r.default(e).find("input[type=checkbox][name='key_m[]']:checked").closest("[data-rowindex]").map(((e,t)=>t.dataset.rowindex)).get();r.default(null==e?void 0:e.rows).filter(((e,a)=>a.classList.contains("table-active")&&!t.includes(a.dataset.rowindex))).removeClass("table-active ew-table-selected-row").triggerHandler("change")}function tt(e){var t=r.default(e);if(t.closest(".ew-table")[0]){var a=t.closest(".ew-table > tbody > tr");a.siblings("[data-rowindex='"+a.data("rowindex")+"']").addBack().removeClass("table-active").triggerHandler("change")}}function at(e){var t=r.default(e),a=t.closest(".ew-table")[0];if(a){et(a);var n=t.closest(".ew-table > tbody > tr");n.siblings("[data-rowindex='"+n.data("rowindex")+"']").addBack().addClass("table-active").triggerHandler("change")}}function nt(e,t,a){var n=r.default(t),i=r.default(t.rows);if(t&&t.rows&&(a||!n.data("isset"))&&0!=t.tBodies.length){var l=function(e){var t=r.default(this),a=t.closest(".ew-table")[0],n=r.default(e.target);!a||n.hasClass("btn")||n.hasClass("ew-preview-btn")||n.is(":input")||(et(a),t.siblings("[data-rowindex='"+t.data("rowindex")+"']").addBack().toggleClass("table-active").triggerHandler("change"))},s=i.filter("[data-rowindex=1]").length||i.filter("[data-rowindex=0]").length||1,o=i.filter(":not(.ew-template)").each((function(){r.default(this.cells).removeClass("ew-table-last-row").last().addClass("ew-table-last-col")})).get(),d=n.parentsUntil(".ew-grid","."+ew.RESPONSIVE_TABLE_CLASS)[0];if(o.length)for(var u=1;u<=s;u++){var c=o[o.length-u];r.default(c.cells).each((function(){this.rowSpan==u&&r.default(this).addClass("ew-table-last-row").toggleClass("ew-table-border-bottom",(null==d?void 0:d.clientHeight)>t.offsetHeight)}))}var f=n.closest("form")[0],p=f&&r.default(f.elements).filter("input#action:not([value^=grid])").length>0;r.default(t.tBodies[t.tBodies.length-1].rows).filter(":not(.ew-template):not(.ew-table-preview-row)").each((function(){var e=r.default(this);p&&!e.data("isset")&&e.on("click",l).data("isset",!0)})),it(e,n.closest(".ew-grid")[0],a),n.data("isset",!0)}}function it(e,t,a){var n=r.default(t);!t||!a&&n.data("isset")||(0!=n.find("table.ew-table > tbody").first().children("tr:not(.ew-table-preview-row, .ew-template)").length||n.find(".ew-grid-upper-panel, .ew-grid-lower-panel")[0]||n.hide(),n.find(".ew-grid-middle-panel:visible").hasClass(ew.RESPONSIVE_TABLE_CLASS)&&n.width()>r.default(".content").width()&&(n.addClass("d-flex"),n.closest(".ew-detail-pages").addClass("d-block"),n.closest(".ew-form").addClass("w-100"),ew.USE_OVERLAY_SCROLLBARS&&n.find(".ew-grid-middle-panel:not(.ew-preview-middle-panel)").overlayScrollbars(ew.overlayScrollbarsOptions)),n.data("isset",!0))}function rt(e){return String(e).replace(/&amp;/g,"&").replace(/&quot;/g,'"').replace(/&lt;/g,"<").replace(/&gt;/g,">")}function lt(e,t){var a;if(r.default.isObject(e)&&e.dataset)a="[data-table='"+e.dataset.table+"'][data-field='"+e.dataset.field+"']:not([name^=o]):not([name^='x$'])";else if(r.default.isString(e)){a="[name='"+e+"']";var n=e.split(" ");2==n.length&&(a="[data-table='"+n[0]+"'][data-field='"+ht(n[1])+"']:not([name^=o]):not([name^='x$'])")}a="input"+a+",select"+a+",textarea"+a+",button"+a+",selection-list"+a;var i=(t=r.default.isString(t)?/^#/.test(t)?t:"#"+t:t)?r.default(t).find(a):r.default(a);return 1==i.length&&i.is(":not([type=checkbox]):not([type=radio])")||2==i.length&&i.eq(0).is("selection-list")&&i.eq(1).is("input[type=hidden]")?i[0]:i.get()}function st(e,t){t=r.default.isString(t)?"#"+t:t;var a="#"+e.replace(/([\$\[\]])/g,"\\$1")+",[name='"+e+"']";return t?r.default(t).find(a)[0]:r.default(a).first()[0]}function ot(e,t){for(;e=e.parentNode;){var a;if(1==(null==(a=e)?void 0:a.nodeType)&&(!t||t(e)))return e}return null}function dt(e){var t=r.default(e);return"none"==t.css("display")&&!t.is("selection-list")&&!t.closest(".dropdown-menu")[0]&&!qe(e)&&!ze(e)&&!Ve(e)||null!=ot(e,(e=>"none"==e.style.display&&!e.classList.contains("tab-pane")&&!e.classList.contains("collapse")))}function ut(e,t){return String(e).toLowerCase()==String(t).toLowerCase()}function ct(e,t){var a;r.default.isString(e)?a=2==e.split(" ").length?lt(e):lt(e,t):a="radio"==e.type||"checkbox"==e.type?lt(e):e;if(a.options)return a.list?a.values:Array.prototype.filter.call(a.options,(e=>e.selected&&""!==e.value)).map((e=>e.value));if(r.default.isNumber(a.length))return r.default(a).filter(":checked").map((function(){return this.value})).get();if(ew.isHiddenTextArea(a))return r.default(a).data("editor").save(),[a.value];var n=r.default(a).data();return n.lookup&&n.multiple?a.value.split(ew.MULTIPLE_OPTION_SEPARATOR):[a.value]}function ft(e,t){var a;r.default.isString(e)?a=2==e.split(" ").length?lt(e):lt(e,t):a=e;return ze(a)?[a.input.value]:a.options?Array.prototype.filter.call(a.options,(e=>e.selected&&""!==e.value)).map((e=>e.text)):r.default.isNumber(a.length)?r.default(a).filter(":checked").map((function(){return r.default(this).parent().text()})).get():ew.isHiddenTextArea(a)?(r.default(a).data("editor").save(),[a.value]):[a.value]}function pt(e){if(e.options){var t="select-multiple"==e.type||e.hasAttribute("data-dropdown")||!1===He(e.getAttribute("data-pleaseselect"))||e.length>0&&""!=e.options[0].value?0:1;if(e.list)e.removeAll();else for(var a=e.length-1;a>=t;a--)e.remove(a);ze(e)&&(e.input.value="",e.value="")}}function ht(e,t){var a=r.default.isString(e)?e:r.default(e).attr("name")||r.default(e).attr("id");return!1!==t?a.replace(/\[\]$/,""):a}function gt(e,t){var a=r.default(t).data("value-separator");return Array.isArray(a)?a[e-1]:a||", "}function mt(e,t){for(var a=e.df,n=2;n<=4;n++)if(e["df"+n]&&""!=e["df"+n]){var i=gt(n-1,t);if(r.default.isUndefined(i))break;r.default.isValue(a)&&(a+=i),a+=e["df"+n]}return a}function wt(e){return ew.OPTION_HTML_TEMPLATE.replace(/\{value\}/g,e)}function vt(e,t,a){var n,i=we.get(a.id),r=ht(e),l=i.getList(r),s=t.lf,o={lf:t.lf,df:t.df,df2:t.df2,df3:t.df3,df4:t.df4};n=l.template&&!ze(e)?l.template.render(o,ew.jsRenderHelpers):mt(t,e)||s;var d={data:o,name:r,form:a.$element,value:s,text:n};if(e.options){let t;e.list?t=new y(d.value,d.text):(t=document.createElement("option"),t.value=d.value,t.innerHTML=d.text),d={...d,option:t},ve.trigger("newoption",[d]),e.list?e.add(d.option.value,d.option.text):e.add(d.option)}return d.text}function bt(e,t){if(e&&t){var a=r.default(e);if(Array.isArray(t))if(e.options){var n;if(e.list)e.value=t;else a.val(t),"select-one"!=e.type||-1!=e.selectedIndex||null!=(n=e.options[0])&&n.value||(e.selectedIndex=0);if(ze(e)&&1==t.length){let a=e.options||[];for(let n of a)if(n.value==t[0]){e.value=n.value,e.input.value=n.text;break}}}else e.type&&(e.value=t.join(ew.MULTIPLE_OPTION_SEPARATOR));if(function(e){if(!r.default(e).data("autoselect"))return!1;var t=Ue(e);if(t){if(/s(ea)?rch$/.test(t.id))return!1;var a=we.get(t.id).getList(e.id);return 0!==(null==a?void 0:a.parentFields.length)}return!1}(e)&&e.options&&(e.list||"select-one"!=e.type||2!=e.options.length||e.options[1].selected?1!=e.options.length||e.options[0].selected||(e.options[0].selected=!0,a.trigger("change")):(e.options[1].selected=!0,a.trigger("change")),e.list&&e.render(),ze(e))){let t=e.options||[];1==t.length&&(e.value=t[0].value,e.input.value=t[0].text)}}}function yt(){r.default("form.ew-form.ew-wait").removeClass("ew-wait").each((function(){var e=we.get(this.id);e&&(e.multiPage&&e.multiPage.lastPageSubmit||e.enableForm())})),ve.data("_ajax",!1)}function _t(e,t){let a=e.replace(/<head>[\s\S]*<\/head>/,"").matchAll(/<script([^>]*)>([\s\S]*?)<\/script\s*>/gi);Array.from(document.createRange().createContextualFragment(Array.from(a).map((e=>e[0])).join("")).querySelectorAll("script:not([type]), script[type='text/javascript']")).sort(((e,t)=>t.classList.contains("ew-apply-template")?1:e.classList.contains("ew-apply-template")?-1:0)).forEach(((e,a)=>Et(e,"scr_"+t+"_"+a)))}function St(e){let t=e.matchAll(/<script([^>]*)>([\s\S]*?)<\/script\s*>/gi);return Array.from(t).filter((e=>document.createRange().createContextualFragment(e[0]).querySelector("script:not([type]), script[type='text/javascript']"))).reduce(((e,t)=>e.replace(t[0],"")),e)}function Et(e,t){let a=e instanceof HTMLScriptElement?e:document.createElement("SCRIPT");return r.default.isString(e)&&(a.text=e),t&&(a.id=t),document.body.appendChild(a)}function At(e){e&&r.default("script[id^='scr_"+e+"_']").remove()}function Tt(e){let t=St(e),a=t.match(/<body[\s\S]*>[\s\S]*<\/body>/i);t=a?a[0]:t;let n=r.default(t).find("section.content");return n[0]?n:r.default(t)}function xt(e){return e.options?Array.prototype.map.call(e.options,(e=>[e.value,e.text])):[]}function It(e){var t=r.default(this),a=t.data("args");At("modal_dialog");var n=t.removeData("args").find(".modal-body form").data("form");null==n||n.destroyEditor(),t.find(".modal-footer .btn-primary").off(),t.find(".modal-dialog").removeClass(((e,t)=>{var a=t.match(/table\-\w+/);return a?a[0]:""})),t.data({showing:!1,url:null}),null!=a&&a.reload&&window.location.reload()}function Ot(e){var t=we.get(e).$element[0];if(t){var a=ct(e),n=ht(e),i=n.match(/^([xy])(\d*)_/),l=i?i[2]:"",s=we.get(e).getList(n),o=s.autoFillTargetFields,d=function(a){let i=null==a?void 0:a.records,s=Array.isArray(i)&&i.length>0?i[0]:[];for(let a=0;a<o.length;a++){let d=lt(o[a].replace(/^x_/,"x"+l+"_"),t);if(d){let l=r.default.isValue(s["af"+a])?String(s["af"+a]):"",u={results:i,result:s,data:l,form:t,name:n,target:o[a],cancel:!1,trigger:!0};if(r.default(e).trigger("autofill",[u]),u.cancel)continue;l=u.data,d.options?(bt(d,l.split(",")),ze(d)&&(d.input.value=l,je.call(we.get(t.id),d))):Ve(d)?(d.value=l,r.default(d).data("editor").set()):"checkbox"==d.type?d.checked=He(l):d.value=l,u.trigger&&r.default(d).trigger("change")}}return s};if(a.length>0&&""!=a[0]){var u=Object.assign({page:s.page,field:s.field,ajax:"autofill",v0:a[0],language:ew.LANGUAGE_ID},Ke("#p_"+n,t)),c=s.parentFields.slice();if(""!=l)for(var f=0,p=c.length;f<p;f++){1==(a=c[f].split(" ")).length&&(c[f]=c[f].replace(/^x_/,"x"+l+"_"))}for(var h=c.map((function(e){return ct(e,t)})),g=(f=0,h.length);f<g;f++)u["v"+(f+1)]=h[f].join(ew.MULTIPLE_OPTION_SEPARATOR);return r.default.post(Ee(ew.API_LOOKUP_ACTION),u,d,"json")}return d()}}function Ct(e,t){var a=r.default(t),n=r.default("#"+a.data("tooltip-id")),i=a.data("trigger")||"hover",l=a.data("placement")||"auto";n[0]&&(""!=n.text().trim()||n.find("img[src!='']")[0])&&(bootstrap.Popover.getInstance(t)||a.popover({html:!0,placement:l,trigger:i,delay:100,container:document.getElementById("ew-tooltip"),content:n.html(),sanitizeFn:ew.sanitizeFn}).on("show.bs.popover",(function(e){var n=a.data("tooltip-width");n&&r.default(bootstrap.Popover.getInstance(t).getTipElement()).css("max-width",parseInt(n,10)+"px")})))}function Nt(){return location.href.split("#")[0].split("?")[0]}function Pt(e){var t,a;const n=(null==(t=e=r.default.isString(e)?document.querySelector(e):e)?void 0:t.value)||(null==(a=e)?void 0:a.innerText);if(n){const e=document.createElement("textarea");e.value=n,e.setAttribute("readonly",""),e.style.position="absolute",e.style.left="-9999px",document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e)}return n}function Rt(e){return!(e=String(e))||0==e.length||(e=e.trim(),null!==ew.parseNumber(e))}function Lt(e){return!e||0==e.length||/^[\w.%+-]+@[\w.-]+\.[A-Z]{2,18}$/i.test(e.trim())}function Ft(e){var t;let a,n;try{let e=window.parent;a=e.document,n=e.Swal}catch(e){a=window.document,n=window.Swal}let i=null!=(t=null==e?void 0:e.target)?t:a,l=r.default(i).find("div.ew-message-dialog:hidden").first(),s=l.length?l.text():"";if(r.default.isString(e)&&(s=r.default("<div>"+e.trim()+"</div>").text()),""!=s.trim())return l.length&&["success","info","warning","danger"].forEach((function(e,t){let a=l.find(".alert-"+e).toggleClass("alert-"+e),n=a.find(".alert-heading").detach(),i=a.children(":not(.icon)");if(a.find(".icon").remove(),a[0]){let t=parseInt(i.css("width"),10);t>0&&i.first().css("width","auto");let r=Me({class:"ew-toast bg-"+e,title:n[0]?n.html():ew.language.phrase(e),body:a.html(),autohide:"success"==e&&ew.autoHideSuccessMessage,delay:"success"==e?ew.autoHideSuccessMessageDelay:500});t>0&&r.css("max-width",t)}else;})),r.default.isString(e)?n.fire({...ew.sweetAlertSettings,html:e}):void 0}function kt(){return Math.floor(100001*Math.random())+1e5}Pace.on("done",(()=>{var e;let t=document.querySelector(".modal.show form.ew-form")||document.querySelector("form.ew-form");t&&(null==(e=we.get(t.id))||e.tryFocus())})),ve.ajaxSend((function(e,t,a){var n=a.url,i=Ee(),r=n.startsWith(i),l=r||n.startsWith(ew.PATH_BASE)||n.startsWith(Nt());!l&&n.match(/^http/i)&&(l=new URL(n).hostname==me.hostname);if(l)if(r&&ew.API_JWT_TOKEN&&!ew.IS_WINDOWS_AUTHENTICATION&&t.setRequestHeader(ew.API_JWT_AUTHORIZATION_HEADER,"Bearer "+ew.API_JWT_TOKEN),"GET"==a.type||"application/json"==a.contentType){var s=a.url.split("?");(o=new URLSearchParams(s[1])).set(ew.TOKEN_NAME_KEY,ew.TOKEN_NAME),o.set(ew.ANTIFORGERY_TOKEN_KEY,ew.ANTIFORGERY_TOKEN),s[1]=o.toString(),a.url=s[0]+(s[1]?"?"+s[1]:"")}else{var o;if(a.data instanceof FormData)a.data.set(ew.TOKEN_NAME_KEY,ew.TOKEN_NAME),a.data.set(ew.ANTIFORGERY_TOKEN_KEY,ew.ANTIFORGERY_TOKEN);else(o=new URLSearchParams(a.data)).set(ew.TOKEN_NAME_KEY,ew.TOKEN_NAME),o.set(ew.ANTIFORGERY_TOKEN_KEY,ew.ANTIFORGERY_TOKEN),a.data=o.toString()}})),ve.ajaxStart((function(){ve.data("_ajax",!0),r.default("form.ew-form").addClass("ew-wait").each((function(){var e=we.get(this.id);e&&(e.multiPage&&e.multiPage.lastPageSubmit||e.disableForm())}))})),ve.ajaxStop(yt).ajaxError(yt);let Dt=l.default.DateTime;function Mt(e,t){return Dt.fromFormat(e,t,{locale:ew.LANGUAGE_ID,numberingSystem:ew.getNumberingSystem()})}function $t(e,t,a){var n;let i;if((null!=(n=ew.vars)&&n.login?Array.from(Object.entries(ew.vars.login)).filter((e=>e[0].endsWith("Url"))).map((e=>e[1])):[]).includes(e))return window.location=e,!1;if(e.startsWith("http"))i=new URL(e);else{if(!e.startsWith("/"))return ke(ew.language.phrase("IncorrectUrl")),!1;i=new URL(e,location.protocol+"//"+location.host)}let l=i.searchParams;if(l.set(ew.TOKEN_NAME_KEY,ew.TOKEN_NAME),l.set(ew.ANTIFORGERY_TOKEN_KEY,ew.ANTIFORGERY_TOKEN),ut(a,"post")){let a=t?r.default(t):r.default("<form></form>").appendTo("body");a.attr({action:e.split("?")[0],method:"post"}),l.forEach((function(e,t){r.default('<input type="hidden">').attr({name:t,value:ew.sanitize(e)}).appendTo(a)})),a.trigger("submit")}else window.location=Ae(i.toString());return!1}var Ut;var jt={__proto__:null,currentUrl:me,forms:we,AjaxLookup:b,AutoSuggest:_,Form:v,SelectionListOption:y,Select2Utils:J,Select2Defaults:ge,fieldContainerSelector:ye,createSelect:function(e){if(e.selectId.includes("$rowindex$"))return;if(r.default.isObject(e.data)){let t=new ew.AjaxLookup(e.data);e.data=t.options.map((e=>({id:e.lf,text:t.formatResult({lf:e.lf,df:e.df,df2:e.df2,df3:e.df3,df4:e.df4})})))}if(r.default.isObject(e.ajax)){let t=e.ajax.limit,a=new ew.AjaxLookup({...e.ajax,action:"modal"});e.ajax={url:e=>{let n=e.page?(e.page-1)*t:-1;return a.getUrl(e.term,n)},type:"POST",dataType:"json",data:a.generateRequest.bind(a),delay:e.debounce,processResults:function(e){var t,n;return{results:a.transform(e).map((e=>({id:e.lf,text:a.formatResult({lf:e.lf,df:e.df,df2:e.df2,df3:e.df3,df4:e.df4})}))),pagination:{more:this.container.$results.find(".select2-results__option:not(.select2-results__option--load-more)").length+(null!=(t=null==(n=e.records)?void 0:n.length)?t:0)<a.recordCount}}}}}let t={name:e.name,options:e};ve.trigger("select2",[t]);let a=r.default("select[data-select2-id='"+e.selectId+"']").select2(t.options);a.on("select2:open",(function(){var e;null==(e=r.default(this).data("select2").$dropdown.find(".select2-search__field")[0])||e.focus()})),r.default.isObject(e.ajax)&&a.on("select2:opening",(function(){r.default(this).data("select2").$results.find(".select2-results__option:not(.loading-results)").remove()})),e.minimumResultsForSearch===1/0&&a.on("select2:opening select2:closing",(function(){r.default(this).data("select2").$dropdown.find(".select2-search--dropdown").addClass("select2-search--hide")}))},createModalLookup:function(e){if(e.selectId.includes("$rowindex$"))return;if(r.default.isObject(e.data)){let t=new ew.AjaxLookup(e.data);e.data=t.options.map((e=>({id:e.lf,text:t.formatResult({lf:e.lf,df:e.df,df2:e.df2,df3:e.df3,df4:e.df4})})))}if(r.default.isObject(e.ajax)){let t=e.ajax.limit,a=new ew.AjaxLookup({...e.ajax,action:"modal"});e.ajax={url:e=>{let n=e.page?(e.page-1)*t:-1;return a.getUrl(e.term,n)},type:"POST",dataType:"json",data:a.generateRequest.bind(a),delay:e.debounce,processResults:function(e){var t,n;return{results:a.transform(e).map((e=>({id:e.lf,text:a.formatResult({lf:e.lf,df:e.df,df2:e.df2,df3:e.df3,df4:e.df4})}))),pagination:{more:this.container.$results.find(".select2-results__option:not(.select2-results__option--load-more)").length+(null!=(t=null==(n=e.records)?void 0:n.length)?t:0)<a.recordCount}}}}}let t=r.default("select[data-select2-id='"+e.selectId+"']").select2(e);t.on("select2:open",(function(){var e;null==(e=r.default(this).data("select2").$dropdown.find(".select2-search__field").addClass("form-control")[0])||e.focus()})),r.default.isObject(e.ajax)&&t.on("select2:opening",(function(){r.default(this).data("select2").$results.find(".select2-results__option:not(.loading-results)").remove()}))},createFilter:function(e){if(e.selectId.includes("$rowindex$"))return;if(r.default.isObject(e.data)){let t=new ew.AjaxLookup(e.data);e.data=t.options.map((e=>({id:e.lf,text:t.formatResult({lf:e.lf,df:e.df,df2:e.df2,df3:e.df3,df4:e.df4})})))}if(r.default.isObject(e.ajax)){let t=e.ajax.limit,a=new ew.AjaxLookup({...e.ajax,action:"modal"});e.ajax={url:e=>{let n=e.page?(e.page-1)*t:-1;return a.getUrl(e.term,n)},type:"POST",dataType:"json",data:a.generateRequest.bind(a),delay:e.debounce,processResults:function(e){var t,n;return{results:a.transform(e).map((e=>({id:e.lf,text:a.formatResult({lf:e.lf,df:e.df,df2:e.df2,df3:e.df3,df4:e.df4})}))),pagination:{more:this.container.$results.find(".select2-results__option:not(.select2-results__option--load-more)").length+(null!=(t=null==(n=e.records)?void 0:n.length)?t:0)<a.recordCount}}}}}let t=r.default("select[data-select2-id='"+e.selectId+"']").select2(e);t.on("select2:open",(function(){var t;null==(t=r.default(this).data("select2").$dropdown.find(".select2-search__field").addClass("form-control")[0])||t.focus({preventScroll:e.preventScroll})})),r.default.isObject(e.ajax)&&t.on("select2:opening",(function(){r.default(this).data("select2").$results.find(".select2-results__option:not(.loading-results)").remove()}))},initIcons:_e,initPasswordOptions:Se,getApiUrl:Ee,sanitizeUrl:Ae,setSessionTimer:function(){var e,t,a,n,i=ew.SESSION_KEEP_ALIVE_INTERVAL>0||ew.IS_LOGGEDIN&&ew.IS_AUTOLOGIN,l=()=>{r.default.get(Ee(ew.API_SESSION_ACTION),{rnd:kt()},(e=>{e&&r.default.isObject(e)&&(ew.TOKEN_NAME=e[ew.TOKEN_NAME_KEY],ew.ANTIFORGERY_TOKEN=e[ew.ANTIFORGERY_TOKEN_KEY],e.JWT&&(ew.API_JWT_TOKEN=e.JWT))}))},s=()=>{n=ew.SESSION_TIMEOUT_COUNTDOWN,(e=ew.SESSION_TIMEOUT-ew.SESSION_TIMEOUT_COUNTDOWN)<0&&(e=0,n=ew.SESSION_TIMEOUT),t&&t.cancel()},o=()=>{if(a&&a.cancel(),n>0){let e,t='<p class="text-danger">'+ew.language.phrase("SessionWillExpire")+"</p>";t.includes("%m")&&t.includes("%s")?(t=t.replace("%m",'<span class="ew-session-counter-minute">'+Math.floor(n/60)+"</span>"),t=t.replace("%s",'<span class="ew-session-counter-second">'+n%60+"</span>")):t.includes("%s")&&(t=t.replace("%s",'<span class="ew-session-counter-second">'+n+"</span>")),Swal.fire({...ew.sweetAlertSettings,html:t,showConfirmButton:!0,confirmButtonText:ew.language.phrase("OKBtn"),timer:1e3*n,timerProgressBar:!0,allowOutsideClick:!1,allowEscapeKey:!1,willOpen:()=>{e=setInterval((()=>{let e=Swal.getHtmlContainer(),t=e.querySelector(".ew-session-counter-minute"),a=e.querySelector(".ew-session-counter-second"),n=Math.round(Swal.getTimerLeft()/1e3);t&&a?(t.textContent=Math.floor(n/60),a.textContent=n%60):a&&(a.textContent=n)}),1e3)},willClose:()=>{clearInterval(e)}}).then((e=>{e.value?(l(),!i&&ew.SESSION_TIMEOUT>0&&d()):e.dismiss===Swal.DismissReason.timer&&(s(),window.location=Ae(ew.TIMEOUT_URL+"?expired=1"))}))}},d=()=>{s(),t=r.default.later(1e3*e,null,o)};if(i){var u=ew.SESSION_KEEP_ALIVE_INTERVAL>0?ew.SESSION_KEEP_ALIVE_INTERVAL:ew.SESSION_TIMEOUT-ew.SESSION_TIMEOUT_COUNTDOWN;u<=0&&(u=60),a=r.default.later(1e3*u,null,l,null,!0)}else ew.SESSION_TIMEOUT>0&&d()},initExportLinks:Te,initMultiSelectCheckboxes:xe,fileDownload:Ie,lazyLoad:Oe,updateDropdownPosition:function(){var e=r.default(".select2-container--open").prev(".ew-select").data("select2");e&&(e.dropdown._positionDropdown(),e.dropdown._resizeDropdown())},initLightboxes:Ce,initPdfObjects:Ne,initTooltips:Pe,parseJson:Re,searchOperatorChanged:function(e){var t=r.default(e).closest("[id^=r_], [id^=xs_]"),a=e.id.substr(2),n=t.find(".ew-search-field"),i=t.find(".ew-search-field2"),l=i.find("[name='y_"+a+"'], [name='y_"+a+"[]']").length,s=t.find(".ew-search-cond"),o=s.length,d=t.find(".ew-search-and"),u=t.find(".ew-search-operator").find("[name='z_"+a+"']").val(),c=t.find(".ew-search-operator2"),f=c.find("[name='w_"+a+"']").val(),p="BETWEEN"==u,h=["IS NULL","IS NOT NULL"].includes(u),g=["IS NULL","IS NOT NULL"].includes(f),m=!l||p,w=h,v=!p&&(!o||g);s.toggleClass("d-none",m).find(":input").prop("disabled",m),d.toggleClass("d-none",!p),c.toggleClass("d-none",m).find(":input").prop("disabled",m),n.toggleClass("d-none",w).find(":input").prop("disabled",w),i.toggleClass("d-none",v).find(":input").prop("disabled",v)},initForms:Le,isFunction:Fe,alert:ke,prompt:De,toast:Me,showToast:$e,getForm:Ue,hasFormData:function(e){for(var t=r.default(e).find("[name^=x_],[name^=y_],[name^=z_],[name^=w_],[name=psearch]").filter(":enabled").get(),a=0,n=t.length;a<n;a++){var i=t[a];if(/^(z|w)_/.test(i.name)){if(/^IS/.test(r.default(i).val()))return!0}else if("checkbox"==i.type||"radio"==i.type){if(i.checked)return!0}else if("select-one"==i.type||"select-multiple"==i.type){if(r.default(i).val())return!0}else if(["text","textarea","password","search","color","date","datetime-local","datetime","email","hidden","month","number","range","tel","time","url","week"].includes(i.type)&&i.value)return!0}return!1},setSearchType:function(e){var t=e.dataset.searchType,a="Auto";"="==t?a="Exact":"AND"==t?a="All":"OR"==t&&(a="Any"),e.closest(".ew-basic-search").querySelector("input.ew-basic-search-type").value=t||"",e.closest(".dropdown-menu").querySelectorAll(".dropdown-item").forEach((e=>e.classList.remove("active"))),e.closest(".dropdown-item").classList.add("active");var n=e.closest(".input-group").querySelector("#searchtype"),i=ew.language.phrase("QuickSearch"+a+"Short");return n.innerHTML=i,n.classList.toggle("me-2",!!i),!1},updateOptions:je,getUserParams:Ke,applyTemplate:function(e,t,a,n,i){let l={data:i||{},id:e,template:t,class:a,export:n,enabled:!0};if(ve.trigger("rendertemplate",[l]),l.enabled){var s;let a=null==(s=document.getElementById(t))?void 0:s.content,n=document.querySelector("#ew-modal-dialog.show");if(!a)return;if(a.querySelectorAll(".ew-slot").forEach((e=>{var t;let a=e.name||e.id,i=null!=(t=null==n?void 0:n.querySelector("#"+a))?t:document.getElementById(a);null!=i&&i.content?(e.dataset.rowspan>1&&Array.prototype.slice.call(i.content.childNodes).forEach((t=>t.rowSpan=e.dataset.rowspan)),e.replaceWith(i.content.cloneNode(!0))):e.remove()})),r.default.views){let t=a.textContent,n=t.includes("{{")&&t.includes("}}");if(!n){let e=ew.jsRenderAttributes.map((e=>"["+e+"*='{{']["+e+"*='}}']")).join(",");n=a.querySelector(e)}if(n){let t=Array.prototype.slice.call(a.querySelectorAll("script"));t.forEach((e=>e.remove()));let n=document.createElement("div");n.appendChild(a);let i=n.innerHTML.replace(/{{([^}]+)}}/g,(e=>rt(e))),s=r.default.templates(i);document.getElementById(e).innerHTML=s.render(l.data,ew.jsRenderHelpers),t.forEach((e=>document.body.appendChild(e)))}else document.getElementById(e).appendChild(a)}else document.getElementById(e).appendChild(a)}n&&"print"!=n&&r.default((function(){let t=r.default("meta[http-equiv='Content-Type']"),a="<html><head>",i=r.default("#"+e);i.children(0).is("div[id^=ct_]")&&(i=i.children(0)),t[0]&&(a+="<meta http-equiv='Content-Type' content='"+t.attr("content")+"'>"),a+="pdf"==n?"<link rel='stylesheet' href='"+ew.PDF_STYLESHEET_FILENAME+"'>":"<style>"+r.default.ajax({async:!1,type:"GET",url:ew.PROJECT_STYLESHEET_FILENAME}).responseText+"</style>",a+="</head><body>",r.default(".ew-chart-top").each((function(){a+=r.default(this).html()})),a+=i.html(),r.default(".ew-chart-bottom").each((function(){a+=r.default(this).html()})),a+="</body></html>";let s=Nt(),o={customexport:n,data:a,filename:l.class};if(o[ew.TOKEN_NAME]=ew.ANTIFORGERY_TOKEN,"email"==n){let e=me.searchParams.toString()+"&"+r.default.param(o);r.default.post(s,e,(function(e){Ft(e)}))}else Ie(s,o);window.parent.jQuery("body").css("cursor","default")}))},toggleGroup:function(e){for(var t,a=r.default(e),n=a.closest("tr"),i="tr",l=1;l<=6;l++){var s=1==l?"":"-"+l,o=n.data("group"+s);r.default.isValue(o)&&(t=l,""!=o&&(i+="[data-group"+s+"='"+String(o).replace(/'/g,"\\'")+"']"))}a.hasClass("ew-rpt-grp-hide")?(r.default(i).slice(1).removeClass("ew-rpt-grp-hide-"+t),a.removeClass("ew-rpt-grp-hide")):(r.default(i).slice(1).addClass("ew-rpt-grp-hide-"+t),a.addClass("ew-rpt-grp-hide"))},convertToBool:He,valueChanged:function(e,t,a,n){var i=lt("x"+t+"_"+a,e),r=st("o"+t+"_"+a,e),l=st("fn_x"+t+"_"+a,e);if("hidden"==(null==i?void 0:i.type)&&!r)return!1;if(!r&&(!i||Array.isArray(i)&&0==i.length))return!1;var s=e=>ct(e).join();if(r&&i)if(n){if(He(s(r))===He(s(i)))return!1}else if(s(r)==s(l||i))return!1;return!0},setLanguage:function(e){var t=r.default(e),a=t.val()||t.data("language");return!!a&&(me.searchParams.set("language",a),window.location=Ae(me.toString()),!1)},submitAction:function(e,t){var a,n=e.currentTarget,i=t.f||n.form||n.closest("form"),l=r.default(i),s=t.key,o=t.action,d=t.url||Nt(),u=t.msg,c=t.data,f=t.success,p=!t.method||ut(t.method[0],"p"),h=!t.select&&!t.key||t.select&&ut(t.select[0],"m");if((h||p)&&!i)return ke(ew.language.phrase("NoHtmlForm")),!1;if(h&&!Ze(i))return ke(ew.language.phrase("NoRecordSelected")),!1;var g=function(e){Ft(e)},m=function(e){if(p&&i){if(o&&r.default("<input>").attr({type:"hidden",name:"useraction",value:o}).appendTo(l),r.default.isUndefined(e)||r.default("<input>").attr({type:"hidden",name:"actionvalue",value:e}).appendTo(l),r.default.isObject(c))for(var t in c){var a=l.find("input[type=hidden][name='"+t+"']");a[0]?a.val(c[t]):r.default("<input>").attr({type:"hidden",name:t,value:c[t]}).appendTo(l)}if(!h&&r.default.isObject(s))for(var t in s)r.default("<input>").attr({type:"hidden",name:t,value:s[t]}).appendTo(l);l.prop({action:d,method:"post"}).trigger("submit")}else c=r.default.isObject(c)?r.default.param(c):r.default.isString(c)?c:"",o&&(c+="&useraction="+o+"&ajax="+o),r.default.isUndefined(e)||(c+="&actionvalue="+encodeURIComponent(e)),h?c+="&"+l.find("input[name='key_m[]']:checked").serialize():s&&(c+="&"+(r.default.isObject(s)?r.default.param(s):s)),f&&r.default.isString(f)&&(f=window[f]),Fe(f)?r.default.post(d,c,f):r.default.isObject(f)?(f.data=c,f.method=f.method||"POST",f.success=f.success||g,r.default.ajax(d,f)):r.default.post(d,c,g)};return(u=r.default.isString(u)&&null!=(a=window[u])?a:u)?De(u,(e=>{e&&m(e)})):m(),!1},export:Ge,removeSpaces:function(e){return/^(<(p|br)\/?>(&nbsp;)?(<\/p>)?)?$/i.test(e.replace(/\s/g,""))?"":e},isHiddenTextArea:Ve,isModalLookup:qe,isFilter:We,isAutoSuggest:ze,isTextbox:Ye,clearError:function(e){if(e.jquery){let t=e.attr("type");e="checkbox"==t||"radio"==t?e.get():e[0]}r.default(e).closest(ye).find(".invalid-feedback").html("")},onError:function(e,t,a,n){if(t.jquery){let e=t.attr("type");t="checkbox"==e||"radio"==e?t.get():t[0]}else t instanceof w&&(t=t.element);return r.default(t).closest(ye).find(".invalid-feedback").append("<p>"+a+"</p>"),n&&Je(t),null==e||e.makeVisible(t),!1},setFocus:Je,setInvalid:function(e){if(!e)return;let t=r.default(e);if(dt(t))return;!e.options&&e.length&&(e=t[0]);let a=t.closest(ye),n=()=>a.find(".is-invalid").removeClass("is-invalid");ze(e)?a.find(".ew-auto-suggest").removeClass("is-valid").addClass("is-invalid").one("click keydown",n):Ve(e)?(t.removeClass("is-valid").addClass("is-invalid"),t.data("editor").instance.once("change",n)):qe(e)?t.removeClass("is-valid").addClass("is-invalid").one("select2:open",n):"checkbox"==e.type||"radio"==e.type?t.removeClass("is-valid").addClass("is-invalid").one("click keydown",n):(t.removeClass("is-valid").addClass("is-invalid").parent().one("click keydown change",n),t.closest(".input-group").removeClass("is-valid").addClass("is-invalid"))},setValid:Xe,hasValue:function(e){return""!=ct(e).join("")},isMaskedPassword:function(e){var t=r.default(e).val();return null==t?void 0:t.match(/^\*+$/)},sort:function(e,t,a){return e.shiftKey&&!e.ctrlKey?t=t.split("?")[0]+"?cmd=resetsort":2==a&&e.ctrlKey&&(t+="&ctrl=1"),window.location=Ae(t),!0},filter:function(e){let t=e.currentTarget.dataset;r.default("select[data-select2-id='f"+t.table+"srch_"+t.field+"']").select2("open")},confirmDelete:function(e){return at(e),De(ew.language.phrase("DeleteConfirmMsg"),(t=>{t&&e.href?window.location=Ae(e.href):tt(e)})),!1},keySelected:Ze,selectAllKeys:function(e){Qe(e);var t=r.default(e).closest(".ew-table")[0];t&&r.default(t.tBodies).each((function(){r.default(this.rows).each((function(t,a){var n=r.default(a);n.is(":not(.ew-template):not(.ew-table-preview-row)")&&n.toggleClass("table-active ew-table-selected-row",e.checked).triggerHandler("change")}))}))},selectAll:Qe,updateSelected:function(e){return r.default(e).find("input[type=checkbox][name^=u_]:checked,input:hidden[name^=u_][value=1]").length>0},clearSelected:et,clearDelete:tt,clickDelete:at,selectKey:function(e){var t=e.target,a=r.default(t),n=a.closest(".ew-table")[0];if(n){et(n);var i=a.closest(".ew-table > tbody > tr");i.siblings("[data-rowindex='"+i.data("rowindex")+"']").addBack().each((function(e,a){r.default(a).toggleClass("table-active ew-table-selected-row",t.checked).triggerHandler("change")})),e.stopPropagation()}},setupTable:nt,setupGrid:it,addGridRow:function(e){var t,a=r.default(e).closest(".ew-grid"),n=a.find("table.ew-table").last(),i=n.parent("div"),l=n.find("tr.ew-template");if(!(e&&a[0]&&n[0]&&l[0]))return!1;var s=r.default(n[0].rows).last();n.find("td.ew-table-last-row").removeClass("ew-table-last-row");var o=l.clone(!0,!0).removeClass("ew-template"),d=a.find("div.ew-form[id^=f][id$=grid]");d[0]||(d=a.find("form.ew-form[id^=f][id$=list]"));var u=d.is("div")?"_"+d.attr("id"):"",c=d.find("#key_count"+u),f=parseInt(c.val(),10)+1;o.attr({id:"r"+f+o.attr("id").substring(2),"data-rowindex":f});var p=l.find("script:contains('$rowindex$')");o.children("td").each((function(){r.default(this).find("*").each((function(){r.default.each(this.attributes,(function(e,t){t.value=t.value.replace(/\$rowindex\$/g,f)}))}))}));var h=o.find(".ew-icon").closest("a, button");null==(t=bootstrap.Tooltip.getInstance(h[0]))||t.dispose(),h.tooltip({container:"body",placement:"bottom",trigger:"hover",sanitizeFn:ew.sanitizeFn}),c.val(f).after(r.default("<input>").attr({type:"hidden",id:"k"+f+"_action"+u,name:"k"+f+"_action"+u,value:"insert"})),s.after(o),p.each((function(){Et(this.text.replace(/\$rowindex\$/g,f))}));var g=d.data("form");return null==g||g.initEditors(),null==g||g.initUpload(),nt(-1,n[0],!0),i.scrollTop(i[0].scrollHeight),!1},deleteGridRow:function(e,t){var a;null==(a=bootstrap.Tooltip.getInstance(e))||a.dispose();var n=r.default(e),i=n.closest(".ew-grid, .ew-multi-column-grid"),l=n.closest("tr, div[data-rowindex]"),s=l.closest(".ew-table");if(!e||!i[0]||!l[0])return!1;var o=parseInt(l.data("rowindex"),10),d=i.find("div.ew-form[id^=f][id$=grid]");d[0]||(d=i.find("form.ew-form[id^=f][id$=list]"));var u=d.data("form");if(!d[0]||!u)return!1;var c=d.is("div")?"_"+d.attr("id"):"",f="#key_count"+c,p=function(){if(l.remove(),i.is(".ew-grid")&&nt(-1,s[0],!0),o>0){var e=d.find("#k"+o+"_action"+c);e[0]?e.val("insert"==e.val()?"insertdelete":"delete"):d.find(f).after(r.default("<input>").attr({type:"hidden",id:"k"+o+"_action"+c,name:"k"+o+"_action"+c,value:"delete"}))}};return Fe(u.emptyRow)&&u.emptyRow(t)?p():De(ew.language.phrase("DeleteConfirmMsg"),(e=>{e&&p()})),!1},htmlEncode:function(e){return String(e).replace(/&/g,"&amp;").replace(/\"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},htmlDecode:rt,getElements:lt,getElement:st,getAncestorBy:ot,isHidden:dt,sameText:ut,sameString:function(e,t){return String(e)==String(t)},getValue:function(e,t){if(!e)return"";let a;if(r.default.isString(e)){a=2==e.split(" ").length?lt(e):lt(e,t)}else a="radio"==e.type||"checkbox"==e.type?lt(e):e;if(a.options){if(a.list){let e=a.values;return a.multiple?e:e[0]||""}{let e=Array.prototype.filter.call(a.options,(e=>e.selected&&""!==e.value)).map((e=>e.value));return"select-multiple"==a.type?e:e[0]||""}}if(r.default.isNumber(a.length)){let e=r.default(a).filter(":checked").map((function(){return this.value})).get();return 1==a.length?e[0]:e}if(ew.isHiddenTextArea(a))return r.default(a).data("editor").save(),a.value;{let e=r.default(a).data();return e.lookup&&e.multiple?a.value.split(ew.MULTIPLE_OPTION_SEPARATOR):a.value}},getOptionValues:ct,getOptionTexts:ft,clearOptions:pt,getId:ht,valueSeparator:gt,displayValue:mt,optionHtml:wt,optionsHtml:function(e,t){if(e.length>(t||ew.MAX_OPTION_COUNT))return ew.language.phrase("CountSelected").replace("%s",e.length);if(e.length){for(var a="",n=0;n<e.length;n++)a+=wt(e[n]);return a}return ew.language.phrase("PleaseSelect")},newOption:vt,selectOption:bt,fetch:function(e,t){null!=t||(t={});let a=Ee();if(e.startsWith(a)&&ew.API_JWT_TOKEN&&!ew.IS_WINDOWS_AUTHENTICATION&&(t.headers=new Headers(t.headers||{}),t.headers.set(ew.API_JWT_AUTHORIZATION_HEADER,"Bearer "+ew.API_JWT_TOKEN)),t.method&&"GET"!=t.method)return t.body instanceof FormData?(t.body.set(ew.TOKEN_NAME_KEY,ew.TOKEN_NAME),t.body.set(ew.ANTIFORGERY_TOKEN_KEY,ew.ANTIFORGERY_TOKEN)):(r.default.isString(t.body)||r.default.isObject(t.body)||Array.isArray(t.body)&&t.body.every((e=>Array.isArray(e)&&2==e.length)))&&(t.body=new URLSearchParams(t.body),t.body.set(ew.TOKEN_NAME_KEY,ew.TOKEN_NAME),t.body.set(ew.ANTIFORGERY_TOKEN_KEY,ew.ANTIFORGERY_TOKEN)),fetch(e,t);{let a=e.split("?"),n=new URLSearchParams(a[1]);if(n.set(ew.TOKEN_NAME_KEY,ew.TOKEN_NAME),n.set(ew.ANTIFORGERY_TOKEN_KEY,ew.ANTIFORGERY_TOKEN),t.body instanceof FormData||r.default.isString(t.body)||r.default.isObject(t.body)||Array.isArray(t.body)&&t.body.every((e=>Array.isArray(e)&&2==e.length))){new URLSearchParams(t.body).forEach(((e,t)=>n.set(t,e)))}return a[1]=n.toString(),e=a[0]+(a[1]?"?"+a[1]:""),fetch(e)}},executeScript:_t,stripScript:St,addScript:Et,removeScript:At,getContent:Tt,getOptions:xt,enable2FA:function(){let e=ew.getApiUrl([ew.API_2FA_ACTION,ew.API_2FA_SHOW]);return be.css("cursor","wait"),r.default.get(e,(e=>{var t;null!=e&&e.url?De({imageUrl:e.url,html:ew.language.phrase("Scan2FAQrCode"),input:"text",confirmButtonText:ew.language.phrase("Verify"),showLoaderOnConfirm:!0,allowEscapeKey:!1,allowOutsideClick:()=>!Swal.isLoading(),willOpen:()=>{Swal.showLoading(Swal.getConfirmButton()),Swal.disableInput(),Swal.getImage().onload=()=>{Swal.enableInput(),Swal.hideLoading(),Swal.getInput().focus()}},preConfirm:e=>r.default.get(ew.getApiUrl([ew.API_2FA_ACTION,ew.API_2FA_VERIFY,e])).then((e=>(!0!==(null==e?void 0:e.success)&&Swal.showValidationMessage(ew.language.phrase("2FAVerificationFailed")),e))).catch((e=>Swal.showValidationMessage(e)))},(e=>{var t;null!=e&&null!=(t=e.error)&&t.description?$e(e.error.description):null!=e&&e.success&&($e(ew.language.phrase("2FAEnabled"),"success"),r.default("#enable-2fa").addClass("d-none"),r.default("#disable-2fa, #backup-codes").removeClass("d-none"))})).catch((e=>$e(null==e?void 0:e.message))):null!=e&&null!=(t=e.error)&&t.description&&ke(e.error.description)})).fail(((e,t,a)=>$e(a))).always((()=>be.css("cursor","default"))),!1},disable2FA:function(){De({html:ew.language.phrase("Disable2FAMsg"),preConfirm:e=>{if(e)return r.default.get(ew.getApiUrl([ew.API_2FA_ACTION,ew.API_2FA_RESET])).then((e=>{var t;return null!=e&&null!=(t=e.error)&&t.description?$e(e.error.description):!0!==(null==e?void 0:e.success)&&$e(ew.language.phrase("2FAResetFailed")),e})).fail(((e,t,a)=>$e(a)))}},(e=>{var t;null!=e&&null!=(t=e.error)&&t.description?$e(e.error.description):null!=e&&e.success&&($e(ew.language.phrase("2FADisabled"),"success"),r.default("#enable-2fa").removeClass("d-none"),r.default("#disable-2fa, #backup-codes").addClass("d-none"))})).catch((e=>$e(null==e?void 0:e.message)))},showBackupCodes:function(){let e="<p>"+ew.language.phrase("BackupCodesMsg")+"</p>";return ke({title:ew.language.phrase("BackupCodes"),html:e,showDenyButton:!0,showLoaderOnDeny:!0,showCancelButton:!0,confirmButtonText:ew.language.phrase("CopyToClipboard"),denyButtonText:ew.language.phrase("GetNewCodes"),customClass:{denyButton:"btn btn-primary ew-swal2-deny-button"},willOpen:()=>{Swal.showLoading(),Swal.disableButtons(),r.default.get(ew.getApiUrl([ew.API_2FA_ACTION,ew.API_2FA_BACKUP_CODES])).then((t=>{t.success&&Array.isArray(t.codes)&&(Swal.update({html:e+'<textarea class="form-control ew-backup-codes" readonly>'+t.codes.join("\n")+"</textarea>"}),Swal.enableButtons(),Swal.getConfirmButton().focus())})).fail(((e,t,a)=>$e(a))).always((()=>Swal.hideLoading()))},preConfirm:()=>(Pt(Swal.getHtmlContainer().querySelector("textarea"))&&$e(ew.language.phrase("CopiedToClipboard"),"success"),!1),preDeny:async()=>(Swal.showLoading(Swal.getDenyButton()),await r.default.get(ew.getApiUrl([ew.API_2FA_ACTION,ew.API_2FA_NEW_BACKUP_CODES])).then((t=>{t.success&&Array.isArray(t.codes)&&(Swal.update({html:e+'<textarea class="form-control ew-backup-codes" readonly>'+t.codes.join("\n")+"</textarea>"}),Swal.getConfirmButton().focus())})).fail(((e,t,a)=>$e(a))).always((()=>Swal.hideLoading())),!1)})},addOptionDialogShow:function(e){var t;e.lnk=e.lnk||(null==(t=e.evt)?void 0:t.currentTarget);var a=ew.addOptionDialog||r.default("#ew-add-opt-dialog").on("hidden.bs.modal",(function(){At(a.data("args").el);var e=a.removeData("args").find(".modal-body form").data("form");e&&e.destroyEditor(),a.find(".modal-body").html(""),a.find(".modal-footer .btn-primary").off(),a.data("showing",!1)}));if(a[0]){if(!a.data("showing")){a.data("showing",!0);var n=function(e){var t,n=e,i=a.data("args"),l=we.get(i.lnk),s=a.find(".modal-body form input[name='"+ew.API_OBJECT_NAME+"']").val(),o=i.el,d=/^x(\d+)_/,u=o.match(d),c=u?u[0]:"x_",f=u?u[1]:-1,p=o.replace(d,"x_"),h=l.getList(o);if(r.default.isString(e)&&(n=Re(e)),null!=(t=n)&&t.success&&n[s]){a.modal("hide");var g=n[s],m=l.$element[0],w=lt(o,m);if(w){var v=h.linkField,b=h.displayFields.slice(),y=h.filterFields.slice(),_=h.parentFields.slice();_.forEach(((e,t)=>{1==e.split(" ").length&&(_[t]=_[t].replace(/^x_/,c))}));var S=""!=v?g[v]:"",E={lf:S};if(b.forEach(((e,t)=>{e in g&&(E["df"+(t||"")]=g[e])})),y.forEach(((e,t)=>{e in g&&(E["ff"+(t||"")]=g[e])})),S&&b.length>0&&E.df){null===h.ajax&&h.lookupOptions.push(E);var A=_.map((e=>ct(e,m)));i={data:E,parents:A,valid:!0,name:ht(w),form:m};if(ve.trigger("addoption",[i]),i.valid){var T=xt(w),x=vt(w,E,m);w.options&&(w.options[w.options.length-1].selected=!0,w.list&&(w.render(),r.default(w.target).find("input").last().trigger("focus")),ze(w)?(r.default(w).val(S).trigger("change"),r.default(w.input).val(x).trigger("focus")):r.default(w).trigger("change").trigger("focus"));var I=r.default(m),O=I.is("div")?"_"+I.attr("id"):"",C=I.find("#key_count"+O).val();if(C>0)for(var N=1;N<=C;N++)if(N!=f){var P=lt(p.replace(/^x/,"x"+N),m),R=xt(P);JSON.stringify(T)==JSON.stringify(R)&&(vt(P,E,m),P.options&&w.list&&P.render())}}}}}else{var L;if(null!=(L=n)&&L.error){var F;r.default.isString(n.error)?ke(n.error):r.default.isString(null==(F=n.error)?void 0:F.description)&&ke(n.error.description)}else{var k,D,M=r.default("<div></div>").html(e).find("div.ew-message-dialog");if(M[0])k=M.html();else(k=(null==(D=n)?void 0:D.failureMessage)||e)&&""!=String(k).trim()||(k=ew.language.phrase("InsertFailed"));ke(k)}}},i=function(e){a.modal("hide"),ke("Server Error "+e.status+": "+e.statusText)},l=async function(e){let t=ew.addOptionDialog.find(".modal-body form")[0],a=we.get(t.id),l=e?e.target:null,s=r.default(l);return await a.canSubmit()&&(s.prop("disabled",!1).removeClass("disabled"),be.css("cursor","wait"),r.default.post(Ee([ew.API_ADD_ACTION,t.elements[ew.API_OBJECT_NAME].value]),r.default(t).serialize(),n).fail(i).always((function(){a.enableForm(),s.prop("disabled",!1).removeClass("disabled"),be.css("cursor","default")}))),!1};a.modal("hide"),a.data("args",e);return r.default.get(e.url,(function(t){var n=we.get(e.lnk),i="x_",s=e.el.match(/^(x\d+_)/);s&&(i=s[1]);var o=n.getList(e.el),d=o.parentFields.slice().map((e=>1==e.split(" ").length?e.replace(/^x_/,i):e)),u=n.htmlForm,c=d.map((e=>ct(e,u))),f=d.map((e=>ft(e,u))),p=o.filterFieldVars.slice();a.find(".modal-title").html(r.default(e.lnk).closest(".ew-add-opt-btn").data("title")),a.find(".modal-body").html(St(t)),(u=a.find(".modal-body form")[0])&&(r.default(u).on("keydown",(function(e){if("Enter"==e.key&&"TEXTAREA"!=e.target.nodeName)return l()})),c.forEach(((e,t)=>{var a;(a=lt(p[t],u))&&(a.options||a.length?r.default(a).first().one("updated",(()=>bt(a,e))):bt(a,e))}))),ew.addOptionDialog=a.modal("show"),a.find(".modal-footer .btn-primary").click(l).focus(),_t(t,e.el),u&&c.forEach(((e,t)=>{var a=lt(p[t],u);a&&(ze(a)?(a.value=e[0],a.input.value=f[t][0],a.add(e[0],f[t][0],!0)):a.options||a.length||(a.value=e[0]))})),a.trigger("load.ew")})).fail(i),!1}}else ke("DIV #ew-add-opt-dialog not found.")},modalDialogHide:It,modalDialogShow:function(e){var t,a,n,i,l,s;e.lnk=e.lnk||(null==(t=e.evt)?void 0:t.currentTarget),null==(a=bootstrap.Tooltip.getInstance(e.lnk))||a.hide();var o=e.f||(null==(n=e.evt)||null==(i=n.currentTarget)?void 0:i.form);if(o&&!Ze(o))return De('<p class="text-danger">'+ew.language.phrase("NoRecordSelected")+"</p>"),!1;var d=e.url||(null==(l=e.evt)||null==(s=l.currentTarget)?void 0:s.dataset.url),u=ew.modalDialog||r.default("#ew-modal-dialog").on("hidden.bs.modal",It);if(u.data("showing")&&u.data("url")==d)return!1;u.data({showing:!0,url:d}),e.reload=!1;var c=e.size||"modal-xl";u.find(".modal-dialog").removeClass("modal-sm modal-md modal-lg modal-xl").addClass(c);var f=function(){var e=u.data("args"),t=r.default(e.lnk);return e.caption||t.data("caption")||t.data("original-title")||""},p=function(){var e=u.data("args");return r.default.isNull(e.btn)?"":e.btn&&""!=e.btn?ew.language.phrase(e.btn):f()},h=function(e){u.modal("hide"),e.status&&ke("Server Error "+e.status+": "+e.statusText)},g=function(e){be.css("cursor","default")},m=function(e){var t=null,a=e.url,n=e.reload;if((a||n)&&(t=function(){if(a)if(e.modal&&!function(e){var t=r.default("<a>",{href:e})[0];return window.location.pathname.endsWith(t.pathname)}(a)){var t=u.data("args");t.reload=!0,e.caption&&(t.caption=e.caption),t.btn=e.view?null:"",u.data("args",t),a+=(a.split("?").length>1?"&":"?")+"modal=1&rnd="+kt(),be.css("cursor","wait"),r.default.get(a).done(b).fail(h).always(g)}else u.modal("hide"),window.location=Ae(a);else n&&(u.modal("hide"),window.location.reload())}),r.default.isString(e.failureMessage))ke(e.failureMessage);else if(r.default.isString(e.warningMessage))ke(e.warningMessage,t,"warning");else if(r.default.isString(e.message))ke(e.message,t,"body");else if(r.default.isString(e.successMessage))ke(e.successMessage,t,"success");else if(e.error){var i,l;r.default.isString(e.error)?ke(e.error):r.default.isString(null==(i=e.error)?void 0:i.message)?ke(e.error.message):r.default.isString(null==(l=e.error)?void 0:l.description)&&ke(e.error.description)}else t&&t()},w=function(e){var t=Re(e);if(r.default.isObject(t))m(t);else{var a=Tt(e);if(a.length){var n=u.find(".modal-body").html(a),i="",l=n.find("#confirm"),s=n.find("#conflict");if("1"==(null==s?void 0:s.val()))i+='<button type="button" id="btn-overwrite" class="btn btn-primary ew-btn">'+ew.language.phrase("OverwriteBtn")+"</button>",i+='<button type="button" id="btn-reload" class="btn btn-default ew-btn">'+ew.language.phrase("ReloadBtn")+"</button>",i+='<button type="button" class="btn btn-default ew-btn" data-bs-dismiss="modal">'+ew.language.phrase("CancelBtn")+"</button>",u.find(".modal-footer").html(i),u.find(".modal-footer #btn-overwrite").on("click",{action:"overwrite"},v),u.find(".modal-footer #btn-reload").on("click",{action:"show"},v);else if("confirm"==(null==l?void 0:l.val()))i+='<button type="button" class="btn btn-primary ew-btn">'+ew.language.phrase("ConfirmBtn")+"</button>",i+='<button type="button" class="btn btn-default ew-btn">'+ew.language.phrase("CancelBtn")+"</button>",u.find(".modal-footer").html(i),u.find(".modal-footer .btn-primary").click(v).focus(),u.find(".modal-footer .btn-default").on("click",{action:"cancel"},v);else{if(!u.find(".card-body button[type=submit], .modal-footer .btn-primary").first().addClass("ew-submit").click(v)[0]){var o=p();o&&(i+='<button type="button" class="btn btn-primary ew-btn">'+o+"</button>"),i+='<button type="button" class="btn btn-default ew-btn" data-bs-dismiss="modal">'+ew.language.phrase("CancelBtn")+"</button>",u.find(".modal-footer").html(i),u.find(".modal-footer .btn-primary").addClass("ew-submit").click(v).focus()}}_t(e,"modal_dialog"),u.trigger("load.ew")}else e&&(u.modal("hide"),ke(e))}},v=async function(e){var t=u.find(".modal-body form")[0],a=r.default(t),n=we.get(t.id),i=null!=e&&e.data?e.data.action:null,l=e?e.target:null;if(l){if(l.classList.contains("disabled"))return!1;n.enableForm=function(){r.default(l).prop("disabled",!1).removeClass("disabled")},n.disableForm=function(){r.default(l).prop("disabled",!0).addClass("disabled")}}var s=t.elements.action;return i&&s&&(s.value=i),"cancel"==i?r.default.post(a.attr("action"),a.serialize(),b).fail(h).always(g):await n.canSubmit()&&(a.hasClass("ew-login-form")?n.submit():(be.css("cursor","wait"),r.default.post(a.attr("action"),a.serialize(),w).fail(h).always((function(){n.enableForm(),g()})))),!1};u.modal("hide"),u.data("args",e);var b=function(e){var t=Re(e);if(r.default.isObject(t))m(t);else{var a=u.data("args"),n=r.default(a.lnk);u.find(".modal-title").html(f());var i="",l=p();l&&(i+='<button type="button" class="btn btn-primary ew-btn">'+l+"</button>"),""!=i?i+='<button type="button" class="btn btn-default ew-btn" data-bs-dismiss="modal">'+ew.language.phrase("CancelBtn")+"</button>":i='<button type="button" class="btn btn-default ew-btn" data-bs-dismiss="modal">'+ew.language.phrase("CloseBtn")+"</button>",u.find(".modal-footer").html(i).toggle(!1!==a.footer);var s=Tt(e);u.find(".modal-body").html(s);var o=n.data("table");o&&u.find(".modal-dialog").addClass("table-"+o);var d=u.find(".card-body button[type=submit], .modal-footer .btn-primary").first().addClass("ew-submit").click(v);u.find(".modal-body form").on("keydown",(function(e){if("Enter"==e.key&&"TEXTAREA"!=e.target.nodeName)return d.click(),!1})),ew.modalDialog=u.modal("show"),_t(e,"modal_dialog");let t=bootstrap.Modal.getInstance(u[0]);t._focustrap.__handleFocusin||(t._focustrap.__handleFocusin=t._focustrap._handleFocusin,t._focustrap._handleFocusin=function(e){var t;null!=(t=e.target)&&t.matches("[class^=cke_dialog_]")||this.__handleFocusin(e)}),u.trigger("load.ew"),d.focus()}};if(be.css("cursor","wait"),o){var y=r.default(o);o.elements.modal||r.default("<input>").attr({type:"hidden",name:"modal",value:"1"}).appendTo(y),r.default.post(d,y.serialize(),b).fail(h).always(g)}else d+=(d.split("?").length>1?"&":"?")+"modal=1&rnd="+kt(),r.default.get(d,b).fail(h).always(g);return!1},importDialogShow:function(e){var t,a;e.lnk=e.lnk||(null==(t=e.evt)?void 0:t.currentTarget),null==(a=bootstrap.Tooltip.getInstance(e.lnk))||a.hide();var n=ew.importDialog||r.default("#ew-import-dialog");if(!n[0])return ke("DIV #ew-import-dialog not found."),!1;var i,l=n.find("#importfiles"),s=l.closest(".ew-file-drop-zone"),o=n.find(".modal-body"),d=o.find(":input[id!=importfiles]"),u=o.find(".message"),c=o.find(".progress"),f=function(e,t){var a=r.default("<div>"+e+"</div>");t&&a.addClass(t),u.removeClass("d-none").html(a),"text-danger"==t&&n.find(".modal-footer .btn").prop("disabled",!1)},p=function(){u.addClass("d-none").html("")},h=function(e,t){c.removeClass("d-none").find(".progress-bar").removeClass("bg-success bg-info").addClass(t||"bg-success").attr("aria-valuenow",e).css("width",e+"%").html(e+"%")},g=function(e){try{var t=parseInt(e.count),a=parseInt(e.totalCount),i=e.file;if(a>0&&n.find(".modal-footer .ew-close-btn").data("import-progress")){var r=parseInt(100*t/a);h(r),f(ew.language.phrase("ImportMessageProgress").replace("%t",a).replace("%c",t).replace("%f",i),"text-primary")}}catch(e){}},m=function(){var e=Ee(ew.API_PROGRESS_ACTION),t={rnd:kt()};t[ew.API_FILE_TOKEN_NAME]=l.data(ew.API_FILE_TOKEN_NAME),r.default.get(e,t,g,"json")},w=function(e){var t="";h(100);var a=e.files;if(n.find(".modal-footer .ew-close-btn").data("import-progress",!1),Array.isArray(a))for(var i=0,r=a.length;i<r;i++){var l=a[i],s=l.totalCount||0,o=l.count||0,d=l.successCount||0,u=l.failCount||0;if(""!=t&&(t+="<br>"),l.success)t+=ew.language.phrase("ImportMessageSuccess").replace("%t",s).replace("%c",o).replace("%f",l.file);else{t+=ew.language.phrase("ImportMessageError1").replace("%t",s).replace("%c",o).replace("%f",l.file).replace("%s",d).replace("%e",u),l.error&&(t+=ew.language.phrase("ImportMessageError2").replace("%e",l.error));var p=!0;if(l.failList){var g=0;for(i=1;i<=o&&(l.failList["row"+i]&&(g+=1,t+="<br>"+ew.language.phrase("ImportMessageError3").replace("%i",i).replace("%d",l.failList["row"+i])),!(g>=5));i++);u>5?t+="<br>"+ew.language.phrase("ImportMessageMore").replace("%s",u-5):p=!1}l.log&&p&&(t+="<br>"+ew.language.phrase("ImportMessageError4").replace("%l",l.log)),f(t,"text-danger")}}e.success?(f(t,"text-success"),n.find(".modal-footer .ew-close-btn").data("imported",!0)):(e.error&&(t=e.error),f(t,"text-danger")),c.addClass("d-none").find(".progress-bar").attr("aria-valuenow",0).css("width","0%").html("0%")},v=function(e){n.find(".modal-footer .ew-close-btn").data("import-progress",!1),f(ew.language.phrase("ImportMessageServerError").replace("%s",e.status).replace("%t",e.statusText),"text-danger")},b=ew.importUploadOptions;return b.acceptFileTypes||(b.acceptFileTypes=new RegExp("\\.("+ew.IMPORT_FILE_ALLOWED_EXTENSIONS.replace(/,/g,"|")+")$","i")),l.data("blueimpFileupload")||l.fileupload(Object.assign({url:Ee(ew.API_UPLOAD_ACTION),dataType:"json",autoUpload:!0,singleFileUploads:!1,dropZone:s,messages:{acceptFileTypes:ew.language.phrase("UploadErrMsgAcceptFileTypes"),maxFileSize:ew.language.phrase("UploadErrMsgMaxFileSize"),maxNumberOfFiles:ew.language.phrase("UploadErrMsgMaxNumberOfFiles"),minFileSize:ew.language.phrase("UploadErrMsgMinFileSize")},beforeSend:function(e,t){t.data.set("session",ew.SESSION_ID),t.data.set(ew.TOKEN_NAME_KEY,ew.TOKEN_NAME),t.data.set(ew.ANTIFORGERY_TOKEN_KEY,ew.ANTIFORGERY_TOKEN),ew.API_JWT_TOKEN&&!ew.IS_WINDOWS_AUTHENTICATION&&e.setRequestHeader(ew.API_JWT_AUTHORIZATION_HEADER,"Bearer "+ew.API_JWT_TOKEN)},done:function(e,t){var a,s;if(Array.isArray(null==t||null==(a=t.result)||null==(s=a.files)?void 0:s.importfiles)){var o=!0;t.result.files.importfiles.forEach((function(e,t){e.error&&(f(ew.language.phrase("ImportMessageUploadError").replace("%f",e.name).replace("%s",e.error),"text-danger"),o=!1)})),o&&function(e){be.css("cursor","wait"),l.data(ew.API_FILE_TOKEN_NAME,e),n.find(".modal-footer .ew-close-btn").data("import-progress",!0);var t=ew.API_ACTION_NAME+"=import&"+ew.API_FILE_TOKEN_NAME+"="+encodeURIComponent(e);d.length&&(t+="&"+d.serialize()),r.default.ajax(Nt(),{data:t,method:"POST",dataType:"json",beforeSend:function(e,t){i=r.default.later(100,null,m,null,!0)}}).done(w).fail(v).always((function(){be.css("cursor","default"),i&&i.cancel()}))}(t.result[ew.API_FILE_TOKEN_NAME])}},change:function(e,t){p()},processfail:function(e,t){t.files.forEach((function(e,t){e.error&&f(ew.language.phrase("ImportMessageUploadError").replace("%f",e.name).replace("%s",e.error),"text-danger")}))},fail:function(e,t){f(ew.language.phrase("ImportMessageServerError").replace("%s",t.textStatus).replace("%t",t.errorThrown),"text-danger")},progressall:function(e,t){!function(e){var t=parseInt(100*e.loaded/e.total);h(t,"bg-primary"),f(100===t?ew.language.phrase("ImportMessageUploadComplete"):ew.language.phrase("ImportMessageUploadProgress").replace("%p",t),"text-primary")}(t)}},b)),n.modal("hide").find(".modal-title").html(e.hdr),n.find(".modal-footer .ew-close-btn").off("click.ew").on("click.ew",(function(){var e=r.default(this);e.data("imported")&&(e.data("imported",!1),window.location.reload())})),p(),ew.importDialog=n.modal("show"),!1},autoFill:Ot,tooltip:Ct,emailDialogShow:function(e){var t=ew.emailDialog||r.default("#ew-email-dialog").on("shown.bs.modal",(e=>setTimeout((()=>{var t;return null==(t=e.target.querySelector(".modal-body .form-control"))?void 0:t.focus()}),200))).on("click",".modal-footer .btn-primary",(function(e){var a;e.preventDefault(),null!=(a=r.default(this).closest(".modal").find(".modal-body form").data("form"))&&a.submit()&&t.modal("hide")}));if(!t[0])return ke("DIV #ew-email-dialog not found."),!1;var a=e.evt.currentTarget.form;if(e.sel&&!Ze(a))return ke(ew.language.phrase("NoRecordSelected")),!1;var n=t.find(".modal-body form"),i=n.data("form");return i||((i=new v(n.attr("id"))).addFields([["sender",[ew.Validators.required(ew.language.phrase("Sender")),ew.Validators.email]],["recipient",[ew.Validators.required(ew.language.phrase("Recipient")),ew.Validators.emails(ew.MAX_EMAIL_RECIPIENT,ew.language.phrase("EnterProperRecipientEmail"))]],["cc",ew.Validators.emails(ew.MAX_EMAIL_RECIPIENT,ew.language.phrase("EnterProperCcEmail"))],["bcc",ew.Validators.emails(ew.MAX_EMAIL_RECIPIENT,ew.language.phrase("EnterProperBccEmail"))],["subject",ew.Validators.required(ew.language.phrase("Subject"))]]),i.validate=function(){return this.validateFields()},i.submit=function(){if(!this.validate())return!1;var i=[n.serialize()];a&&e.sel&&i.push(r.default(a).find("input[type=checkbox][name='key_m[]']:checked").serialize()),e.key&&i.push(r.default.param(e.key));var l=this.getForm();return e.url?(t.modal("hide"),e.exportid?ew.exportWithCharts(e.url,e.exportid,l):Ge(e.evt,e.url,"email",!0,e.sel,l)):r.default.post(a.getAttribute("action"),i.join("&"),(e=>Ft(e))),!0},n.data("form",i)),ew.emailDialog=t.modal("hide").find(".modal-title").html(e.hdr).end().modal("show"),!1},showDrillDown:function(e,t,a,n,i){if(null!=e&&e.ctrlKey){var l=a.split("?"),s=new URLSearchParams(l[1]);return s.set("d","2"),$t(l[0]+"?"+s.toString())}var o=r.default(t),d=o.data("drilldown-placement")||"auto",u={obj:o[0],placement:d,id:n,url:a,hdr:i};ve.trigger("drilldown",[u]);var c=u.url.split("?");u.file=c[0]||"",u.data=c[1]||"",bootstrap.Popover.getInstance(t)||o.popover({html:!0,placement:u.placement,trigger:"manual",title:u.hdr,template:'<div class="popover" role="tooltip"><h3 class="popover-header d-none" style="cursor: move;"></h3><div class="popover-body"></div></div>',content:'<div class="'+ew.spinnerClass+' m-3 ew-loading" role="status"><span class="visually-hidden">'+ew.language.phrase("Loading")+"</span></div>",container:r.default("#ew-drilldown-panel").draggable(ew.draggableOptions),sanitizeFn:ew.sanitizeFn,boundary:"viewport"}).on("show.bs.popover",(function(e){o.attr("data-original-title","")})).on("shown.bs.popover",(function(e){if(o.data("args")){var a=o.data("args").data;r.default.ajax({cache:!1,dataType:"html",type:"POST",data:a,url:o.data("args").file,success:function(e){var a=r.default(bootstrap.Popover.getInstance(t).getTipElement());u.hdr&&a.find(".popover-header").empty().removeClass("d-none").append('<button type="button" class="btn-close" aria-label="'+ew.language.phrase("CloseBtn")+'"></button>'+u.hdr).find(".btn-close").on("click",(function(){o.popover("hide")}));var i=e.match(/<body[^>]*>([\s\S]*?)<\/body\s*>/i);e=i?i[0]:e;var l=ew.stripScript(e);a.find(".popover-body").html(r.default("<div></div>").html(l).find("#ew-report")).find(".ew-table").each(ew.setupTable),ew.executeScript(e,n),o.popover("update")},error:function(e){if(e.responseText){if(r.default.isString(e.responseText)&&e.responseText.startsWith("{")&&e.responseText.endsWith("}")){var a,n,i=Re(e.responseText);if(null!=i&&null!=(a=i.error)&&a.type&&null!=i&&null!=(n=i.error)&&n.description)return bootstrap.Popover.getInstance(t).hide(),ke({title:i.error.type,html:i.error.description,customClass:{title:"ew-swal2-title text-danger",htmlContainer:"ew-swal2-html-container text-danger"}})}r.default(bootstrap.Popover.getInstance(t).getTipElement()).find(".popover-body").empty().append('<p class="text-danger">'+e.responseText+"</p>")}}})}})).on("hidden.bs.popover",(function(e){ew.removeScript(n)})),o.data("args",u).popover("show")},ajax:function(e,t){if(r.default.isObject(e)&&(e.url||e.action)){var a;e.url?e.url.startsWith(Ee())?a=e.url.replace(Ee(),"").split("/")[0]:e.url.startsWith(ew.API_URL)&&(a=e.url.replace(ew.API_URL,"").split("/")[0]):(a=e.action,delete e.action);var n=Object.assign({},e),i=e=>{if(r.default.isObject(e)&&"OK"==e.result){var t=e.records;return Array.isArray(t)&&1==t.length?(t=t[0],Array.isArray(t)&&1==t.length?t[0]:t):t}return e},l=n.url||Ee(a),s=n.type||([ew.API_LIST_ACTION,ew.API_VIEW_ACTION,ew.API_DELETE_ACTION].includes(a)?"GET":"POST");if(delete n.url,delete n.type,n.dataType="json",!Fe(t)){var o=r.default.ajax({url:l,async:!1,type:s,data:n});return i(o.responseJSON)}r.default.ajax({url:l,type:s,data:n,success:function(e){t(i(e))}})}},currentPage:Nt,toggleSearchOperator:function(e,t,a){var n=e.currentTarget.form.elements[t];n&&(n.value=n.value!=a?a:"=")},toggleLayout:function(e){var t;null==(t=bootstrap.Tooltip.getInstance(e))||t.hide(),be.css("cursor","wait");let a=e.dataset.layout,n=document.querySelector(".ew-multi-column-grid"),i=r.default(n);i.load(Ae(e.dataset.url+ew.PAGE_LAYOUT+"="+a)+" .ew-multi-column-grid",((e,t,r)=>{var l,s;"error"==t?ke(r.status+" "+r.statusText):(At(a),_t(null!=(l=null==(s=document.createRange().createContextualFragment(e).querySelector(".ew-multi-column-grid"))?void 0:s.innerHTML)?l:"",a),ew.initPage({target:n}),be.css("cursor","default"),i.trigger("layout"))}))},copyToClipboard:Pt,checkInteger:function(e){return!e||0==e.length||!e.includes(ew.DECIMAL_SEPARATOR)&&Rt(e)},checkNumber:Rt,escapeRegExChars:function(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},checkRange:function(e,t,a){return!e||0==e.length||((r.default.isNumber(t)||r.default.isNumber(a))&&Rt(e)&&(e=ew.parseNumber(e)),!(!r.default.isNull(t)&&e<t)&&!(!r.default.isNull(a)&&e>a))},checkPhone:function(e){return!e||0==e.length||/^\(\d{3}\) ?\d{3}( |-)?\d{4}|^\d{3}( |-)?\d{3}( |-)?\d{4}$/.test(e.trim())},checkZip:function(e){return!e||0==e.length||/^\d{5}$|^\d{5}-\d{4}$/.test(e.trim())},checkCreditCard:function(e){if(!e||0==e.length)return!0;var t=e.replace(/\D/g,"");if(0==t.length)return!1;for(var a,n=t.length%2!=1,i=0,r=0,l=t.length;r<l;r++)a=parseInt(t.charAt(r),10),n?(i+=(a*=2)%10,a/10>=1&&i++,n=!1):(i+=a,n=!0);return i%10==0},checkSsn:function(e){return!e||0==e.length||/^(?!000)([0-6]\d{2}|7([0-6]\d|7[012]))([ -]?)(?!00)\d\d\3(?!0000)\d{4}$/.test(e.trim())},checkEmails:function(e,t){if(!e||0==e.length)return!0;for(var a=e.replace(/,/g,";").split(";"),n=0,i=a.length;n<i;n++){if(t>0&&i>t)return!1;if(!Lt(a[n]))return!1}return!0},checkEmail:Lt,checkGuid:function(e){return!e||0==e.length||/^(\{\w{8}-\w{4}-\w{4}-\w{4}-\w{12}\}|\w{8}-\w{4}-\w{4}-\w{4}-\w{12})$/.test(e.trim())},checkUrl:function(e){if(!e||0==e.length)return!0;try{new URL(e)}catch(e){return!1}return!0},checkByRegEx:function(e,t){return!e||0==e.length||!!e.match(t)},showMessage:Ft,random:kt,upload:function(e){var t=r.default(e);if(!t.data("blueimpFileupload")){var a=t.attr("name"),n=a.replace(/\$/g,"\\$"),i=t.data("table"),l=t.is("[multiple]"),s=t.closest(".ew-file-drop-zone"),o=t.closest(ye),d=t.prop("disabled")||"confirm"==t.closest("form").find("#confirm").val(),u=o.find("#ft_"+n),c=o.find("#fn_"+n),f=o.find("#fa_"+n),p=o.find("#fs_"+n),h=o.find("#fx_"+n),g=o.find("#fm_"+n),m=o.find("#fc_"+n),w=o.find(".ew-file-label"),v=w.html(),b=function(e){!l&&c.val()&&(confirm(ew.language.phrase("UploadOverwrite"))||(e.preventDefault(),e.stopPropagation()))},y=r.default.templates("#template-download"),_=r.default.templates("#template-upload"),S=Ue(e),E=r.default(S);(d="confirm"==E.find("#confirm").val()||t.attr("readonly"))&&t.prop("disabled",!0);var A=parseInt(m.val(),10),T=Ee(ew.API_JQUERY_UPLOAD_ACTION),x={id:a,table:i,session:ew.SESSION_ID,replace:l?"0":"1",exts:h.val(),maxsize:g.val(),maxfilecount:m.val()};t.fileupload(Object.assign({url:T,type:"POST",multipart:!0,autoUpload:!0,loadImageFileTypes:/^image\/(gif|jpe?g|png)$/i,loadVideoFileTypes:/^video\/mp4$/i,loadAudioFileTypes:/^audio\/(mpeg|mp3)$/i,acceptFileTypes:h.val()?new RegExp("\\.("+h.val().replace(/,/g,"|")+")$","i"):null,maxFileSize:parseInt(g.val(),10),maxNumberOfFiles:A>1?A:null,filesContainer:u,formData:x,uploadTemplateId:null,downloadTemplateId:null,uploadTemplate:_.render.bind(_),downloadTemplate:y.render.bind(y),previewMaxWidth:ew.UPLOAD_THUMBNAIL_WIDTH,previewMaxHeight:ew.UPLOAD_THUMBNAIL_HEIGHT,dropZone:s,messages:{acceptFileTypes:ew.language.phrase("UploadErrMsgAcceptFileTypes"),maxFileSize:ew.language.phrase("UploadErrMsgMaxFileSize"),maxNumberOfFiles:ew.language.phrase("UploadErrMsgMaxNumberOfFiles"),minFileSize:ew.language.phrase("UploadErrMsgMinFileSize")},readonly:d},ew.uploadOptions)).on("fileuploaddone",(function(e,t){if(!t.result.files[0].error){var a=t.result.files[0].name,n=l&&c.val()?c.val().split(ew.MULTIPLE_UPLOAD_SEPARATOR):[];n.push(a),c.val(n.join(ew.MULTIPLE_UPLOAD_SEPARATOR)),f.val("0"),l||u.find("tbody > tr:not(:last-child)").remove()}})).on("fileuploaddestroy",(function(e,t){var a=r.default(e.originalEvent.target).data("url"),n=new URLSearchParams(a.split("?")[1]),i=n.get("id"),l=n.get(i);if(l){var s=c.val()?c.val().split(ew.MULTIPLE_UPLOAD_SEPARATOR):[],o=s.indexOf(l);o>-1&&s.splice(o,1),c.val(s.join(ew.MULTIPLE_UPLOAD_SEPARATOR)),f.val("0")}})).on("fileuploadchange",(function(e,t){var a;u.toggleClass("ew-has-rows",(null==(a=t.files)?void 0:a.length)>0);for(var n=c.val()?c.val().split(ew.MULTIPLE_UPLOAD_SEPARATOR):[],i=0;i<t.files.length;i++)n.push(t.files[i].name);var l=parseInt(m.val(),10);if(r.default.isNumber(l)&&l>0&&n.length>l)return ke(ew.language.phrase("UploadErrMsgMaxNumberOfFiles")),!1;var s=parseInt(p.val(),10);return r.default.isNumber(s)&&s>0&&n.join(ew.MULTIPLE_UPLOAD_SEPARATOR).length>s?(ke(ew.language.phrase("UploadErrMsgMaxFileLength")),!1):void 0})).on("fileuploadadded fileuploadfinished fileuploaddestroyed",(function(e,t){var a,n,i;u.toggleClass("ew-has-rows",(null==(a=t.files)?void 0:a.length)>0||(null==(n=t.result)||null==(i=n.files)?void 0:i.length)>0);var r=c.val()?c.val().split(ew.MULTIPLE_UPLOAD_SEPARATOR):[];w.html(r.join(", ")||v)})).on("fileuploadadded",(function(e,t){var a;u.toggleClass("ew-has-rows",(null==(a=t.files)?void 0:a.length)>0),t.context.find(".start").click(b)})).on("fileuploadcompleted",(function(e,t){Ce(e={target:t.context}),Ne(e),ew.updateDropdownPosition(),t.context.find("img").on("load",ew.updateDropdownPosition)})),c.val()&&r.default.ajax({url:T,data:{id:a,table:i,session:ew.SESSION_ID},dataType:"json",context:this,success:function(n){if(null!=n&&n[a]){var i=t.fileupload("option","done");i&&i.call(e,r.default.Event(),{result:{files:n[a]}})}d&&u.find("td.delete").hide()}})}},parseNumber:function(e){let t=ew.getLocaleFromPlatform(ew.LANGUAGE_ID);return"latn"==ew.NUMBERING_SYSTEM&&(t.numeralSystem=void 0),t.delimiters.thousands!==ew.GROUPING_SEPARATOR&&(t.delimiters.thousands=ew.GROUPING_SEPARATOR),t.delimiters.decimal!==ew.DECIMAL_SEPARATOR&&(t.delimiters.decimal=ew.DECIMAL_SEPARATOR),ew.parse(e,{locale:t})},getNumberingSystem:function(){return ew.NUMBERING_SYSTEM||new Intl.NumberFormat(ew.LANGUAGE_ID).resolvedOptions().numberingSystem},formatDateTime:function(e,t){let a;return r.default.isString(e)?a=Dt.fromSQL(e):r.default.isNumber(e)?a=Dt.fromSeconds(e):e instanceof Date&&(a=Dt.fromJSDate(e)),a.toFormat(t,{locale:ew.LANGUAGE_ID,numberingSystem:ew.getNumberingSystem()})},parseDateTime:Mt,parseDate:Mt,parseTime:Mt,checkDate:function(e,t){return!e||0==e.length||Mt(e,t).isValid},checkTime:function(e,t){return!e||0==e.length||Mt(e,t).isValid},formatCurrency:function(e,t){if(t||(t=ew.CURRENCY_FORMAT),t.includes(";")){let a=t.split(";");t=e>=0?a[0]:a[1]}t=t.replace("","$");let a=ew.getLocaleFromPlatform(ew.LANGUAGE_ID);return"latn"==ew.NUMBERING_SYSTEM&&(a.numeralSystem=void 0),a.delimiters.thousands!==ew.GROUPING_SEPARATOR&&(a.delimiters.thousands=ew.GROUPING_SEPARATOR),a.delimiters.decimal!==ew.DECIMAL_SEPARATOR&&(a.delimiters.decimal=ew.DECIMAL_SEPARATOR),ew.format(e,t,{locale:a,currency:(ew.IS_RTL?"":"")+ew.CURRENCY_SYMBOL})},formatNumber:function(e,t){let a=ew.getLocaleFromPlatform(ew.LANGUAGE_ID);return"latn"==ew.NUMBERING_SYSTEM&&(a.numeralSystem=void 0),a.delimiters.thousands!==ew.GROUPING_SEPARATOR&&(a.delimiters.thousands=ew.GROUPING_SEPARATOR),a.delimiters.decimal!==ew.DECIMAL_SEPARATOR&&(a.delimiters.decimal=ew.DECIMAL_SEPARATOR),ew.format(e,t||ew.NUMBER_FORMAT,{locale:a})},formatPercent:function(e,t){let a=ew.getLocaleFromPlatform(ew.LANGUAGE_ID);return"latn"==ew.NUMBERING_SYSTEM&&(a.numeralSystem=void 0),a.delimiters.thousands!==ew.GROUPING_SEPARATOR&&(a.delimiters.thousands=ew.GROUPING_SEPARATOR),a.delimiters.decimal!==ew.DECIMAL_SEPARATOR&&(a.delimiters.decimal=ew.DECIMAL_SEPARATOR),ew.format(e,t||ew.PERCENT_FORMAT,{locale:a})},initPage:function(e){var t,a=null!=(t=null==e?void 0:e.target)?t:document,n=r.default(a),i=n.find("table.ew-table:not(.ew-export-table)");ew.initPanels(a),ew.renderJsTemplates(e),Oe(e),Le(e),Pe(e),Se(e),_e(e),Ce(e),Ne(e),n.find("[data-widget='treeview']").each((function(){adminlte.Treeview._jQueryInterface.call(r.default(this),"init")})),i.each(nt),n.find(".ew-table-header-caption[data-sort-url]").each((function(){let e=r.default(this);e.on("click",(t=>ew.sort(t,e.data("sortUrl"),e.data("sortType"))))})),n.find(".ew-column-dropdown").each((function(){var e;let t=this.dataset.table;null==(e=localStorage.getItem(ew.PROJECT_NAME+"_"+t+"_invisible_fields"))||e.split(",").forEach((e=>r.default("#tbl_"+t+"list").find("th[data-name='"+e+"'],td[data-name='"+e+"']").toggleClass("d-none",!0))),r.default(this).find(".ew-dropdown-checkbox").on("click",(function(e){let a=this.querySelector(".ew-dropdown-check-input[data-field]"),n=null==a?void 0:a.dataset.field;t&&n&&(a.classList.toggle("ew-checked"),r.default("#tbl_"+t+"list").find("th[data-name='"+n+"'],td[data-name='"+n+"']").toggleClass("d-none",!a.classList.contains("ew-checked"))),localStorage.setItem(ew.PROJECT_NAME+"_"+t+"_invisible_fields",Array.from(e.currentTarget.closest(".dropdown-menu").querySelectorAll(".ew-dropdown-check-input[data-field]:not(.ew-checked)"),(e=>e.dataset.field)))}))})).on("show.bs.dropdown",(function(e){let t=e.currentTarget.dataset.table,a=e.currentTarget.querySelectorAll(".ew-dropdown-check-input[data-field]");for(let e of a){let a=e.dataset.field;e.classList.toggle("ew-checked",!!r.default("#tbl_"+t+"list").find("th[data-name='"+a+"']:not(.d-none)")[0])}})),n.find("input.ew-page-no").on("keydown",(function(e){if("Enter"==e.key)return me.searchParams.set(this.name,ew.parseNumber(this.value)),window.location=Ae(me.toString()),!1})),ew.IS_SCREEN_SM_MIN||n.find("."+ew.RESPONSIVE_TABLE_CLASS+" [data-bs-toggle='dropdown']").parent().on("shown.bs.dropdown",(function(){var e=r.default(this),t=e.find(".dropdown-menu"),a=e.closest("."+ew.RESPONSIVE_TABLE_CLASS)[0];if(a.scrollHeight-a.clientHeight){var n=t.offset().top+t.outerHeight()-r.default(a).offset().top-a.clientHeight;n>0&&t.css(ew.IS_RTL?"right":"left","100%").css("top",parseFloat(t.css("top"))-n)}})),Te(e),xe(e);var l=n.find(".ew-report");l[0]&&(l.find(".card").on("collapsed.lte.widget",(function(){var e=r.default(this).closest("[class^='col-']"),t=e.css("min-height");t&&e.data("min-height",t),e.css("min-height",0)})).on("expanded.lte.widget",(function(){var e=r.default(this).closest("[class^='col-']"),t=e.css("min-height");t&&e.css("min-height",t)})),l.find(".ew-group-toggle").on("click",(function(){ew.toggleGroup(this)}))),"undefined"!=typeof ew.USE_JAVASCRIPT_MESSAGE&&ew.USE_JAVASCRIPT_MESSAGE&&Ft(e)},redirect:$t,togglePassword:function(e){var t=r.default(e.currentTarget),a=t.closest(".input-group").find("input"),n=t.find("i");"text"==a.attr("type")?(a.attr("type","password"),n.toggleClass("fa-eye-slash fa-eye")):"password"==a.attr("type")&&(a.attr("type","text"),n.toggleClass("fa-eye-slash fa-eye"))},exportWithCharts:function(e,t,a){let n=new URL(window.location.href),i=e.split("?"),l=a?"post":"get";t+="_"+Date.now(),n.pathname=i[0],n.search=i[1],n.searchParams.set("exportid",t);let s=function(){let e=n.searchParams,t="1"==e.get("custom");if(a&&!t){let e=r.default(a).serialize();r.default.post(n,e,(function(e){Ft(e)}))}else{let i=e.get("export");t&&["word","excel","pdf","email"].includes(i)?("email"==i&&(e.delete("export"),n.search=e.toString()+"&"+r.default(a).serialize()),r.default("iframe.ew-export").remove(),r.default("<iframe></iframe>").addClass("ew-export d-none").attr("src",n.toString()).appendTo(be.css("cursor","wait")),setTimeout((()=>be.css("cursor","default")),5e3)):"print"==i?$t(n.toString(),a,l):Ie(n.toString(),null)}return!1};if(0==Object.keys(window.exportCharts).length)return s();be.css("cursor","wait");let o=[];for(const[e,a]of Object.entries(window.exportCharts)){let n="exportfilename="+t+"_"+e+".png|exportformat=png|exportaction=download|exportparameters=undefined";null!=a&&a.toBase64Image&&o.push({chartEngine:"Chart.js",streamType:"base64",stream:a.toBase64Image(),parameters:n})}return r.default.ajax({url:Ee(ew.API_EXPORT_CHART_ACTION),data:{charts:JSON.stringify(o)},cache:!1,type:"POST"}).done((e=>{(e=r.default.isString(e)?Re(e):e).success?s():ke(e.error)})).fail(((e,t,a)=>ke(a+": "+e.responseText))).always((()=>be.css("cursor","default"))),!1},fixLayoutHeight:function(){Ut&&Ut.cancel(),Ut=r.default.later(50,null,(function(){var e=be.data("lte.layout");e&&e.fixLayoutHeight()}))},addEventHandlers:function(e){let t=ew.events[e];if(t)for(var[a,n]of Object.entries(t))r.default("[data-table="+e+"][data-field="+a+"]").on(n)}};function Bt(){return"serviceWorker"in navigator&&"PushManager"in window}function Kt(e){const t=(e+"=".repeat((4-e.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),a=window.atob(t),n=new Uint8Array(a.length);for(let e=0;e<a.length;++e)n[e]=a.charCodeAt(e);return n}async function Ht(e,t){const a=e.getKey("p256dh"),n=e.getKey("auth"),r=(PushManager.supportedContentEncodings||["aesgcm"])[0];let l=new FormData;return l.set("endpoint",e.endpoint),l.set("publicKey",a?btoa(String.fromCharCode.apply(null,new Uint8Array(a))):null),l.set("authToken",n?btoa(String.fromCharCode.apply(null,new Uint8Array(n))):null),l.set("contentEncoding",r),(await i.default.fetch(t,{method:"POST",body:l})).json()}async function Gt(){var e;let t=i.default.getApiUrl([i.default.API_PUSH_NOTIFICATION_ACTION,i.default.API_PUSH_NOTIFICATION_SUBSCRIBE]),a=await navigator.serviceWorker.ready,n=await a.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:Kt(i.default.PUSH_SERVER_PUBLIC_KEY)}),r=await Ht(n,t);return null!=r&&null!=(e=r.error)&&e.description&&i.default.alert(r.error.description),r.success?n:null}async function Vt(){return(await navigator.serviceWorker.ready).pushManager.getSubscription()}function qt(e){let t=r.default("#subscribe-notification").toggleClass("ew-enable-notification",!e).attr("data-bs-original-title",i.default.language.phrase(e?"DisableNotifications":"EnableNotifications")).removeClass("disabled");t.find("i").toggleClass("fa-bell",!e).toggleClass("fa-bell-slash",!!e);let a=bootstrap.Tooltip.getInstance(t[0]);null!=a&&a.tip&&a.setContent(a.tip)}async function Wt(){if("denied"!==Notification.permission&&!i.default.IS_SYS_ADMIN){let n=r.default("body").css("cursor","wait");try{var e,t;if("granted"===Notification.permission)qt(null!=(e=await Vt())?e:await Gt()),null!=(t=document.getElementById("subscribe-notification"))&&t.classList.contains("ew-enable-notification")||i.default.showToast(i.default.language.phrase("NotificationsEnabled"),"success");else if("default"===Notification.permission&&"granted"==await Notification.requestPermission()){var a;qt(await Gt()),null!=(a=document.getElementById("subscribe-notification"))&&a.classList.contains("ew-enable-notification")||i.default.showToast(i.default.language.phrase("NotificationsEnabled"),"success")}}catch(e){i.default.alert(e)}finally{n.css("cursor","default")}}return!1}async function zt(){return r.default("#subscribe-notification").tooltip(),"granted"==Notification.permission?qt(await Vt()):qt(null),!0}async function Yt(){return i.default.prompt({html:i.default.language.phrase("DisableNotificationsMsg")},(async e=>{if(!e)return;let t=r.default("body").css("cursor","wait");try{var a;let e=await Vt();await e.unsubscribe();let n=i.default.getApiUrl([i.default.API_PUSH_NOTIFICATION_ACTION,i.default.API_PUSH_NOTIFICATION_DELETE]),r=await Ht(e,n);if(null!=r&&null!=(a=r.error)&&a.description)return i.default.alert(r.error.description),!1;r.success&&(qt(null),i.default.showToast(i.default.language.phrase("NotificationsDisabled"),"success"))}catch(e){i.default.alert(e)}finally{t.css("cursor","default")}})),!1}i.default.SERVICE_WORKER="sw.js",loadjs.ready("foot",(()=>{i.default.PUSH_SERVER_PUBLIC_KEY&&Bt()?navigator.serviceWorker.register(i.default.PATH_BASE+i.default.SERVICE_WORKER,{scope:i.default.PATH_BASE}).then((()=>{zt(),r.default("#subscribe-notification").on("click",(function(){this.classList.contains("ew-enable-notification")?Wt():Yt()}))})).catch((e=>console.log(e))):r.default("#subscribe-notification").addClass("d-none")}));var Jt={__proto__:null,pushNotificationDialogShow:async function(e){let t=i.default.pushDialog||r.default("#ew-push-notification-dialog").on("shown.bs.modal",(e=>setTimeout((()=>{var t;return null==(t=e.target.querySelector(".modal-body .form-control"))?void 0:t.focus()}),200))).on("click",".modal-footer .btn-primary",(function(e){var a;e.preventDefault(),null!=(a=r.default(this).closest(".modal").find(".modal-body form").data("form"))&&a.submit()&&t.modal("hide")}));if(!t[0])return console.log("DIV #ew-push-notificatoin-dialog not found"),!1;if(!e.url)return console.log("Missing URL of Web Push API"),!1;let a=e.evt.currentTarget,n=r.default(a.form),l=t.find(".modal-body form"),s=l.data("form");if(l.data("all",!1),!n.find("input[name='key_m[]']:checked")[0]){let e=await i.default.prompt(i.default.language.phrase("SendPushNotificationsToAll"),(e=>e));if(l.data("all",e),!e)return}return s||(s=new i.default.Form(l.attr("id")),s.addFields([["title",i.default.Validators.required(i.default.language.phrase("PushNotificationFormTitle"))],["body",i.default.Validators.required(i.default.language.phrase("PushNotificationFormBody"))]]),s.validate=function(){return this.validateFields()},s.submit=function(){if(!this.validate())return!1;let t=[l.serialize(),l.data("all")?"":n.find("input[name='key_m[]']:checked").serialize()].join("&");return r.default.post(e.url,t,(e=>{var t;if(Array.isArray(e)){let t=e.reduce(((e,t)=>e+(t.success?1:0)),0),a=e.length-t;t>0&&0==a?i.default.alert(i.default.language.phrase("PushNotificationSuccess").replace("%s",t),"success"):0==t&&a>0?i.default.alert(i.default.language.phrase("PushNotificationFailure").replace("%f",a)):0==t&&0==a?i.default.alert(i.default.language.phrase("NoSubscriptions").replace("%f",a),"primary"):i.default.alert(i.default.language.phrase("PushNotificationSent").replace("%s",t).replace("%f",a),"primary")}else null!=e&&null!=(t=e.error)&&t.description&&i.default.alert(e.error.description)})),!0},l.data("form",s)),i.default.pushDialog=t.modal("hide").find(".modal-title").html(e.hdr||a.dataset.caption).end().modal("show"),!1},isPushNotificationSupported:Bt,subscribeNotification:Wt,checkSubscription:zt,unsubscribeNotification:Yt};function Xt(e){if(e.inited)return!0;let t=e.latlng,a=r.default("#"+e.id),n=e.useSingleMap,i=e.showAllMarkers,l=e.useMarkerClusterer,s=ew.maps[e.ext];if(n){let t=e.id.replace(/^mp\d*_/,"mp_");a=r.default("#"+t),a[0]||(a=r.default("<div></div>").attr("id",t).addClass("ew-single-map").height(e.singleMapHeight),e.singleMapWidth&&a.width(e.singleMapWidth),r.default(".ew-grid, .ew-multi-column-grid").first()[e.showMapOnTop?"before":"after"](a),e.map=s.createMap(a[0],e),a.data("map",e.map),a.data("ext",e.ext),a.data("bounds",i?s.createBounds():null),a.data("markerClusterer",l?s.createMarkerClusterer(e):null)),e=Object.assign(e,a.data())}else{if(!t)return a.addClass("d-none").html(e.status),!0;a.next(".ew-map-value").addClass("d-none"),e.map||(e.map=s.createMap(a[0],e))}return e.marker=s.createMarker(e),e.inited=!0,r.default(document).trigger("map",[e]),!0}function Zt(){r.default(".ew-single-map").each((function(){let e=r.default(this).data();ew.maps[e.ext].fitBounds(e)})),r.default(document).trigger("maps")}function Qt(e){let t=r.default(".ew-map").filter((function(){return!e||r.default(this).data("ext")==e})).map((function(e){let t=r.default(this).data();if(t.inited)return Xt(t);if(t.id=this.id,t.address=(t.address||"").trim(),t.address){let a=t.geocodingDelay;return new Promise((n=>{r.default.later(e*a,null,(()=>{n(ew.maps[t.ext].geocode(t).then((e=>{t.latlng=e})).catch((e=>{t.status=e})).finally((()=>Xt(t))))}))}))}{let e=t.latitude,a=t.longitude;return e&&!isNaN(e)&&a&&!isNaN(a)&&(t.latlng=ew.maps[t.ext].createLatLng(e,a)),Xt(t)}})).get();return Promise.all(t).then(Zt)}r.default((function(){r.default("#ew-modal-dialog").on("load.ew",Qt),r.default(document).on("preview",Qt)}));var ea={__proto__:null,show:Xt,done:Zt,init:Qt};ew.IS_SCREEN_SM_MIN=window.matchMedia("(min-width: 768px)").matches,ew.MOBILE_DETECT=new MobileDetect(window.navigator.userAgent),ew.IS_MOBILE=!!ew.MOBILE_DETECT.mobile(),window.exportCharts={},Object.assign(ew,{MultiPage:function(e){var t=this;this.$form=null,this.formID=e,this.pageIndex=1,this.maxPageIndex=0,this.minPageIndex=0,this.pageIndexes=[],this.$pages=null,this.$collapses=null,this.isTab=!1,this.isCollapse=!1,this.lastPageSubmit=!1,this.hideDisabledButton=!1,this.hideInactivePages=!1,this.lockTabs=!1,this.hideTabs=!1,this.showPagerTop=!1,this.showPagerBottom=!1,this.pagerTemplate='<nav><ul class="pagination"><li class="page-item previous ew-prev"><a href="#" class="page-link"><span class="icon-prev"></span> {Prev}</a></li><li class="page-item next ew-next"><a href="#" class="page-link">{Next} <span class="icon-next"></span></a></li></ul></nav>';var a=function(e){e.preventDefault()},n=["lastPageSubmit","hideDisabledButton","hideInactivePages","lockTabs","hideTabs","showPagerTop","showPagerBottom","pagerTemplate"];this.set=function(){if(1==arguments.length&&r.default.isObject(arguments[0])){var e=arguments[0];for(var t in e){var a=t[0].toLowerCase()+t.substr(1);n.includes(a)&&(this[a]=e[t])}}},this.init=function(){var e=this.pagerTemplate.replace(/\{prev\}/i,ew.language.phrase("Prev")).replace(/\{next\}/i,ew.language.phrase("Next"));this.isTab?(this.showPagerTop&&this.$pages.closest(".ew-nav").before(e),this.showPagerBottom&&this.$pages.closest(".ew-nav").after(e),this.$form.find(".ew-prev").click((function(e){return t.$pages.off("show.bs.tab",a).filter(".active").parent().prev(":has([data-bs-toggle=tab]:not(.ew-hidden):not(.ew-disabled))").find("[data-bs-toggle=tab]").toggleClass("disabled d-none",!1).click(),!1})),this.$form.find(".ew-next").click((function(e){return t.$pages.off("show.bs.tab",a).filter(".active").parent().next(":has([data-bs-toggle=tab]:not(.ew-hidden):not(.ew-disabled))").find("[data-bs-toggle=tab]").toggleClass("disabled d-none",!1).click(),!1})),this.hideTabs&&this.$form.find(".ew-multi-page > .ew-nav > .nav-tabs").hide()):this.isCollapse&&(this.showPagerTop&&this.$collapses.closest(".ew-accordion").before(e),this.showPagerBottom&&this.$collapses.closest(".ew-accordion").after(e),this.$form.find(".ew-prev").click((function(e){return t.$pages.closest(".accordion-item").filter(":has(.collapse.show)").prev(":has([data-bs-toggle=collapse]:not(.ew-hidden):not(.ew-disabled))").toggleClass("disabled d-none",!1).find("[data-bs-toggle=collapse]").click(),!1})),this.$form.find(".ew-next").click((function(e){return t.$pages.closest(".accordion-item").filter(":has(.collapse.show)").next(":has([data-bs-toggle=collapse]:not(.ew-hidden):not(.ew-disabled))").toggleClass("disabled d-none",!1).find("[data-bs-toggle=collapse]").click(),!1}))),this.pageShow()},this.pageShow=function(){this.isTab?(this.lockTabs&&this.$pages.on("show.bs.tab",a),this.$pages.each((function(){var e=r.default(this);t.hideInactivePages&&e.toggleClass("d-none",!e.hasClass("active")),t.lockTabs&&e.toggleClass("disabled",!e.hasClass("active"))}))):this.isCollapse&&this.$pages.closest(".accordion-item").each((function(){var e=r.default(this);t.hideInactivePages&&e.toggleClass("d-none",!e.find(".collapse.show")[0])}));var e=this.lastPageSubmit&&this.pageIndex!=this.maxPageIndex,n=this.$form.closest(".content, .modal-content").find("#btn-action, button.ew-submit").prop("disabled",e).toggle(!this.hideDisabledButton||!e);r.default(".ew-captcha").toggle(n.is(":visible:not(:disabled)")),e=this.pageIndex<=this.minPageIndex,this.$form.find(".ew-prev").toggleClass("disabled",e),e=this.pageIndex>=this.maxPageIndex,this.$form.find(".ew-next").toggleClass("disabled",e)},this.gotoPage=function(e){if(!(e<=0||e<this.minPageIndex||e>this.maxPageIndex)&&this.pageIndex!=e){var t=this.$pages.eq(e-1);if(this.isTab)t.is(":not(.d-none):not(.disabled)")?t.click():t.parent().next(":has([data-bs-toggle=tab]):not(.d-none):not(.disabled)").find("[data-bs-toggle=tab]").toggleClass("disabled",!1).click();else if(this.isCollapse){var a=t.closest(".accordion-item");a.is(":not(.d-none)")?t.click():a.next(":has([data-bs-toggle=collapse]):not(.d-none)").find("[data-bs-toggle=collapse]").click()}this.pageIndex=e}},this.gotoPageByIndex=this.gotoPage,this.gotoPageByElement=function(e){this.gotoPage(parseInt(r.default(e).data("page"),10)||-1)},this.gotoPageByElementId=function(e){var t=this.$form.find("[data-page]").filter("[id='"+e+"'],[name='"+e+"'],[data-field='"+e+"']");this.gotoPageByElement(t)},this.togglePage=function(e,t){this.isTab?this.$pages.eq(e-1).toggleClass("d-none",!t):this.isCollapse&&this.$pages.eq(e-1).closest(".accordion-item").toggle("d-none",!t)},this.render=function(){this.$form=r.default("#"+e),this.pageIndexes=this.$form.find("[data-page]").map((function(){var e=parseInt(this.dataset.page,10);return e>0?e:null})).get(),this.pageIndexes.sort((function(e,t){return e-t})),this.minPageIndex=this.pageIndexes[0],this.maxPageIndex=this.pageIndexes[this.pageIndexes.length-1];var a=this.$form.find("[data-bs-toggle=tab]");if(a[0])this.$pages=a,this.isTab=!0,a.on("shown.bs.tab",(function(e){t.pageIndex=a.index(e.target)+1,t.pageShow(),r.default(r.default(this).attr("href")).find(".ew-map").each((function(){var e=ew.maps[this.id];null!=e&&e.map&&(google.maps.event.trigger(e.map,"resize"),e.map.setCenter(e.latlng))}))})),this.pageIndex=a.index(a.parent(".active"))+1;else if(this.$collapses=this.$form.find("[data-bs-toggle=collapse]"),this.$collapses[0]){this.$pages=this.$collapses,this.isCollapse=!0;var n=this.$collapses;n.on("shown.bs.collapse",(function(e){t.pageIndex=n.index(e.target)+1,t.pageShow(),r.default(this).find(".ew-map").each((function(){var e=ew.maps[this.id];null!=e&&e.map&&(google.maps.event.trigger(e.map,"resize"),e.map.setCenter(e.latlng))}))})),this.pageIndex=n.index(n.hasClass("show"))+1}r.default((function(){t.init()}))}},Form:v,Validators:s,maps:ea},jt,Jt);var ta=r.default(document);loadjs.ready("load",(function(){r.default.views.settings.debugMode(ew.DEBUG),ew.setSessionTimer(),ew.initPage(),r.default("#ew-modal-dialog").on("load.ew",ew.initPage),r.default("#ew-add-opt-dialog").on("load.ew",ew.initPage);var e=ew.currentUrl.searchParams.get("hash");e&&r.default("html, body").animate({scrollTop:r.default("#"+e).offset().top},800),ta.trigger("load")})),ta.on("addoption",(function(e,t){for(var a=t.data,n=t.parents,i=0,l=n.length;i<l;i++){var s=n[i];if(!s.length)return t.valid=!1;var o=a["ff"+(i>0?i+1:"")];if(!r.default.isUndefined(o)&&!s.includes(String(o)))return t.valid=!1}})),ta.on("click","[data-ew-action]:not([data-ew-action=''])",(function(e){let t=Object.assign({},r.default(this).data()),a=t.ewAction;if(!a)return!0;if("none"==a)return!1;if("redirect"==a)return ew.redirect(t.url);if("reload"==a)return location.reload(),!1;if("submit"==a)return delete t.ewAction,ew.submitAction(e,t);if("modal"==a)return delete t.ewAction,ew.modalDialogShow({evt:e,...t});if("export"==a)return ew.export(e,t.url,t.export,t.custom,t.exportSelected);if("layout"==a)return ew.toggleLayout(this);if("language"==a)return ew.setLanguage(this);if("filter"==a)return ew.filter(e);if("email"==a)return delete t.ewAction,ew.emailDialogShow({evt:e,...t});if("set-action"==a)this.form.elements.action.value=t.value;else{if("drilldown"==a)return ew.showDrillDown(e,this,t.url,t.id,t.hdr);if("export-charts"==a)return ew.exportWithCharts(t.url,t.exportid);if("add-option"==a)return delete t.ewAction,ew.addOptionDialogShow({evt:e,...t});if("search-type"==a)return ew.setSearchType(this);if("search-operator"==a)ew.toggleSearchOperator(e,t.target,t.value);else if("search-toggle"==a)r.default("#"+this.dataset.form+"_search_panel").collapse("toggle");else if("highlight"==a)r.default("mark."+this.dataset.name).toggleClass("mark");else{if("inline-delete"==a)return ew.confirmDelete(this);if("add-grid-row"==a)return ew.addGridRow(this);if("delete-grid-row"==a)return ew.deleteGridRow(this,this.dataset.rowindex);if("select-all"==a)ew.selectAll(this);else if("select-key"==a)ew.selectKey(e);else if("select-all-keys"==a)ew.selectAllKeys(this);else{if("import"==a)return ew.importDialogShow({evt:e,hdr:t.hdr});if("password"==a)return ew.togglePassword(e);if("push"==a)return ew.pushNotificationDialogShow({evt:e,url:t.apiUrl});if("enable-2fa"==a)return ew.enable2FA();if("disable-2fa"==a)return ew.disable2FA();if("backup-codes"==a)return ew.showBackupCodes();if("scroll-top"==a)return r.default(document).scrollTop(r.default("#top").offset().top),!1}}}})),ta.on("click",".ew-row-link",(e=>e.stopPropagation())),ta.on("show.bs.modal",".modal",(function(){var e=1050+r.default(".modal:visible").length;r.default(this).css("z-index",e),setTimeout((function(){r.default(".modal-backdrop").not(".modal-stack").css("z-index",e-1).addClass("modal-stack")}),0)})),ta.on("hidden.bs.modal",".modal",(function(){r.default(".modal:visible").length&&r.default("body").addClass("modal-open")})),r.default.extend({isBoolean:function(e){return"boolean"==typeof e},isNull:function(e){return null===e},isNumber:function(e){return"number"==typeof e&&isFinite(e)},isObject:function(e){return e&&("object"==typeof e||this.isFunction(e))||!1},isString:function(e){return"string"==typeof e},isUndefined:function(e){return"undefined"==typeof e},isValue:function(e){return this.isObject(e)||this.isString(e)||this.isNumber(e)||this.isBoolean(e)},isDate:function(e){return"date"===this.type(e)&&"Invalid Date"!==e.toString()&&!isNaN(e)},later:function(e,t,a,n,i){e=e||0,t=t||{};var r,l,s=a,o=n;if(this.isString(a)&&(s=t[a]),s)return this.isUndefined(n)||this.isArray(o)||(o=[n]),r=function(){s.apply(t,o||[])},l=i?setInterval(r,e):setTimeout(r,e),{interval:i,cancel:function(){this.interval?clearInterval(l):clearTimeout(l)}}}}),r.default.fn.fields=function(e){var t,a,n,i={},l=this.attr("id"),s=this[0],o=l.match(/^[xy](\d*)_/);o?(t=ew.getForm(s),a=this.data("table"),n=o[1]):null!=s&&s.htmlForm&&(t=s.$element,a=s.id.replace(new RegExp("^f|"+s.pageId+"$","g"),""),n=s.htmlForm.dataset.rowindex);var d="[data-table"+(a?"="+a:"")+"][data-field"+(e?"=x_"+e:"")+"]";return r.default.isValue(n)&&(d+="[name^=x"+n+"_]"),t&&d&&r.default(t).find(d).each((function(){var e=this.getAttribute("data-field").substr(2),t=this.getAttribute("name");e=/^y_/.test(t)?"y_"+e:e,i[e]=i[e]?i[e].add(this):r.default(this)})),e?i[e]:i},r.default.fn.extend({row:function(){var e,t=this.closest("#r_"+(null==(e=this.data("field"))?void 0:e.substr(2)));return t[0]||(t=this.closest(".ew-table > tbody > tr")),t},visible:function(e){var t,a=this.closest("#r_"+(null==(t=this.data("field"))?void 0:t.substr(2)));return a[0]||(a=this.closest("[id^=el]")),"undefined"!=typeof e?(a.toggle(e),this):$el.is(":visible")},readonly:function(e){return"undefined"!=typeof e?(this.prop("readOnly",e),this):this.prop("readOnly")},disabled:function(e){return"undefined"!=typeof e?(this.prop("disabled",e),this):this.prop("disabled")},value:function(e){var t=this.attr("type");if("undefined"!=typeof e){Array.isArray(e)||(e=[e]);var a="radio"==(t=this.attr("type"))||"checkbox"==t?this.get():this[0];return ew.isHiddenTextArea(this)?this.val(e).data("editor").save():(ew.selectOption(a,e),this.hasClass("select2-hidden-accessible")&&this.trigger("change")),this}if("checkbox"==t){var n=ew.getOptionValues(this.get());return 1==this.length?n.join():n}return"radio"==t?ew.getOptionValues(this.get()).join():ew.isHiddenTextArea(this)?(this.data("editor").save(),this.val()):this.val()},toNumber:function(){return ew.parseNumber(this.value())},toDate:function(){var e,t,a,n;let i=this.data(),r=i.table,l=i.field.replace(/^[xy]_/,""),s=null==(e=ew.vars.tables)||null==(t=e[r])||null==(a=t.fields)||null==(n=a[l])?void 0:n.clientFormatPattern;return ew.parseDateTime(this.value(),s)},toJsDate:function(){return this.toDate().toJSDate()}}),bootstrap.Dropdown.prototype._getMenuElement=function(){if(this._element.closest("[data-widget]")&&r.default(this._element).on("click.bs.dropdown",(e=>e.stopPropagation())),!this._menu){const e=bootstrap.Dropdown.getParentFromElement(this._element);if(e&&(this._menu=e.querySelector(".dropdown-menu"),this._menu.closest(".table-responsive"))){this._menu.closest(".popover-body, .modal-body, body").appendChild(this._menu);let t=this._menu;function a(e){e.forEach((e=>{if("attributes"===e.type)e.target.classList.contains("show")?t.classList.add("d-block"):t.classList.remove("d-block")}))}this._element.id||(this._element.id="dropdownbtn"+ew.random()),t.setAttribute("aria-labelledby",this._element.id),new MutationObserver(a).observe(e,{attributeFilter:["class"],attributeOldValue:!1,subtree:!1})}}return this._menu},r.default(window).off("load.lte.treeview");var aa=adminlte.Treeview;aa.prototype._toggle=aa.prototype.toggle,aa.prototype.toggle=function(e){let t=r.default(e.currentTarget),a=t.next(),n=t.attr("href"),i="P"==e.target.tagName;!a.is(".nav-treeview")||i&&n&&"#"!=n&&"javascript:void(0);"!=n||(this._toggle(e),e.stopImmediatePropagation())},r.default("ul.dropdown-menu [data-bs-toggle=dropdown]").on("click",(function(e){let t=r.default(this).attr("href");t&&"#"!=t&&"SPAN"==e.target.tagName&&(window.location=t)}));var na=e=>null==e,ia=e=>"function"==typeof e,ra=e=>"number"==typeof e&&isNaN(e),la=e=>"number"==typeof e&&isFinite(e);var sa=(e,t)=>{if(!la(e))return NaN;const a=""+e,n=a.indexOf("e");return-1===n?+(a+"e"+t):+(a.slice(0,n)+"e"+(+a.slice(n+1)+t))};var oa=e=>Math.round(Math.log(e)*Math.LOG10E);var da=(e,t)=>{const a={};for(let n=0;n<e.length;++n)if(n in e){const[i,r]=t(e[n],n);a[i]=r}return a};var ua=e=>e.replace(/[.*+?^${}()|[\]\\]/g,(e=>`\\${e}`));var ca=e=>{const t={};return function(...a){const n=a.length>1?a.join("-(:-:)-"):a[0];if(n in t)return t[n];const i=e.apply(this,a);return t[n]=i,i}};const fa=(()=>{const e={};let t,a="";for(;t!==1/0;)t=+("1"+a),e[t]=!0,a+="0";for(a="",t=void 0;0!==t;)t=+("0."+a+"1"),e[t]=!0,a+="0";return e})();var pa=e=>!!fa[e];const ha=(e,t,a)=>{if(!la(e)||t===a.base)return e;if(!(t in a.scale))return NaN;const n=a.scale[t]||1;return pa(n)?sa(e,oa(n)):e*n},ga=(e,t,a,n)=>{if(!la(e)||t===a)return e;const i=ha(e,t,n),r=Object.assign(Object.assign({},n.scale),{[n.base]:1});if(isNaN(i)||!(t in r)||!(a in r))return NaN;const l=n.scale[a]||1;return pa(l)?sa(i,-oa(l)):i/l},ma=e=>({toBase:(t,a)=>ha(t,a,e),convert:(t,a,n)=>ga(t,a,n,e),toBest:(t,a,n)=>((e,t,a,n)=>{const i=Object.assign({exclude:[],cutOffNumber:1},n);let r=null;const l=a.scale;return Object.keys(l).sort(((e,t)=>l[e]-l[t])).forEach((n=>{if(-1!==i.exclude.indexOf(n))return;const l=ga(e,t,n,a),s=Math.abs(l);(!r||s>=i.cutOffNumber&&s<Math.abs(r[0]))&&(r=[l,n])})),r||[e,t]})(t,a,e,n),scaleDefinition:e});var wa=(e,t)=>{if(t<1)return"";let a="",n=e;for(;t>1;)1&t&&(a+=n),t>>>=1,n+=n;return a+n};var va=ca((e=>{if(!e)return ma({base:"",scale:{}});const t=e.split("|"),a={"":1};return t.forEach(((e,t)=>{e&&(a[e]=+(1+wa("0",t)))})),ma({base:"",scale:a})}));var ba=(e,t)=>{var a;const n=t.locale,i=e;let r;const l=((e,t)=>{if(!t||10!==t.length)return e;const a=e.length,n=da(t,((e,t)=>[e.replace(/\u200e/g,""),""+t]));let i="";for(let t=0;t<a;t++){const a=e[t];i+=n[a]||a}return i})(e,null===(a=t.locale)||void 0===a?void 0:a.numeralSystem);if(t.zeroFormat&&l===t.zeroFormat)r=0;else if(t.nullFormat&&l===t.nullFormat||!l.replace(/[^0-9]+/g,"").length)r=null;else{const e=n.delimiters.decimal,a="."===e?l:l.replace(/\./g,"").replace(e,"."),s=((e,t)=>{var a;const n=va(null===(a=t.locale)||void 0===a?void 0:a.abbreviations),i=Object.keys(n.scaleDefinition.scale).sort(((e,t)=>t.length-e.length));let r=1;for(const t of i){const a=ua(t),i=new RegExp(`[^a-zA-Z](${a})|(${a.replace(/\u200e/g,"")})(?:\\)(?:\\))?)?$`);if(e.match(i)){r=n.toBase(r,t);break}}return r})(i,t),o=(a.split("-").length+Math.min(a.split("(").length-1,a.split(")").length-1))%2?1:-1,d=a.replace(/[^0-9.]+/g,"");r=o*sa(+d,oa(s))}return r};var ya={code:"en",delimiters:{thousands:",",decimal:"."},abbreviations:"|||K|||M|||B|||T",ordinal:e=>{const t=e%10;return 1===Math.floor(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th"}};function _a(...e){const t={},a=e.length;for(let n=0;n<a;n++)for(const a in e[n])t[a]=e[n][a];return t}var Sa=e=>"object"==typeof e&&null!==e,Ea=e=>"string"==typeof e;var Aa=e=>e<0?Math.ceil(e):Math.floor(e);const Ta=e=>{let t=!1,a="";const n=[];for(let i=0;i<e.length;i++){const r=e.charAt(i);"'"!==r||t?"'"===r&&t&&"\\"!==e.charAt(i-1)?(t=!1,n.push({escaped:!0,value:a})):t?a+=r:n.length&&!n[n.length-1].escaped?n[n.length-1].value+=r:n.push({escaped:!1,value:r}):(t=!0,a="")}return n},xa=(e,t)=>-1!==Oa(e).indexOf(t),Ia=(e,t,a)=>Ta(e).map((e=>e.escaped?`'${e.value}'`:e.value.replace(t,(e=>a)))).join(""),Oa=e=>Ta(e).filter((e=>!e.escaped)).map((e=>e.value)).join("");var Ca=(e,t)=>-1!==e.indexOf(t);var Na=e=>{const t=Oa(e),a=Ca(t,"(")&&Ca(t,")"),n=!a&&Ca(t,"+");let i=e;return i=Ia(i,"(","'nps'"),i=Ia(i,")","'npe'"),i=Ia(i,/(-|\+)/,"'s'"),[i,{negativeParentheses:a,forceSign:n}]};var Pa=e=>{let t=null,a=!1;if(xa(e,"a")){a=!0;const n=Oa(e).match(/a(k|m|b|t)?/);t=n?n[1]:null}let n=e;return n=Ia(n,/a(k|m|b|t)?/,"'a'"),[n,{compact:a,compactUnit:t,compactAuto:a&&!t}]};var Ra=(e,t)=>{if(!e)return["",""];const a=e.indexOf(t);return-1===a?[e,""]:[e.slice(0,a),e.slice(a+1)]};const La=(e,t)=>e?e.split("").filter((e=>e===t)).length:0;var Fa=e=>{const t=Oa(e),a=Ra(t,".")[1];let n=0,i=0;if(a){const e=a.trim();if(Ca(e,"[")){const t=e.replace("]",""),a=Ra(t,"[");n=La(a[0],"0"),i=n+La(a[1],"0")}else if(Ca(e,"#"))n=La(e.split("#")[0],"0"),i=e.length;else if(Ca(e,"X"))n=La(e.split("X")[0],"0"),i=500;else{const t=La(e.split(" ")[0],"0");n=t,i=t}}return{minimumFractionDigits:n,maximumFractionDigits:i}};var ka=e=>{let t=!1,a=e;return xa(e,"[.]")&&(t=!0,a=Ia(a,"[.]",".")),[a,{optionalFractionDigits:t}]};var Da=ca((e=>{const t=Ea(e)&&e||"0,0.##########",[a,n]=Na(t),[i,r]=Pa(a),[l,s]=ka(i),o=l,d=Oa(o),u=Fa(o),c=(e=>{const t=Oa(e).split(".")[0].split(",")[0];return/#/g.test(t)?0:(t.match(/0/g)||[]).length})(o),f=d.indexOf(",")>-1,p=(e=>Ia(e,/((((0|#)+,)?(0|#)+(\.([0#X]|\[0+\])+)?){1})/,"'n'"))(o),h=(e=>Ca(e,"'s'")||Ca(e,"'nps'")?e:e.replace("'n'",(e=>"'s''n'")))(p),g=h;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},n),r),s),u),{grouping:f,minimumIntegerDigits:c,patternMask:g})}));var Ma=e=>"-"===e[0]?e.slice(1):e;var $a=(e,t,a,n)=>{const{compact:i,compactAuto:r}=a,{abbreviations:l}=n.locale;if(!i||!r)return[e,t];const s=va(l),[o,d]=s.toBest(e,t||"");return[o,d]};var Ua=(e,t,a)=>{const{compact:n,compactUnit:i}=t,{abbreviations:r}=a.locale;if(!n)return[e,null];if(i)return((e,t,a)=>{const n={k:3,m:6,b:9,t:12}[e],i=(null==t?void 0:t.split("|"))||[];let r=null;for(let e=0;e<i.length;e++)if(i[n-e]){r=n-e;break}return null===r?[a,null]:[sa(a,-r),i[r]]})(i,r,e);const l=va(r),[s,o]=l.toBest(e,"");return[s,o||null]};var ja=(e,t,a)=>{const n=t||0,i=(a||Math.round)(sa(e,n));return sa(i,-n)};var Ba=e=>{const t=(e||0).toString();if(!(t.indexOf("e")>=0))return t;const[a,n]=Ra(t,"e"),i=+n;return i>=0?(e=>{const[t,a]=Ra(e,"e"),n=+a;if(n<0)return e;const[i,r]=Ra(t,"."),l=n-r.length;return`${i}${r}${wa("0",l)}`})(t):((e,t,a)=>{const n=Math.abs(t),[i,r]=Ra(a,".");let l="-"===i[0]?i.slice(1):i,s=r;for(let e=0;e<n;e+=1){const e=l[0]||"";l=l.slice(0,l.length-1),s=(e||"0")+s}return`${e<0?"-":""}${l||0}.${s}`})(e,i,a)};var Ka=(e,t,a,n)=>{const i=Ba(e),r=t-(n||0),l=Ra(i,".")[1],s=l?Math.min(Math.max(l.length,r),t):r,o=ja(e,s,a);let d=Ba(o);return r&&(d=((e,t)=>{const[a,n]=Ra(e,".");return`${a}.${n+wa("0",t-n.length)}`})(d,r)),d};var Ha=(e,t,a)=>{const{rounding:n}=a,{minimumFractionDigits:i,maximumFractionDigits:r}=t,l=n||Math.round;if(i>0||r>0){return Ka(e,r,l,r-i)}return Ka(e,0,l)};var Ga=(e,t)=>{if(!t||10!==t.length)return e;const a=e.length;let n="";for(let i=0;i<a;i++){const a=e[i];n+=t[a]||a}return n};var Va=(e,t)=>{const{minimumIntegerDigits:a}=t;return 0===a&&+e<1&&+e>-1?"":e.length>=a?e:`${wa("0",a-e.length)}${e}`};var qa=(e,t,a,n)=>{const{negativeParentheses:i,forceSign:r}=n;let l=e;return i&&t?l=l.replace(/'(nps|npe)'/g,(e=>"'nps'"===e?"(":")")):r?l=l.replace("'s'",t?"-":a?"":"+"):t&&(l=l.replace("'s'","-")),l};var Wa=(e,t)=>{const{optionalFractionDigits:a}=t,[n,i]=Ra(e,".");return a&&0===Number(i)?[n,""]:[n,i]};var za=(e,t,a)=>{const{delimiters:n,digitGroupingStyle:i}=a.locale,{grouping:r}=t;if(!r||!n.thousands)return e;const l=e,s=n.thousands,o=[...(null==i?void 0:i.length)?i:[3]];let d="",u=1;for(let e=l.length-1;e>=0;e--)u===o[0]&&0!==e?(d=s+l[e]+d,o.length>1&&o.shift(),u=1):(d=l[e]+d,u+=1);return d};var Ya=(e,t,a)=>a?t?e.replace("'a'",(e=>`'${t.replace(/'/g,(e=>"\\'"))}'`)):e.match(/'n'\s*'a'/)?e.replace(/\s*'a'/,""):e.replace(/'a'\s*/,""):e;var Ja=(e,t,a)=>{var n;const i=Da(t),r=la(e)?e:0,[l,s]=((e,t,a)=>{if(!t.compact)return[Ha(e,t,a),null];const[n,i]=Ua(e,t,a),r=+Ha(n,t,a),[l,s]=$a(+r,i,t,a);return[Ha(l,t,a),s]})(r,i,a);if("NaN"===l)return"";const o=a.signedZero?e<0:+l<0,d=a.signedZero?0===e:0==+l,u=Ma(l),[c,f]=Wa(u,i),p=Va(c,i),h=za(p,i,a),g=a.locale.numeralSystem,m=Ga(h,g),w=Ga(f,g),v=m+(w?((null===(n=a.locale.delimiters)||void 0===n?void 0:n.decimal)||".")+w:""),b=Ya(i.patternMask,s,i.compact).replace("'n'",(e=>`'${v.replace(/'/g,"\\'")}'`)),y=qa(b,o,d,i).replace(/'(nps|npe|s|a|n)'/g,"");return Ta(y).map((e=>e.escaped?e.value.replace(/\\'/g,"'"):e.value)).join("")};var Xa={name:"bps",regexps:{format:/BPS/,unformat:/BPS/},format:(e,t,a)=>{const n=sa(e,4),i=Ia(t,/BPS/,"'BPS'");return Ja(n,i,a).replace("BPS","BPS")},unformat:(e,t)=>{const a=ba(e.replace(/\s?BPS/,""),t);return la(a)?sa(a,-4):a}};var Za={name:"time",regexps:{format:/([0-9]{1,2}:[0-9]{2}) *$/,unformat:/([0-9]{1,2}:[0-9]{2}) *$/},format:e=>{const t=Math.abs(e),a=e<0?"-":"",n=Aa(t/3600),i=Aa((t-3600*n)/60),r=Aa(t-3600*n-60*i);return`${a}${n}:${(i<10?"0":"")+i}:${(r<10?"0":"")+r}`},unformat:e=>{const t=/^ *-/.test(e),a=e.replace(/^ *-/,"").split(":").reverse();let n=0;return n+=+a[0],n+=60*+a[1],n+=3600*(+a[2]||0),t&&0!==n?-n:n}};const Qa=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],en=["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],tn=`(${Qa.concat(en.slice(1)).join("|").replace(/B/g,"B(?!PS)")})`,an=ma({base:"B",scale:da(Qa,((e,t)=>[e,Math.pow(1e3,t)]))}),nn=ma({base:"B",scale:da(en,((e,t)=>[e,Math.pow(1024,t)]))});const rn={EUR:"",USD:"$",XCD:"EC$",AUD:"A$",INR:"",BRL:"R$",CAD:"CA$",XAF:"FCFA",CNY:"CN",NZD:"NZ$",XPF:"CFPF",GBP:"",HKD:"HK$",ILS:"",JPY:"",KRW:"",XOF:"CFA",MXN:"MX$",TWD:"NT$",VND:""};var ln=[{name:"percentage",regexps:{format:/%!?/,unformat:/%/},format:(e,t,a)=>{const n=xa(t,"%!"),i=a.scalePercentage&&!n?sa(e,2):e,r=Ia(t,/%!?/,"'%'");return Ja(i,r,a).replace("%","%")},unformat:(e,t)=>{const a=ba(e.replace(/\s?%/,""),t);return a&&t.scalePercentage?sa(a,-2):a}},{name:"currency",regexps:{format:/(\$)/},format:(e,t,a)=>{var n;const i=null===(n=a.currency)||void 0===n?void 0:n.toUpperCase(),r=rn[i]||i||"",l=Ia(t,/\$/,"'currency'");return Ja(e,l,a).replace("currency",(e=>r))}},{name:"ordinal",regexps:{format:/o/},format:(e,t,a)=>{var n,i;const r=(null===(i=(n=a.locale).ordinal)||void 0===i?void 0:i.call(n,e))||"",l=Ia(t,/o/,"'ord'");return Ja(e,l,a).replace("ord",(e=>r))}},Za,{name:"bytes",regexps:{format:/([0\s]b[bd])|(b[bd][0\s])/,unformat:(e,t)=>"bytes"===t.type&&new RegExp(tn).test(e)},format:(e,t,a)=>{const n=xa(t,"bb")?nn:an,[i,r]=n.toBest(e,"B"),l=Ia(t,/b[bd]/,"'bytes'");return Ja(i,l,a).replace("bytes",r||"")},unformat:(e,t)=>{var a;const n=ba(e.replace(new RegExp(tn),""),t),i=(null===(a=e.match(tn))||void 0===a?void 0:a[0])||"",r=nn.scaleDefinition.scale[i]?nn:an;return n?r.toBase(n,i):n}},{name:"exponential",regexps:{format:/[eE][+-][0-9]+/,unformat:/[eE][+-][0-9]+/},format:(e,t,a)=>{const n="number"!=typeof e||ra(e)?"0e+0":e.toExponential(),i=Ra(n,"e"),r=Ia(t,/e[+|-]{1}0/i,"");return Ja(+i[0],r,a)+"e"+i[1]},unformat:(e,t)=>{var a;const n=ba(e.replace(/e[+-]{1}[0-9]{1,3}/i,""),t),i=+((null===(a=e.match(/e([+-]{1}[0-9]{1,3})/i))||void 0===a?void 0:a[1])||"0");return la(n)?sa(n,i):n}},Xa];var sn=e=>e>=0?Math.round(e):e%.5==0?Math.floor(e):Math.round(e);var on=e=>{var t,a,n;const i=e||{},r=(e=>{switch(e){case"ceil":return Math.ceil;case"floor":return Math.floor;case"truncate":return Aa;case"half-up":return Math.round;case"half-away-from-zero":return sn;default:return ia(e)?e:sn}})(i.rounding),l=(e=>{const t=ya;return Sa(e)?_a(e,{delimiters:(a=e.delimiters,(null==a?void 0:a.decimal)&&Ea(null==a?void 0:a.thousands)&&a.decimal!==a.thousands?e.delimiters:t.delimiters),abbreviations:e.abbreviations||t.abbreviations,ordinal:e.ordinal||t.ordinal}):t;var a})(i.locale),s=(o=i.formatters)?ia(o)?o(ln):[...o,...ln]:ln;var o;return{defaultPattern:i.defaultPattern||"0,0.##########",nullFormat:i.nullFormat||"",nanFormat:i.nanFormat,zeroFormat:i.zeroFormat,locale:l,rounding:r,type:i.type,scalePercentage:null===(t=i.scalePercentage)||void 0===t||t,trim:null===(a=i.trim)||void 0===a||a,formatters:s,currency:i.currency,signedZero:!!i.signedZero,nonBreakingSpace:null!==(n=i.nonBreakingSpace)&&void 0!==n&&n}};var dn=(e,t)=>{const a=on(t);let n;if(na(e)||ra(e))n=null;else if("number"==typeof e)n=0===e?0:e;else if("string"==typeof e)if(a.zeroFormat&&e===a.zeroFormat)n=0;else if(a.nullFormat&&e===a.nullFormat)n=null;else{const t=e.replace(/\u00A0/," "),i=((e,t)=>{for(const a of t.formatters){const n=a.regexps.unformat;if(n&&(ia(n)?n(e,t):e.match(n)))return a.unformat}})(t,a);n=(i||ba)(t,a)}else{const t=+e;n=0===t?t:t||null}return n};var un=(e,t)=>dn(e,t);var cn=(e,t,a)=>ja(e,t,a);var fn=(e,t,a)=>{var n;try{const n=Ea(e)?parseFloat(e):e,i=on(a),r=t||i.defaultPattern;let l;if(n===1/0||n===-1/0)l=n>0?"":"-";else{if(ra(n))return Ea(i.nanFormat)?i.nanFormat:Ea(i.nullFormat)?i.nullFormat:"";if(na(n))l=Ea(i.nullFormat)?i.nullFormat:"";else if(0===n&&Ea(i.zeroFormat))l=i.zeroFormat;else{const e=n||0,t=((e,t)=>{const a=Oa(e);for(const n of t.formatters){const i=n.regexps.format;if(i&&(ia(i)?i(e,t):a.match(i)))return n.format}})(r,i);l=(t||Ja)(e,r,i)}}return l=Ea(l)?l:"",l=i.nonBreakingSpace?l.replace(/ /g,(e=>"")):l,l=i.trim?l.trim():l,l}catch(e){return(null===(n=a)||void 0===n?void 0:n._errorFormat)||""}};function pn(e,t,a){const n=Ea(t)?t:null,i=Sa(t)?t:Sa(a)?a:{};return fn(e,n,i)}pn.withOptions=e=>{const t=_a(e,{locale:ia(e.locale)?e.locale():e.locale});return(e,a,n)=>{const i=Ea(a)?a:null,r=Sa(a)?a:Sa(n)?n:{};return fn(e,i,_a(t,r))}};var hn=e=>e?e.filter(((e,t,a)=>a.indexOf(e)===t)):[];const gn=new RegExp("^[^---]*?[---]"),mn=e=>(e=>gn.test(e))(e)?e+"":e,wn=["zh","yue","ko","ja"],vn=(e,t,a)=>{try{if("object"!=typeof Intl||!Intl||"function"!=typeof Intl.NumberFormat)return null;const n={notation:"compact",useGrouping:!1,compactDisplay:a},[i,r,l]=t.split("");let s="";for(let t=1;t<50;t++){const o=(+(1+wa("0",t))).toLocaleString(e,n);if(new RegExp(`^${r}[^${i}]+$`).test(o))if("long"===a){const a=(+(2+wa("0",t))).toLocaleString(e,n),i=o.replace(new RegExp(`${r}`,"g"),"").trim(),d=a.replace(new RegExp(`${l}`,"g"),"").trim();s+="|"+mn(i)+":::"+mn(d)}else{const e=o.replace(new RegExp(`${r}`,"g"),"").trim();s+="|"+mn(e)}else s+="|"}let o=s,d=o.length;for(;d--&&"|"===o[d];)o=o.slice(0,-1);return o}catch(e){return null}};var bn=ca((e=>{const t=e||"en",a=(e=>{try{const t=1234567890..toLocaleString(e,{useGrouping:!1}),a={},n=t.split("").find((e=>{if(a[e])return!0;a[e]=!0})),i=(n?t.replace(new RegExp(ua(n||""),"g"),""):t).split("");return[i[i.length-1],...i.slice(0,-1)].join("")}catch(e){return null}})(t),n=a||"0123456789",i=((e,t)=>{try{const a=12345678.123.toLocaleString(e).replace(new RegExp(`[${ua(t)}]`,"g"),""),[n=",",i="."]=hn(a.split(""));return[n,i]}catch(e){return null}})(t,n),[r,l]=i&&i.length>=2?i:[",","."],s=((e,t)=>{if(wn.some((t=>0===e.indexOf(t))))return[4];try{const a=[];let n=0;1e11.toLocaleString(e).split("").reverse().forEach((e=>{e===t?(a.push(n),n=0):n+=1}));let i=a.length;for(;i--&&a[i]===a[i-1];)a.pop();return a}catch(e){return null}})(t,r),o=vn(t,n,"short");return{_abbreviationsLong:vn(t,n,"long")||ya.abbreviations,code:t,delimiters:{thousands:r,decimal:l},abbreviations:o||ya.abbreviations,digitGroupingStyle:(null==s?void 0:s.length)?s:void 0,numeralSystem:"0123456789"!==a?null==a?void 0:a.split("").map(mn):void 0,ordinal:ya.ordinal}}));var yn={__proto__:null,parse:un,round:cn,format:pn,getLocaleFromPlatform:e=>bn(e)};Object.assign(i.default,yn)}(ew,jQuery,luxon);
//# sourceMappingURL=ew.min.js.map